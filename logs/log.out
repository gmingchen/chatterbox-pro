2024-05-30 01:54:43.841 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 152 millis. SELECT 1[]
2024-05-30 01:54:44.008 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 159 millis. SELECT 1[]
2024-05-30 01:54:44.154 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 137 millis. SELECT 1[]
2024-05-30 01:54:44.299 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 144 millis. SELECT 1[]
2024-05-30 03:19:48.306 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 219 millis. SELECT 1[]
2024-05-30 04:12:50.939 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 237 millis. SELECT 1[]
2024-05-30 08:03:01.364 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 131 millis. SELECT 1[]
2024-05-30 08:12:02.138 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 200 millis. SELECT 1[]
2024-05-30 08:42:04.078 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 117 millis. SELECT 1[]
2024-05-30 09:09:01.050 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:09:01.062 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:09:01.097 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:09:01.712 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:09:01.714 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:09:01.726 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:09:01.762 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 09:09:01.769 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 09:09:01.787 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 09:09:02.892 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:09:02.892 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:09:02.900 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:09:02.900 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:09:02.901 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:09:02.909 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:09:02.926 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 09:09:02.927 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 09:09:02.937 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 09:09:02.938 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 09:09:02.940 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 09:09:02.948 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 09:09:05.743 ERROR 10704 --- [Druid-ConnectionPool-Create-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 217 millis. SELECT 1[]
2024-05-30 09:35:33.673 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:35:33.676 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:35:33.689 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:35:33.699 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 09:35:33.701 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 13(Long), 10(Long)
2024-05-30 09:35:33.713 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 09:39:48.608 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:39:48.608 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:39:48.619 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:39:49.135 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:39:49.135 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:39:49.146 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:39:49.174 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 09:39:49.175 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 09:39:49.188 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 09:42:58.266 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:42:58.267 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:42:58.277 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:47:17.174 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:47:17.175 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:47:17.187 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:47:17.519 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:47:17.520 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:47:17.530 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:47:17.545 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 09:47:17.547 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 09:47:17.557 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 09:47:18.274 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:47:18.274 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:47:18.275 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:47:18.275 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:47:18.284 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:47:18.284 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:47:18.286 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 09:47:18.286 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 09:47:18.297 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 09:47:18.308 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 09:47:18.308 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 09:47:18.323 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 09:47:26.561 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:47:26.561 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:47:26.571 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:47:26.575 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 09:47:26.576 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 13(Long), 10(Long)
2024-05-30 09:47:26.588 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 09:47:36.134 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:47:36.134 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:47:36.143 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:47:36.146 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 09:47:36.146 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 3(Long), 10(Long)
2024-05-30 09:47:36.156 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 2
2024-05-30 09:47:37.671 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:47:37.671 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:47:37.680 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:47:37.681 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 09:47:37.682 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 09:47:37.690 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 09:48:38.208 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:48:38.208 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:48:38.218 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:48:38.556 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:48:38.557 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:48:38.570 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:48:38.588 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 09:48:38.590 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 09:48:38.602 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 09:48:39.575 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:48:39.576 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:48:39.587 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:48:39.588 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 09:48:39.589 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 09:48:39.589 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:48:39.590 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:48:39.599 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 09:48:39.600 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:48:39.619 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 09:48:39.619 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 09:48:39.633 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 09:49:35.238 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:49:35.238 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:49:35.247 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:49:35.589 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:49:35.590 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:49:35.598 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:49:35.613 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 09:49:35.614 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 09:49:35.626 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 09:49:37.654 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:49:37.655 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:49:37.655 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:49:37.655 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:49:37.663 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:49:37.663 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:49:37.665 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 09:49:37.666 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 09:49:37.676 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 09:49:37.689 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 09:49:37.690 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 09:49:37.701 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 09:50:08.251 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:50:08.252 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:50:08.267 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:50:08.914 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:50:08.914 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:50:08.924 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:50:08.946 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 09:50:08.947 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 09:50:08.960 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 09:50:35.269 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:50:35.269 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:50:35.279 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:50:35.641 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:50:35.641 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:50:35.649 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:50:35.669 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 09:50:35.669 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 09:50:35.682 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 09:50:56.321 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:50:56.321 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:50:56.329 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:50:56.713 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:50:56.713 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:50:56.722 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:50:56.742 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 09:50:56.743 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 09:50:56.751 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 09:51:13.891 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:51:13.891 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:51:13.901 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:51:14.244 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:51:14.245 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:51:14.254 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:51:14.269 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 09:51:14.270 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 09:51:14.281 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 09:51:14.701 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:51:14.702 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:51:14.702 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:51:14.707 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:51:14.711 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:51:14.713 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 09:51:14.713 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 09:51:14.715 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:51:14.723 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 09:51:14.734 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 09:51:14.735 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 09:51:14.746 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 09:57:55.601 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:57:55.602 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:57:55.610 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:57:55.945 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:57:55.945 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:57:55.954 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:57:55.974 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 09:57:55.975 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 09:57:55.985 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 09:57:59.357 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:57:59.357 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:57:59.358 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:57:59.358 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:57:59.367 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:57:59.367 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:57:59.369 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 09:57:59.370 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 09:57:59.380 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 09:57:59.387 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 09:57:59.387 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 09:57:59.399 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 09:59:04.340 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:59:04.341 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:59:04.348 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:59:04.810 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:59:04.810 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:59:04.822 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:59:04.844 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 09:59:04.845 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 09:59:04.856 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 09:59:05.578 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:59:05.578 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:59:05.588 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:59:05.588 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:59:05.589 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:59:05.610 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 09:59:05.610 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 09:59:05.824 ERROR 10704 --- [http-nio-8820-exec-8] c.alibaba.druid.filter.stat.StatFilter   : slow sql 234 millis. SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=?  AND deleted=0[1]
2024-05-30 09:59:05.825 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:59:05.826 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 09:59:05.827 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 09:59:06.112 ERROR 10704 --- [http-nio-8820-exec-8] c.alibaba.druid.filter.stat.StatFilter   : slow sql 283 millis. SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at,
               u.id AS userId, u.nickname, u.avatar, u.sex
        FROM message AS m
        LEFT JOIN user AS u ON u.id = m.user_id
        WHERE m.deleted = 0
     
        AND m.room_id = ?
         
        ORDER BY m.created_at DESC
        LIMIT ?[1,10]
2024-05-30 09:59:06.113 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 09:59:09.191 ERROR 10704 --- [http-nio-8820-exec-7] c.alibaba.druid.filter.stat.StatFilter   : slow sql 3581 millis. SELECT  id,url,content,type,created_at,updated_at,deleted  FROM expression 
 WHERE  deleted=0[]
2024-05-30 09:59:09.195 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 09:59:39.150 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:59:39.150 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:59:39.159 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:59:39.514 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:59:39.515 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:59:39.524 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:59:39.544 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 09:59:39.546 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 09:59:39.557 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 09:59:40.635 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:59:40.635 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:59:40.635 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:59:40.636 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:59:40.645 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:59:40.645 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:59:40.647 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 09:59:40.647 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 09:59:40.654 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 09:59:40.663 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 09:59:40.663 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 09:59:40.682 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 09:59:56.430 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:59:56.430 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:59:56.439 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:59:56.766 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:59:56.767 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:59:56.777 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:59:56.796 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 09:59:56.797 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 09:59:56.808 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 09:59:57.717 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:59:57.718 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:59:57.718 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 09:59:57.718 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 09:59:57.726 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:59:57.726 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 09:59:57.728 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 09:59:57.728 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 09:59:57.736 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 09:59:57.743 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 09:59:57.743 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 09:59:57.760 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 10:00:23.419 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 10:00:23.419 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 10:00:23.429 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 10:00:23.986 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 10:00:23.986 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 10:00:23.994 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 10:00:24.013 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 10:00:24.013 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 10:00:24.025 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 10:00:25.915 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 10:00:25.916 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 10:00:25.916 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 10:00:25.916 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 10:00:25.924 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 10:00:25.942 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 10:00:25.943 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 10:00:25.955 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 10:00:25.975 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 10:00:25.978 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 10:00:25.978 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 10:00:26.030 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 10:12:49.426 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 10:12:49.435 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 10:12:49.454 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 10:12:49.888 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 10:12:49.888 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 10:12:49.898 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 10:12:49.929 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 10:12:49.934 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 10:12:49.947 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 10:43:00.297 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 10:43:00.298 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 10:43:00.311 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 10:43:00.632 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 10:43:00.632 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 10:43:00.641 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 10:43:00.660 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 10:43:00.661 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 10:43:00.670 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 10:50:10.793 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 109 millis. SELECT 1[]
2024-05-30 10:51:31.753 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 10:51:31.754 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 10:51:31.762 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 10:51:50.589 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 10:51:50.590 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 10:51:50.602 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 10:51:51.253 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 10:51:51.253 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 10:51:51.268 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 10:51:51.289 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 10:51:51.292 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 10:51:51.305 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 10:51:54.509 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 10:51:54.509 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 10:51:54.510 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 10:51:54.510 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 10:51:54.519 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 10:51:54.551 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 10:51:54.554 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 10:51:54.562 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 10:51:54.740 ERROR 10704 --- [http-nio-8820-exec-28] c.alibaba.druid.filter.stat.StatFilter   : slow sql 229 millis. SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=?  AND deleted=0[1]
2024-05-30 10:51:54.741 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 10:51:54.770 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 10:51:54.771 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 10:51:55.042 ERROR 10704 --- [http-nio-8820-exec-28] c.alibaba.druid.filter.stat.StatFilter   : slow sql 271 millis. SELECT  id,url,content,type,created_at,updated_at,deleted  FROM expression 
 WHERE  deleted=0[]
2024-05-30 10:51:55.048 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 10:51:57.331 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 10:51:57.332 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 10:51:57.344 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 10:51:57.347 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 10:51:57.347 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 13(Long), 10(Long)
2024-05-30 10:51:57.358 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 10:57:11.363 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 181 millis. SELECT 1[]
2024-05-30 10:59:51.508 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 10:59:51.509 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 10:59:51.518 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 10:59:52.434 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 10:59:52.434 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 10:59:52.441 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 10:59:52.469 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 10:59:52.472 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 10:59:52.484 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 11:00:10.294 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:00:10.294 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:00:10.304 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:00:10.874 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:00:10.876 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:00:10.886 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:00:10.907 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 11:00:10.911 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 11:00:10.919 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 11:00:12.698 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:00:12.699 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:00:12.699 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:00:12.700 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:00:12.709 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:00:12.709 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:00:12.711 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 11:00:12.711 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 11:00:12.720 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 11:00:12.726 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 11:00:12.726 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 11:00:12.753 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 11:00:23.843 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:00:23.844 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:00:23.852 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:00:24.669 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:00:24.680 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:00:24.691 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:00:24.786 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 11:00:24.788 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:00:24.797 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:00:24.817 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 11:00:24.826 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:00:24.852 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 11:00:24.891 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 11:00:24.960 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T11:00:24.888(LocalDateTime), 2024-05-30T11:00:24.888(LocalDateTime)
2024-05-30 11:00:24.979 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 11:00:24.993 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 11:00:25.003 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 23(Long), 2024-05-30T11:00:24.993(LocalDateTime), 1(Long)
2024-05-30 11:00:25.022 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 11:00:25.023 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:00:25.023 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:00:25.032 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:00:25.037 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 11:00:25.038 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:00:25.047 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:00:25.050 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 11:00:25.050 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 11:00:25.057 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 11:00:25.066 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 11:00:25.066 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 11:00:25.077 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 11:00:25.084 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 11:00:25.086 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 11:00:25.097 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 11:00:25.120 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 11:00:25.121 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:00:25.130 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 11:00:35.463 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:00:35.464 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:00:35.472 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:00:35.879 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:00:35.880 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:00:35.890 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:00:35.909 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 11:00:35.911 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 11:00:35.920 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 11:00:36.613 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:00:36.614 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:00:36.616 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:00:36.616 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:00:36.623 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:00:36.623 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:00:36.625 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 11:00:36.625 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 11:00:36.636 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 11:00:36.638 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 11:00:36.639 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 11:00:36.660 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 11:00:41.527 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:00:41.527 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:00:41.537 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:00:41.548 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:00:41.549 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:00:41.557 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:00:41.559 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 11:00:41.560 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:00:41.569 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:00:41.572 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 11:00:41.573 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:00:41.582 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 11:00:41.583 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 11:00:41.583 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 123(String), 2024-05-30T11:00:41.582(LocalDateTime), 2024-05-30T11:00:41.582(LocalDateTime)
2024-05-30 11:00:41.600 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 11:00:41.603 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 11:00:41.605 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 24(Long), 2024-05-30T11:00:41.601(LocalDateTime), 1(Long)
2024-05-30 11:00:41.623 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 11:00:41.624 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:00:41.624 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:00:41.634 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:00:41.638 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 11:00:41.638 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:00:41.649 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:00:41.650 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 11:00:41.650 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 11:00:41.660 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 11:00:41.662 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 11:00:41.662 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 11:00:41.670 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 11:00:41.672 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 11:00:41.672 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 11:00:41.684 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 11:00:41.687 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 11:00:41.688 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:00:41.699 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 11:07:17.829 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:07:17.829 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:07:17.842 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:07:18.434 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:07:18.434 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:07:18.444 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:07:18.466 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 11:07:18.467 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 11:07:18.478 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 11:07:28.132 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:07:28.132 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:07:28.142 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:07:28.144 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:07:28.144 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:07:28.156 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:07:28.158 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 11:07:28.158 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 11:07:28.164 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 11:07:28.165 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 11:07:28.167 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 11:07:28.177 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 11:07:29.970 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:07:29.971 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:07:29.982 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:07:29.992 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:07:29.993 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:07:30.001 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:07:30.005 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 11:07:30.006 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:07:30.017 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:07:30.019 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 11:07:30.019 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:07:30.027 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 11:07:30.028 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 11:07:30.029 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T11:07:30.028(LocalDateTime), 2024-05-30T11:07:30.028(LocalDateTime)
2024-05-30 11:07:30.050 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 11:07:30.051 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 11:07:30.052 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 25(Long), 2024-05-30T11:07:30.051(LocalDateTime), 1(Long)
2024-05-30 11:07:30.066 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 11:07:30.067 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:07:30.067 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:07:30.075 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:07:30.077 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 11:07:30.077 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:07:30.086 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:07:30.087 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 11:07:30.087 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 11:07:30.098 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 11:07:30.099 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 11:07:30.099 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 11:07:30.107 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 11:07:30.109 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 11:07:30.109 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 11:07:30.119 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 11:07:30.121 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 11:07:30.122 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:07:30.131 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 11:08:12.426 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 306 millis. SELECT 1[]
2024-05-30 11:08:42.309 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:08:42.310 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:08:42.322 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:08:42.873 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:08:42.874 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:08:42.884 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:08:42.906 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 11:08:42.908 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 11:08:42.919 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 11:08:48.136 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:08:48.138 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:08:48.138 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:08:48.139 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:08:48.149 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:08:48.151 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:08:48.152 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 11:08:48.153 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 11:08:48.166 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 11:08:48.169 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 11:08:48.170 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 11:08:48.187 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 11:08:52.234 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:08:52.235 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:08:52.244 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:08:52.256 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:08:52.256 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:08:52.264 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:08:52.269 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 11:08:52.271 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:08:52.280 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:08:52.282 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 11:08:52.282 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:08:52.289 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 11:08:52.292 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 11:08:52.292 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 12(String), 2024-05-30T11:08:52.291(LocalDateTime), 2024-05-30T11:08:52.291(LocalDateTime)
2024-05-30 11:08:52.308 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 11:08:52.309 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 11:08:52.309 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 26(Long), 2024-05-30T11:08:52.309(LocalDateTime), 1(Long)
2024-05-30 11:08:52.332 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 11:08:52.332 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:08:52.332 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:08:52.349 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:08:52.351 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 11:08:52.351 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:08:52.369 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:08:52.375 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 11:08:52.375 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 11:08:52.392 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 11:08:52.394 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 11:08:52.395 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 11:08:52.415 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 11:08:52.417 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 11:08:52.418 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 11:08:52.428 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 11:08:52.430 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 11:08:52.430 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:08:52.443 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 11:09:37.656 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:09:37.657 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:09:37.665 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:09:37.668 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 11:09:37.668 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 16(Long), 10(Long)
2024-05-30 11:09:37.722 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 11:09:41.273 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:09:41.274 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:09:41.284 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:09:41.294 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:09:41.294 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:09:41.304 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:09:41.308 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 11:09:41.308 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:09:41.318 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:09:41.321 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 11:09:41.321 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:09:41.329 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 11:09:41.330 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 11:09:41.330 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 123(String), 2024-05-30T11:09:41.329(LocalDateTime), 2024-05-30T11:09:41.329(LocalDateTime)
2024-05-30 11:09:41.347 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 11:09:41.349 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 11:09:41.349 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 27(Long), 2024-05-30T11:09:41.347(LocalDateTime), 1(Long)
2024-05-30 11:09:41.367 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 11:09:41.368 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:09:41.368 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:09:41.378 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:09:41.381 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 11:09:41.381 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:09:41.389 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:09:41.392 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 11:09:41.392 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 11:09:41.401 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 11:09:41.403 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 11:09:41.404 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 11:09:41.416 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 11:09:41.417 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 11:09:41.418 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 11:09:41.431 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 11:09:41.433 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 11:09:41.433 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:09:41.443 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 11:10:07.086 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:10:07.087 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:10:07.096 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:10:07.476 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:10:07.478 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:10:07.486 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:10:07.511 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 11:10:07.512 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 11:10:07.523 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 11:10:08.178 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:10:08.182 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:10:08.191 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:10:08.191 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:10:08.192 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:10:08.193 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 11:10:08.193 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 11:10:08.200 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:10:08.200 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 11:10:08.216 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 11:10:08.216 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 11:10:08.227 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 11:10:09.140 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:10:09.140 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:10:09.149 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:10:09.159 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:10:09.159 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:10:09.170 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:10:09.183 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 11:10:09.184 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:10:09.192 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:10:09.195 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 11:10:09.195 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:10:09.201 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 11:10:09.205 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 11:10:09.207 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 123(String), 2024-05-30T11:10:09.204(LocalDateTime), 2024-05-30T11:10:09.204(LocalDateTime)
2024-05-30 11:10:09.224 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 11:10:09.225 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 11:10:09.225 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 28(Long), 2024-05-30T11:10:09.225(LocalDateTime), 1(Long)
2024-05-30 11:10:09.242 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 11:10:09.243 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:10:09.243 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:10:09.251 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:10:09.253 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 11:10:09.253 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:10:09.260 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:10:09.261 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 11:10:09.261 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 11:10:09.267 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 11:10:09.270 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 11:10:09.271 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 11:10:09.280 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 11:10:09.281 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 11:10:09.282 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 11:10:09.290 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 11:10:09.292 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 11:10:09.293 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:10:09.301 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 11:10:12.933 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:10:12.934 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:10:12.941 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:10:12.950 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:10:12.950 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:10:12.957 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:10:12.960 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 11:10:12.960 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:10:12.971 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:10:12.974 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 11:10:12.975 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:10:12.983 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 11:10:12.984 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 11:10:12.985 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1234(String), 2024-05-30T11:10:12.984(LocalDateTime), 2024-05-30T11:10:12.984(LocalDateTime)
2024-05-30 11:10:13.000 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 11:10:13.001 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 11:10:13.002 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 29(Long), 2024-05-30T11:10:13(LocalDateTime), 1(Long)
2024-05-30 11:10:13.018 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 11:10:13.019 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:10:13.019 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:10:13.029 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:10:13.031 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 11:10:13.032 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:10:13.040 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:10:13.042 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 11:10:13.043 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 11:10:13.052 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 11:10:13.055 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 11:10:13.055 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 11:10:13.062 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 11:10:13.063 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 11:10:13.064 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 11:10:13.073 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 11:10:13.076 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 11:10:13.077 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:10:13.088 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 11:10:35.648 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:10:35.649 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:10:35.658 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:10:35.667 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:10:35.668 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:10:35.675 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:10:35.678 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 11:10:35.678 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:10:35.688 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:10:35.690 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 11:10:35.690 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:10:35.698 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 11:10:35.700 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 11:10:35.700 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1234(String), 2024-05-30T11:10:35.700(LocalDateTime), 2024-05-30T11:10:35.700(LocalDateTime)
2024-05-30 11:10:35.713 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 11:10:35.716 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 11:10:35.717 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 30(Long), 2024-05-30T11:10:35.715(LocalDateTime), 1(Long)
2024-05-30 11:10:35.734 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 11:10:35.734 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:10:35.734 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:10:35.743 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:10:35.744 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 11:10:35.744 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:10:35.755 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:10:35.756 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 11:10:35.757 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 11:10:35.765 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 11:10:35.767 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 11:10:35.767 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 11:10:35.777 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 11:10:35.778 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 11:10:35.779 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 11:10:35.789 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 11:10:35.791 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 11:10:35.791 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:10:35.801 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 11:10:54.659 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:10:54.659 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:10:54.673 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:10:54.686 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:10:54.686 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:10:54.697 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:10:54.698 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 11:10:54.698 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:10:54.713 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:10:54.714 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 11:10:54.714 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:10:54.722 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 11:10:54.723 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 11:10:54.723 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 12345(String), 2024-05-30T11:10:54.723(LocalDateTime), 2024-05-30T11:10:54.723(LocalDateTime)
2024-05-30 11:10:54.742 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 11:10:54.743 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 11:10:54.744 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 31(Long), 2024-05-30T11:10:54.743(LocalDateTime), 1(Long)
2024-05-30 11:10:54.762 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 11:10:54.763 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:10:54.763 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:10:54.775 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:10:54.778 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 11:10:54.778 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:10:54.789 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:10:54.790 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 11:10:54.790 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 11:10:54.797 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 11:10:54.800 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 11:10:54.800 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 11:10:54.809 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 11:10:54.810 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 11:10:54.810 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 11:10:54.821 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 11:10:54.822 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 11:10:54.823 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:10:54.831 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 11:12:36.126 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:12:36.126 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:12:36.136 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:12:36.140 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 11:12:36.141 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 18(Long), 10(Long)
2024-05-30 11:12:36.152 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 11:13:12.899 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 231 millis. SELECT 1[]
2024-05-30 11:13:13.197 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 265 millis. SELECT 1[]
2024-05-30 11:13:32.342 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:13:32.342 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:13:32.568 ERROR 10704 --- [http-nio-8820-exec-4] c.alibaba.druid.filter.stat.StatFilter   : slow sql 225 millis. SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=?  AND deleted=0[1]
2024-05-30 11:13:32.569 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:13:32.588 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 11:13:32.589 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 11:13:32.600 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 11:14:00.843 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:14:00.843 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:14:00.853 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:14:00.875 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 11:14:00.876 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 11:14:00.886 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 11:14:23.292 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:14:23.292 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:14:23.303 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:14:23.322 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 11:14:23.323 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 11:14:23.335 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 11:14:58.877 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:14:58.878 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:14:58.886 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:14:58.904 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 11:14:58.906 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 11:14:58.918 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 11:15:12.609 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:15:12.610 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:15:12.622 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:15:12.642 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 11:15:12.646 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 11:15:12.657 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 11:15:18.771 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:15:18.772 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:15:18.784 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:15:18.799 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 11:15:18.800 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 11:15:18.811 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 11:16:13.403 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:16:13.404 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:16:13.415 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:18:02.757 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:18:02.758 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:18:02.768 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:18:03.947 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:18:03.948 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:18:03.960 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:18:03.979 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 11:18:03.980 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 11:18:04.000 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 11:18:04.972 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:18:04.972 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:18:04.972 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:18:04.972 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:18:04.983 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:18:04.983 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:18:04.985 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 11:18:04.986 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 11:18:04.997 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 11:18:05.001 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 11:18:05.001 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 11:18:05.017 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 11:18:09.234 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:18:09.235 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:18:09.244 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:18:09.255 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:18:09.255 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:18:09.263 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:18:09.266 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 11:18:09.266 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:18:09.277 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:18:09.279 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 11:18:09.280 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:18:09.288 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 11:18:09.289 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 11:18:09.290 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 你好(String), 2024-05-30T11:18:09.289(LocalDateTime), 2024-05-30T11:18:09.289(LocalDateTime)
2024-05-30 11:18:09.304 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 11:18:09.307 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 11:18:09.307 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 32(Long), 2024-05-30T11:18:09.305(LocalDateTime), 1(Long)
2024-05-30 11:18:09.325 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 11:18:09.325 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:18:09.326 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:18:09.334 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:18:09.335 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 11:18:09.336 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:18:09.343 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:18:09.345 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 11:18:09.346 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 11:18:09.355 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 11:18:09.357 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 11:18:09.357 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 11:18:09.367 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 11:18:09.368 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 11:18:09.369 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 11:18:09.381 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 11:18:09.383 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 11:18:09.384 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:18:09.396 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 11:21:22.384 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:21:22.384 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:21:22.393 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:21:22.404 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:21:22.404 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:21:22.412 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:21:22.413 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 11:21:22.413 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:21:22.421 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:21:22.423 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 11:21:22.423 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:21:22.432 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 11:21:22.433 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 11:21:22.433 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 😒🙄你好🤢😚(String), 2024-05-30T11:21:22.432(LocalDateTime), 2024-05-30T11:21:22.432(LocalDateTime)
2024-05-30 11:21:22.449 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 11:21:22.450 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 11:21:22.450 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 33(Long), 2024-05-30T11:21:22.449(LocalDateTime), 1(Long)
2024-05-30 11:21:22.464 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 11:21:22.465 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:21:22.465 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:21:22.474 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:21:22.476 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 11:21:22.476 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:21:22.485 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:21:22.487 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 11:21:22.487 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 11:21:22.493 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 11:21:22.494 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 11:21:22.495 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 11:21:22.502 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 11:21:22.503 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 11:21:22.503 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 11:21:22.513 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 11:21:22.514 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 11:21:22.515 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:21:22.527 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 11:26:43.763 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:26:43.764 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:26:43.775 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:26:43.790 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:26:43.791 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:26:43.801 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:26:43.804 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 11:26:43.804 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:26:43.814 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:26:43.815 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 11:26:43.816 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:26:43.826 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 11:26:43.827 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 11:26:43.827 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T11:26:43.826(LocalDateTime), 2024-05-30T11:26:43.826(LocalDateTime)
2024-05-30 11:26:43.847 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 11:26:43.848 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 11:26:43.848 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 34(Long), 2024-05-30T11:26:43.847(LocalDateTime), 1(Long)
2024-05-30 11:26:43.866 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 11:26:43.867 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:26:43.867 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:26:43.878 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:26:43.881 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 11:26:43.882 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:26:43.892 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:26:43.894 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 11:26:43.894 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 11:26:43.902 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 11:26:43.906 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 11:26:43.906 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 11:26:43.914 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 11:26:43.915 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 11:26:43.915 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 11:26:43.927 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 11:26:43.928 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 11:26:43.929 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:26:43.938 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 11:26:45.834 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:26:45.835 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:26:45.844 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:26:45.855 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:26:45.855 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:26:45.865 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:26:45.866 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 11:26:45.867 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:26:45.876 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:26:45.878 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 11:26:45.879 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:26:45.889 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 11:26:45.890 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 11:26:45.890 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T11:26:45.889(LocalDateTime), 2024-05-30T11:26:45.889(LocalDateTime)
2024-05-30 11:26:45.907 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 11:26:45.911 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 11:26:45.911 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 35(Long), 2024-05-30T11:26:45.908(LocalDateTime), 1(Long)
2024-05-30 11:26:45.929 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 11:26:45.929 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:26:45.930 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:26:45.939 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:26:45.944 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 11:26:45.944 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:26:45.953 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:26:45.954 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 11:26:45.954 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 11:26:45.964 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 11:26:45.966 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 11:26:45.966 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 11:26:45.973 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 11:26:45.977 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 11:26:45.980 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 11:26:45.994 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 11:26:45.995 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 11:26:45.996 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:26:46.007 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 11:28:03.132 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:28:03.133 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:28:03.143 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:28:03.569 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:28:03.569 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:28:03.580 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:28:03.598 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 11:28:03.599 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 11:28:03.612 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 11:28:04.166 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:28:04.166 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:28:04.167 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:28:04.168 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:28:04.174 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:28:04.179 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:28:04.179 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 11:28:04.181 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 11:28:04.191 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 11:28:04.197 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 11:28:04.198 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 11:28:04.213 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 11:28:05.454 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:28:05.454 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:28:05.464 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:28:05.476 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:28:05.476 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:28:05.484 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:28:05.486 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 11:28:05.489 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:28:05.496 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:28:05.498 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 11:28:05.499 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:28:05.506 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 11:28:05.508 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 11:28:05.510 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T11:28:05.506(LocalDateTime), 2024-05-30T11:28:05.506(LocalDateTime)
2024-05-30 11:28:05.527 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 11:28:05.529 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 11:28:05.529 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 36(Long), 2024-05-30T11:28:05.528(LocalDateTime), 1(Long)
2024-05-30 11:28:05.544 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 11:28:05.546 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:28:05.546 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:28:05.555 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:28:05.558 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 11:28:05.559 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:28:05.567 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:28:05.569 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 11:28:05.569 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 11:28:05.577 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 11:28:05.580 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 11:28:05.581 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 11:28:05.591 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 11:28:05.593 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 11:28:05.594 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 11:28:05.604 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 11:28:05.605 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 11:28:05.606 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:28:05.614 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 11:29:08.648 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:29:08.649 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:29:08.657 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:29:09.060 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:29:09.060 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:29:09.071 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:29:09.089 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 11:29:09.090 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 11:29:09.100 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 11:29:25.478 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:29:25.479 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:29:25.487 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:29:25.489 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 11:29:25.490 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 11:29:25.500 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 11:29:56.184 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:29:56.185 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:29:56.194 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:29:56.215 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 11:29:56.215 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 11:29:56.232 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 11:29:59.235 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:29:59.236 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:29:59.258 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:29:59.712 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:29:59.712 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:29:59.724 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:29:59.744 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 11:29:59.746 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 11:29:59.760 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 11:30:00.671 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:30:00.671 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:30:00.681 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:30:00.683 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 11:30:00.684 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 11:30:00.686 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:30:00.686 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:30:00.695 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:30:00.695 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 11:30:00.715 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 11:30:00.715 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 11:30:00.731 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 11:30:01.547 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:30:01.548 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:30:01.562 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:30:01.577 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:30:01.578 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:30:01.591 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:30:01.595 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 11:30:01.595 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:30:01.608 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:30:01.612 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 11:30:01.612 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:30:01.624 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 11:30:01.625 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 11:30:01.626 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T11:30:01.625(LocalDateTime), 2024-05-30T11:30:01.625(LocalDateTime)
2024-05-30 11:30:01.651 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 11:30:01.653 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 11:30:01.653 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 37(Long), 2024-05-30T11:30:01.652(LocalDateTime), 1(Long)
2024-05-30 11:30:01.685 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 11:30:01.686 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:30:01.686 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:30:01.700 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:30:01.701 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 11:30:01.701 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:30:01.716 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:30:01.719 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 11:30:01.720 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 11:30:01.735 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 11:30:01.738 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 11:30:01.738 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 11:30:01.748 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 11:30:01.750 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 11:30:01.750 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 11:30:01.763 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 11:30:01.765 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 11:30:01.766 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:30:01.780 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 11:30:02.800 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:30:02.800 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:30:02.810 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:30:02.834 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:30:02.834 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:30:02.844 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:30:02.847 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 11:30:02.848 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:30:02.857 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:30:02.861 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 11:30:02.861 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:30:02.869 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 11:30:02.870 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 11:30:02.872 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T11:30:02.869(LocalDateTime), 2024-05-30T11:30:02.869(LocalDateTime)
2024-05-30 11:30:02.896 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 11:30:02.898 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 11:30:02.898 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 38(Long), 2024-05-30T11:30:02.898(LocalDateTime), 1(Long)
2024-05-30 11:30:02.916 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 11:30:02.916 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:30:02.917 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:30:02.926 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:30:02.928 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 11:30:02.928 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:30:02.937 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:30:02.940 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 11:30:02.940 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 11:30:02.950 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 11:30:02.954 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 11:30:02.954 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 11:30:02.963 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 11:30:02.965 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 11:30:02.965 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 11:30:02.978 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 11:30:02.983 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 11:30:02.983 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:30:02.994 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 11:30:10.957 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:30:10.958 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:30:10.967 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:30:11.380 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:30:11.381 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:30:11.394 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:30:11.411 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 11:30:11.412 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 11:30:11.425 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 11:30:12.404 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:30:12.405 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:30:12.409 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:30:12.410 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:30:12.415 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:30:12.418 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 11:30:12.418 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 11:30:12.420 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:30:12.426 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 11:30:12.443 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 11:30:12.444 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 11:30:12.459 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 11:30:13.224 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 11:30:13.224 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:30:13.237 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 11:30:13.247 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:30:13.247 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:30:13.256 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:30:13.257 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 11:30:13.257 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:30:13.266 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:30:13.269 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 11:30:13.270 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:30:13.280 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 11:30:13.282 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 11:30:13.282 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T11:30:13.281(LocalDateTime), 2024-05-30T11:30:13.281(LocalDateTime)
2024-05-30 11:30:13.304 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 11:30:13.305 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 11:30:13.305 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 39(Long), 2024-05-30T11:30:13.304(LocalDateTime), 1(Long)
2024-05-30 11:30:13.324 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 11:30:13.324 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 11:30:13.325 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 11:30:13.333 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 11:30:13.336 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 11:30:13.336 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 11:30:13.345 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 11:30:13.349 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 11:30:13.350 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 11:30:13.362 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 11:30:13.366 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 11:30:13.366 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 11:30:13.378 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 11:30:13.380 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 11:30:13.381 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 11:30:13.396 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 11:30:13.397 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 11:30:13.398 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 11:30:13.414 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 11:39:14.833 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 391 millis. SELECT 1[]
2024-05-30 11:39:15.448 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 614 millis. SELECT 1[]
2024-05-30 11:39:15.783 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 335 millis. SELECT 1[]
2024-05-30 11:39:16.147 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 363 millis. SELECT 1[]
2024-05-30 11:39:16.495 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 346 millis. SELECT 1[]
2024-05-30 11:39:17.124 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 620 millis. SELECT 1[]
2024-05-30 11:39:19.983 ERROR 10704 --- [Druid-ConnectionPool-Create-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 434 millis. SELECT 1[]
2024-05-30 11:40:17.744 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 617 millis. SELECT 1[]
2024-05-30 11:40:18.132 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 388 millis. SELECT 1[]
2024-05-30 11:40:18.588 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 455 millis. SELECT 1[]
2024-05-30 11:40:19.047 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 458 millis. SELECT 1[]
2024-05-30 11:40:19.511 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 452 millis. SELECT 1[]
2024-05-30 11:40:20.061 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 548 millis. SELECT 1[]
2024-05-30 11:42:20.663 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 578 millis. SELECT 1[]
2024-05-30 11:42:21.188 ERROR 10704 --- [Druid-ConnectionPool-Destroy-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 504 millis. SELECT 1[]
2024-05-30 11:42:25.405 ERROR 10704 --- [Druid-ConnectionPool-Create-391308380] c.alibaba.druid.filter.stat.StatFilter   : slow sql 280 millis. SELECT 1[]
2024-05-30 13:06:17.709 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:06:17.719 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:06:17.737 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:06:18.081 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:06:18.083 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:06:18.093 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:06:18.118 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:06:18.123 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:06:18.139 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:06:18.666 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:06:18.666 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:06:18.676 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:06:18.677 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:06:18.677 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:06:18.687 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:06:18.704 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:06:18.705 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:06:18.709 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:06:18.709 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:06:18.714 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:06:18.723 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:06:43.248 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:06:43.248 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:06:43.258 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:06:43.552 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:06:43.553 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:06:43.562 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:06:43.586 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:06:43.588 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:06:43.601 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:06:44.152 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:06:44.152 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:06:44.152 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:06:44.152 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:06:44.160 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:06:44.163 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:06:44.165 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:06:44.165 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:06:44.175 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:06:44.178 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:06:44.179 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:06:44.189 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:06:46.952 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:06:46.952 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:06:46.961 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:06:46.962 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:06:46.963 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 30(Long), 10(Long)
2024-05-30 13:06:46.973 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:06:52.490 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:06:52.490 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:06:52.500 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:06:52.512 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:06:52.512 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:06:52.522 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:06:52.524 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:06:52.525 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:06:52.534 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:06:52.536 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:06:52.537 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:06:52.546 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:06:52.548 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:06:52.549 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:06:52.547(LocalDateTime), 2024-05-30T13:06:52.547(LocalDateTime)
2024-05-30 13:06:52.567 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:06:52.569 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:06:52.569 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 40(Long), 2024-05-30T13:06:52.568(LocalDateTime), 1(Long)
2024-05-30 13:06:52.589 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:06:52.589 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:06:52.589 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:06:52.602 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:06:52.604 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:06:52.604 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:06:52.614 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:06:52.615 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:06:52.615 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:06:52.626 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:06:52.629 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:06:52.629 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:06:52.639 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:06:52.640 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:06:52.640 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:06:52.652 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:06:52.655 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:06:52.655 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:06:52.667 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:06:56.636 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:06:56.636 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:06:56.647 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:06:56.662 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:06:56.663 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:06:56.672 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:06:56.674 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:06:56.674 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:06:56.682 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:06:56.685 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:06:56.685 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:06:56.695 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:06:56.696 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:06:56.696 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:06:56.695(LocalDateTime), 2024-05-30T13:06:56.695(LocalDateTime)
2024-05-30 13:06:56.717 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:06:56.718 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:06:56.718 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 41(Long), 2024-05-30T13:06:56.717(LocalDateTime), 1(Long)
2024-05-30 13:06:56.739 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:06:56.740 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:06:56.741 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:06:56.751 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:06:56.753 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:06:56.753 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:06:56.762 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:06:56.764 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:06:56.764 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:06:56.776 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:06:56.778 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:06:56.779 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:06:56.786 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:06:56.787 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:06:56.787 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:06:56.802 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:06:56.803 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:06:56.803 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:06:56.815 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:07:32.781 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:07:32.782 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:07:32.805 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:07:33.089 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:07:33.089 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:07:33.100 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:07:33.121 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:07:33.122 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:07:33.137 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:07:33.895 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:07:33.895 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:07:33.896 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:07:33.896 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:07:33.908 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:07:33.908 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:07:33.911 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:07:33.911 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:07:33.922 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:07:33.926 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:07:33.927 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:07:33.939 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:07:42.166 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:07:42.166 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:07:42.177 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:07:42.187 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:07:42.187 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:07:42.198 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:07:42.201 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:07:42.201 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:07:42.210 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:07:42.212 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:07:42.212 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:07:42.222 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:07:42.223 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:07:42.223 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:07:42.222(LocalDateTime), 2024-05-30T13:07:42.222(LocalDateTime)
2024-05-30 13:07:42.242 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:07:42.243 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:07:42.243 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 42(Long), 2024-05-30T13:07:42.242(LocalDateTime), 1(Long)
2024-05-30 13:07:42.262 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:07:42.263 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:07:42.263 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:07:42.273 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:07:42.275 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:07:42.275 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:07:42.283 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:07:42.285 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:07:42.285 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:07:42.295 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:07:42.296 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:07:42.297 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:07:42.307 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:07:42.308 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:07:42.309 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:07:42.322 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:07:42.323 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:07:42.324 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:07:42.336 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:07:45.440 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:07:45.440 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:07:45.450 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:07:45.459 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:07:45.459 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:07:45.467 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:07:45.469 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:07:45.470 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:07:45.479 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:07:45.481 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:07:45.482 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:07:45.490 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:07:45.490 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:07:45.491 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:07:45.490(LocalDateTime), 2024-05-30T13:07:45.490(LocalDateTime)
2024-05-30 13:07:45.511 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:07:45.512 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:07:45.512 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 43(Long), 2024-05-30T13:07:45.512(LocalDateTime), 1(Long)
2024-05-30 13:07:45.528 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:07:45.528 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:07:45.529 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:07:45.537 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:07:45.538 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:07:45.538 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:07:45.548 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:07:45.550 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:07:45.550 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:07:45.560 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:07:45.561 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:07:45.561 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:07:45.571 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:07:45.571 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:07:45.572 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:07:45.586 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:07:45.586 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:07:45.587 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:07:45.601 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:08:08.182 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:08:08.182 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:08:08.193 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:08:08.202 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:08:08.202 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:08:08.211 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:08:08.213 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:08:08.213 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:08:08.223 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:08:08.225 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:08:08.225 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:08:08.235 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:08:08.235 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:08:08.235 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:08:08.235(LocalDateTime), 2024-05-30T13:08:08.235(LocalDateTime)
2024-05-30 13:08:08.253 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:08:08.254 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:08:08.254 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 44(Long), 2024-05-30T13:08:08.253(LocalDateTime), 1(Long)
2024-05-30 13:08:08.272 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:08:08.272 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:08:08.272 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:08:08.281 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:08:08.282 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:08:08.282 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:08:08.292 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:08:08.293 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:08:08.294 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:08:08.303 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:08:08.304 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:08:08.305 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:08:08.314 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:08:08.315 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:08:08.315 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:08:08.327 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:08:08.328 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:08:08.328 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:08:08.337 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:09:10.420 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:09:10.420 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:10.432 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:09:10.814 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:09:10.814 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:10.824 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:09:10.843 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:09:10.844 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:09:10.858 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:09:12.093 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:09:12.093 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:12.095 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:09:12.095 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:12.101 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:09:12.102 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:09:12.103 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:09:12.103 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:09:12.113 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:09:12.120 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:09:12.120 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:09:12.137 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:09:18.231 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:09:18.231 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:18.239 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:09:18.249 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:09:18.249 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:18.259 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:09:18.261 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:09:18.261 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:09:18.271 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:09:18.273 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:09:18.273 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:09:18.282 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:09:18.282 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:09:18.282 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:09:18.282(LocalDateTime), 2024-05-30T13:09:18.282(LocalDateTime)
2024-05-30 13:09:18.298 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:09:18.298 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:09:18.298 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 45(Long), 2024-05-30T13:09:18.298(LocalDateTime), 1(Long)
2024-05-30 13:09:18.316 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:09:18.316 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:09:18.316 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:18.326 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:09:18.327 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:09:18.327 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:09:18.336 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:09:18.338 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:09:18.338 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:09:18.348 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:09:18.350 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:09:18.350 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:09:18.358 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:09:18.359 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:09:18.360 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:09:18.373 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:09:18.374 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:09:18.375 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:09:18.385 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:09:20.982 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:09:20.982 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:20.992 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:09:20.999 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:09:20.999 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:21.008 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:09:21.009 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:09:21.009 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:09:21.018 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:09:21.020 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:09:21.020 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:09:21.029 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:09:21.029 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:09:21.030 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:09:21.029(LocalDateTime), 2024-05-30T13:09:21.029(LocalDateTime)
2024-05-30 13:09:21.044 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:09:21.045 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:09:21.045 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 46(Long), 2024-05-30T13:09:21.045(LocalDateTime), 1(Long)
2024-05-30 13:09:21.061 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:09:21.061 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:09:21.062 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:21.069 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:09:21.070 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:09:21.070 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:09:21.076 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:09:21.078 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:09:21.078 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:09:21.086 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:09:21.088 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:09:21.088 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:09:21.097 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:09:21.098 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:09:21.099 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:09:21.109 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:09:21.111 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:09:21.111 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:09:21.122 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:09:24.070 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:09:24.071 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:24.079 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:09:24.090 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:09:24.090 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:24.098 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:09:24.101 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:09:24.101 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:09:24.110 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:09:24.112 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:09:24.112 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:09:24.119 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:09:24.120 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:09:24.120 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 21(String), 2024-05-30T13:09:24.120(LocalDateTime), 2024-05-30T13:09:24.120(LocalDateTime)
2024-05-30 13:09:24.138 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:09:24.139 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:09:24.139 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 47(Long), 2024-05-30T13:09:24.139(LocalDateTime), 1(Long)
2024-05-30 13:09:24.156 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:09:24.157 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:09:24.157 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:24.165 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:09:24.166 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:09:24.166 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:09:24.175 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:09:24.178 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:09:24.178 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:09:24.188 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:09:24.190 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:09:24.190 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:09:24.198 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:09:24.199 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:09:24.199 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:09:24.210 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:09:24.211 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:09:24.211 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:09:24.222 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:09:52.414 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:09:52.414 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:52.423 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:09:52.716 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:09:52.716 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:52.726 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:09:52.745 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:09:52.746 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:09:52.758 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:09:53.227 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:09:53.227 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:09:53.227 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:53.228 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:53.238 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:09:53.238 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:09:53.240 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:09:53.241 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:09:53.254 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:09:53.258 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:09:53.258 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:09:53.276 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:09:54.693 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:09:54.693 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:54.702 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:09:54.713 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:09:54.713 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:54.721 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:09:54.722 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:09:54.723 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:09:54.731 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:09:54.732 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:09:54.732 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:09:54.740 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:09:54.741 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:09:54.741 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 23(String), 2024-05-30T13:09:54.741(LocalDateTime), 2024-05-30T13:09:54.741(LocalDateTime)
2024-05-30 13:09:54.757 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:09:54.758 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:09:54.758 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 48(Long), 2024-05-30T13:09:54.758(LocalDateTime), 1(Long)
2024-05-30 13:09:54.775 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:09:54.776 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:09:54.776 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:54.784 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:09:54.785 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:09:54.785 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:09:54.795 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:09:54.797 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:09:54.798 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:09:54.807 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:09:54.808 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:09:54.808 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:09:54.818 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:09:54.818 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:09:54.819 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:09:54.830 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:09:54.832 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:09:54.832 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:09:54.844 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:09:57.695 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:09:57.695 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:57.703 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:09:57.710 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:09:57.711 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:57.718 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:09:57.721 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:09:57.721 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:09:57.728 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:09:57.729 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:09:57.729 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:09:57.737 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:09:57.738 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:09:57.738 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 23(String), 2024-05-30T13:09:57.738(LocalDateTime), 2024-05-30T13:09:57.738(LocalDateTime)
2024-05-30 13:09:57.756 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:09:57.756 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:09:57.756 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 49(Long), 2024-05-30T13:09:57.756(LocalDateTime), 1(Long)
2024-05-30 13:09:57.771 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:09:57.771 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:09:57.771 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:09:57.779 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:09:57.780 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:09:57.781 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:09:57.790 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:09:57.791 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:09:57.792 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:09:57.801 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:09:57.802 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:09:57.802 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:09:57.811 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:09:57.811 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:09:57.812 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:09:57.822 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:09:57.824 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:09:57.824 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:09:57.835 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:10:00.581 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:10:00.581 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:00.591 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:10:00.599 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:10:00.599 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:00.608 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:10:00.609 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:10:00.610 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:10:00.617 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:10:00.618 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:10:00.618 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:10:00.627 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:10:00.628 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:10:00.628 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 10(String), 2024-05-30T13:10:00.627(LocalDateTime), 2024-05-30T13:10:00.627(LocalDateTime)
2024-05-30 13:10:00.644 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:10:00.645 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:10:00.645 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 50(Long), 2024-05-30T13:10:00.644(LocalDateTime), 1(Long)
2024-05-30 13:10:00.662 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:10:00.662 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:10:00.662 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:00.671 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:10:00.672 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:10:00.672 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:10:00.680 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:10:00.681 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:10:00.681 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:10:00.691 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:10:00.693 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:10:00.693 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:10:00.702 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:10:00.703 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:10:00.704 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:10:00.714 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:10:00.715 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:10:00.716 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:10:00.725 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:10:17.878 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:10:17.879 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:17.889 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:10:18.316 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:10:18.317 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:18.329 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:10:18.401 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:10:18.406 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:10:18.417 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:10:18.884 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:10:18.885 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:18.889 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:10:18.889 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:18.893 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:10:18.913 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:10:18.915 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:10:18.915 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:10:18.945 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:10:18.946 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:10:18.946 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:10:18.977 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:10:20.569 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:10:20.569 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:20.588 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:10:20.604 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:10:20.605 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:20.623 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:10:20.625 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:10:20.625 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:10:20.642 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:10:20.643 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:10:20.644 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:10:20.657 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:10:20.658 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:10:20.658 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 13(String), 2024-05-30T13:10:20.657(LocalDateTime), 2024-05-30T13:10:20.657(LocalDateTime)
2024-05-30 13:10:20.686 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:10:20.687 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:10:20.688 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 51(Long), 2024-05-30T13:10:20.686(LocalDateTime), 1(Long)
2024-05-30 13:10:20.711 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:10:20.712 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:10:20.712 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:20.725 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:10:20.728 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:10:20.728 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:10:20.739 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:10:20.741 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:10:20.742 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:10:20.755 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:10:20.757 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:10:20.757 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:10:20.775 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:10:20.775 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:10:20.776 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:10:20.796 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:10:20.797 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:10:20.797 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:10:20.820 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:10:23.492 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:10:23.492 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:23.509 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:10:23.523 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:10:23.523 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:23.540 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:10:23.542 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:10:23.542 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:10:23.557 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:10:23.559 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:10:23.559 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:10:23.573 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:10:23.573 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:10:23.574 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 14(String), 2024-05-30T13:10:23.573(LocalDateTime), 2024-05-30T13:10:23.573(LocalDateTime)
2024-05-30 13:10:23.605 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:10:23.606 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:10:23.606 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 52(Long), 2024-05-30T13:10:23.605(LocalDateTime), 1(Long)
2024-05-30 13:10:23.650 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:10:23.651 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:10:23.651 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:23.671 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:10:23.674 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:10:23.674 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:10:23.687 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:10:23.689 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:10:23.689 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:10:23.704 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:10:23.706 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:10:23.706 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:10:23.728 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:10:23.729 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:10:23.730 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:10:23.755 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:10:23.757 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:10:23.758 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:10:23.784 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:10:28.357 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:10:28.357 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:28.371 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:10:28.384 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:10:28.384 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:28.391 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:10:28.393 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:10:28.393 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:10:28.399 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:10:28.401 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:10:28.401 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:10:28.409 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:10:28.409 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:10:28.410 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 12(String), 2024-05-30T13:10:28.409(LocalDateTime), 2024-05-30T13:10:28.409(LocalDateTime)
2024-05-30 13:10:28.424 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:10:28.425 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:10:28.426 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 53(Long), 2024-05-30T13:10:28.425(LocalDateTime), 1(Long)
2024-05-30 13:10:28.440 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:10:28.440 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:10:28.441 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:28.450 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:10:28.451 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:10:28.451 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:10:28.458 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:10:28.460 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:10:28.460 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:10:28.468 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:10:28.470 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:10:28.470 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:10:28.478 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:10:28.479 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:10:28.479 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:10:28.493 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:10:28.494 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:10:28.495 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:10:28.505 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:10:33.380 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:10:33.380 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:33.388 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:10:33.395 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:10:33.395 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:33.402 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:10:33.404 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:10:33.404 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:10:33.412 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:10:33.413 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:10:33.415 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:10:33.426 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:10:33.427 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:10:33.428 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:10:33.426(LocalDateTime), 2024-05-30T13:10:33.426(LocalDateTime)
2024-05-30 13:10:33.444 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:10:33.444 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:10:33.445 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 54(Long), 2024-05-30T13:10:33.444(LocalDateTime), 1(Long)
2024-05-30 13:10:33.462 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:10:33.463 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:10:33.463 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:33.470 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:10:33.471 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:10:33.472 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:10:33.481 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:10:33.482 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:10:33.483 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:10:33.490 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:10:33.492 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:10:33.492 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:10:33.504 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:10:33.504 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:10:33.504 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:10:33.515 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:10:33.516 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:10:33.517 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:10:33.527 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:10:38.026 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:10:38.027 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:38.035 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:10:38.042 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:10:38.042 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:38.050 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:10:38.052 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:10:38.052 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:10:38.060 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:10:38.063 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:10:38.064 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:10:38.071 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:10:38.072 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:10:38.072 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T13:10:38.072(LocalDateTime), 2024-05-30T13:10:38.072(LocalDateTime)
2024-05-30 13:10:38.089 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:10:38.090 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:10:38.091 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 55(Long), 2024-05-30T13:10:38.090(LocalDateTime), 1(Long)
2024-05-30 13:10:38.108 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:10:38.109 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:10:38.109 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:10:38.116 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:10:38.117 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:10:38.117 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:10:38.125 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:10:38.126 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:10:38.126 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:10:38.133 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:10:38.134 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:10:38.135 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:10:38.143 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:10:38.144 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:10:38.144 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:10:38.153 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:10:38.155 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:10:38.155 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:10:38.165 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:12:13.052 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:12:13.052 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:12:13.061 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:12:13.352 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:12:13.353 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:12:13.362 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:12:13.383 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:12:13.384 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:12:13.395 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:12:14.152 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:12:14.153 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:12:14.159 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:12:14.159 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:12:14.162 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:12:14.167 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:12:14.169 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:12:14.169 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:12:14.177 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:12:14.182 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:12:14.182 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:12:14.195 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:12:25.371 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:12:25.371 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:12:25.380 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:12:25.391 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:12:25.391 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:12:25.399 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:12:25.401 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:12:25.401 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:12:25.410 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:12:25.412 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:12:25.412 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:12:25.424 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:12:25.425 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:12:25.425 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:12:25.424(LocalDateTime), 2024-05-30T13:12:25.424(LocalDateTime)
2024-05-30 13:12:25.442 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:12:25.442 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:12:25.443 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 56(Long), 2024-05-30T13:12:25.442(LocalDateTime), 1(Long)
2024-05-30 13:12:25.486 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:12:25.486 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:12:25.486 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:12:25.494 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:12:25.496 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:12:25.496 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:12:25.506 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:12:25.508 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:12:25.509 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:12:25.517 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:12:25.519 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:12:25.519 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:12:25.527 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:12:25.529 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:12:25.529 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:12:25.540 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:12:25.542 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:12:25.543 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:12:25.553 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:15:28.041 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:15:28.042 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:15:28.051 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:15:28.359 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:15:28.359 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:15:28.367 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:15:28.388 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:15:28.389 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:15:28.399 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:15:29.000 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:15:29.001 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:15:29.003 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:15:29.003 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:15:29.010 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:15:29.011 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:15:29.013 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:15:29.013 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:15:29.023 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:15:29.029 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:15:29.029 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:15:29.040 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:15:30.750 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:15:30.751 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:15:30.760 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:15:30.761 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:15:30.762 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 47(Long), 10(Long)
2024-05-30 13:15:30.772 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:15:31.931 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:15:31.931 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:15:31.938 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:15:31.947 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:15:31.947 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:15:31.956 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:15:31.958 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:15:31.958 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:15:31.966 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:15:31.967 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:15:31.967 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:15:31.975 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:15:31.976 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:15:31.976 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 22(String), 2024-05-30T13:15:31.975(LocalDateTime), 2024-05-30T13:15:31.975(LocalDateTime)
2024-05-30 13:15:31.992 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:15:31.993 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:15:31.993 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 57(Long), 2024-05-30T13:15:31.993(LocalDateTime), 1(Long)
2024-05-30 13:15:32.008 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:15:32.009 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:15:32.009 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:15:32.017 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:15:32.018 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:15:32.018 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:15:32.027 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:15:32.028 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:15:32.029 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:15:32.037 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:15:32.039 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:15:32.040 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:15:32.047 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:15:32.048 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:15:32.048 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:15:32.058 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:15:32.059 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:15:32.059 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:15:32.069 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:15:54.189 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:15:54.189 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:15:54.198 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:15:54.486 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:15:54.487 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:15:54.494 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:15:54.513 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:15:54.513 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:15:54.529 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:15:56.936 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:15:56.936 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:15:56.937 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:15:56.937 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:15:56.945 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:15:56.945 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:15:56.947 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:15:56.948 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:15:56.956 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:15:56.962 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:15:56.963 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:15:56.982 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:15:59.096 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:15:59.097 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:15:59.106 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:15:59.116 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:15:59.116 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:15:59.126 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:15:59.128 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:15:59.128 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:15:59.138 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:15:59.139 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:15:59.140 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:15:59.147 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:15:59.149 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:15:59.149 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:15:59.148(LocalDateTime), 2024-05-30T13:15:59.148(LocalDateTime)
2024-05-30 13:15:59.166 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:15:59.167 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:15:59.167 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 58(Long), 2024-05-30T13:15:59.166(LocalDateTime), 1(Long)
2024-05-30 13:15:59.181 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:15:59.183 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:15:59.183 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:15:59.191 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:15:59.191 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:15:59.192 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:15:59.200 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:15:59.202 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:15:59.202 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:15:59.212 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:15:59.214 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:15:59.214 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:15:59.224 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:15:59.224 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:15:59.225 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:15:59.236 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:15:59.237 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:15:59.237 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:15:59.245 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:16:06.470 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:16:06.470 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:16:06.481 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:16:06.482 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:16:06.482 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 48(Long), 10(Long)
2024-05-30 13:16:06.492 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:16:10.839 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:16:10.840 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:16:10.849 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:16:10.856 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:16:10.856 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:16:10.864 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:16:10.866 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:16:10.866 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:16:10.875 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:16:10.877 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:16:10.877 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:16:10.885 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:16:10.886 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:16:10.887 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T13:16:10.886(LocalDateTime), 2024-05-30T13:16:10.886(LocalDateTime)
2024-05-30 13:16:10.903 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:16:10.904 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:16:10.904 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 59(Long), 2024-05-30T13:16:10.904(LocalDateTime), 1(Long)
2024-05-30 13:16:10.917 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:16:10.917 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:16:10.918 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:16:10.927 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:16:10.930 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:16:10.931 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:16:10.940 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:16:10.941 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:16:10.941 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:16:10.949 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:16:10.950 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:16:10.951 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:16:10.960 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:16:10.960 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:16:10.961 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:16:10.971 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:16:10.973 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:16:10.973 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:16:10.984 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:16:19.490 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:16:19.490 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:16:19.499 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:16:19.500 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:16:19.500 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 38(Long), 10(Long)
2024-05-30 13:16:19.510 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:16:21.823 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:16:21.824 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:16:21.832 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:16:21.834 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:16:21.834 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 28(Long), 10(Long)
2024-05-30 13:16:21.841 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:17:04.567 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:17:04.568 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:17:04.577 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:17:04.580 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:17:04.580 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 18(Long), 10(Long)
2024-05-30 13:17:04.594 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:17:07.394 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:17:07.394 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:17:07.404 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:17:07.413 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:17:07.413 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:17:07.421 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:17:07.422 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:17:07.422 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:17:07.431 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:17:07.433 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:17:07.434 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:17:07.440 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:17:07.441 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:17:07.441 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:17:07.441(LocalDateTime), 2024-05-30T13:17:07.441(LocalDateTime)
2024-05-30 13:17:07.457 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:17:07.458 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:17:07.458 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 60(Long), 2024-05-30T13:17:07.458(LocalDateTime), 1(Long)
2024-05-30 13:17:07.472 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:17:07.473 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:17:07.473 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:17:07.481 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:17:07.482 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:17:07.482 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:17:07.492 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:17:07.494 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:17:07.494 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:17:07.502 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:17:07.503 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:17:07.504 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:17:07.512 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:17:07.513 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:17:07.514 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:17:07.524 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:17:07.525 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:17:07.525 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:17:07.541 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:17:22.341 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:17:22.341 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:17:22.351 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:17:22.688 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:17:22.688 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:17:22.698 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:17:22.715 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:17:22.716 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:17:22.726 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:17:25.519 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:17:25.519 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:17:25.529 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:17:25.529 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:17:25.529 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:17:25.530 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:17:25.531 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:17:25.540 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:17:25.540 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:17:25.558 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:17:25.558 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:17:25.570 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:19:16.880 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:19:16.880 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:19:16.891 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:19:17.233 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:19:17.233 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:19:17.243 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:19:17.265 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:19:17.265 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:19:17.277 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:19:18.383 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:19:18.383 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:19:18.390 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:19:18.390 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:19:18.391 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:19:18.399 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:19:18.401 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:19:18.401 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:19:18.416 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:19:18.461 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:19:18.461 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:19:18.499 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:22:32.586 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:22:32.587 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:22:32.596 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:22:32.933 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:22:32.934 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:22:32.948 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:22:32.966 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:22:32.967 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:22:32.980 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:22:34.503 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:22:34.503 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:22:34.504 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:22:34.504 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:22:34.513 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:22:34.513 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:22:34.514 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:22:34.515 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:22:34.524 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:22:34.530 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:22:34.531 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:22:34.543 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:22:47.464 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:22:47.464 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:22:47.472 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:22:47.772 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:22:47.773 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:22:47.794 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:22:47.812 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:22:47.814 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:22:47.828 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:22:48.387 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:22:48.387 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:22:48.388 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:22:48.388 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:22:48.397 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:22:48.397 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:22:48.398 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:22:48.399 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:22:48.407 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:22:48.413 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:22:48.413 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:22:48.425 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:23:00.252 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:23:00.253 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:23:00.262 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:23:00.565 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:23:00.565 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:23:00.573 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:23:00.592 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:23:00.593 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:23:00.604 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:23:08.110 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:23:08.110 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:23:08.119 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:23:08.451 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:23:08.451 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:23:08.459 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:23:08.477 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:23:08.477 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:23:08.487 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:23:09.614 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:23:09.614 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:23:09.614 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:23:09.614 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:23:09.623 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:23:09.623 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:23:09.624 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:23:09.625 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:23:09.635 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:23:09.641 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:23:09.641 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:23:09.660 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:39:32.944 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:39:32.944 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:39:32.953 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:39:33.232 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:39:33.232 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:39:33.248 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:39:33.266 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:39:33.267 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:39:33.279 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:39:34.668 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:39:34.668 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:39:34.676 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:39:34.678 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:39:34.678 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:39:34.678 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:39:34.678 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:39:34.687 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:39:34.688 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:39:34.706 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:39:34.706 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:39:34.720 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:39:36.966 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:39:36.966 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:39:36.976 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:39:36.988 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:39:36.988 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:39:36.999 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:39:37.004 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:39:37.004 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:39:37.014 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:39:37.016 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:39:37.016 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:39:37.025 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:39:37.027 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:39:37.028 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 123(String), 2024-05-30T13:39:37.027(LocalDateTime), 2024-05-30T13:39:37.027(LocalDateTime)
2024-05-30 13:39:37.049 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:39:37.050 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:39:37.051 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 61(Long), 2024-05-30T13:39:37.050(LocalDateTime), 1(Long)
2024-05-30 13:39:37.069 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:39:37.070 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:39:37.070 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:39:37.078 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:39:37.079 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:39:37.079 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:39:37.090 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:39:37.091 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:39:37.091 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:39:37.100 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:39:37.101 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:39:37.101 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:39:37.112 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:39:37.113 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:39:37.113 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:39:37.125 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:39:37.126 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:39:37.127 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:39:37.139 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:39:46.440 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:39:46.440 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:39:46.452 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:39:46.453 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:39:46.454 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 51(Long), 10(Long)
2024-05-30 13:39:46.465 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:39:47.816 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:39:47.816 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:39:47.827 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:39:48.127 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:39:48.128 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:39:48.138 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:39:48.160 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:39:48.162 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:39:48.174 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:39:48.870 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:39:48.870 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:39:48.870 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:39:48.870 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:39:48.883 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:39:48.883 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:39:48.884 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:39:48.885 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:39:48.897 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:39:48.900 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:39:48.900 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:39:48.917 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:39:52.131 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:39:52.131 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:39:52.141 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:39:52.164 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:39:52.165 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:39:52.182 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:39:52.183 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:39:52.183 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:39:52.195 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:39:52.196 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:39:52.197 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:39:52.204 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:39:52.205 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:39:52.205 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:39:52.205(LocalDateTime), 2024-05-30T13:39:52.205(LocalDateTime)
2024-05-30 13:39:52.222 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:39:52.223 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:39:52.224 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 62(Long), 2024-05-30T13:39:52.223(LocalDateTime), 1(Long)
2024-05-30 13:39:52.241 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:39:52.242 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:39:52.242 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:39:52.253 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:39:52.254 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:39:52.255 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:39:52.264 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:39:52.266 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:39:52.266 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:39:52.276 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:39:52.277 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:39:52.278 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:39:52.286 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:39:52.286 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:39:52.286 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:39:52.297 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:39:52.298 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:39:52.299 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:39:52.309 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:40:13.499 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:40:13.500 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:40:13.508 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:40:13.509 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:40:13.510 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 52(Long), 10(Long)
2024-05-30 13:40:13.519 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:40:14.924 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:40:14.924 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:40:14.934 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:40:14.944 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:40:14.944 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:40:14.954 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:40:14.955 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:40:14.955 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:40:14.966 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:40:14.967 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:40:14.967 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:40:14.978 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:40:14.979 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:40:14.980 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 123(String), 2024-05-30T13:40:14.978(LocalDateTime), 2024-05-30T13:40:14.978(LocalDateTime)
2024-05-30 13:40:15.000 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:40:15.001 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:40:15.001 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 63(Long), 2024-05-30T13:40:15(LocalDateTime), 1(Long)
2024-05-30 13:40:15.020 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:40:15.021 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:40:15.021 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:40:15.030 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:40:15.033 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:40:15.033 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:40:15.044 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:40:15.045 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:40:15.045 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:40:15.056 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:40:15.058 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:40:15.058 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:40:15.068 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:40:15.069 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:40:15.069 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:40:15.081 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:40:15.083 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:40:15.084 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:40:15.096 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:41:03.241 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:41:03.241 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:03.252 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:41:03.262 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:03.263 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:03.271 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:03.274 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:41:03.275 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:03.285 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:03.286 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:41:03.286 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:03.295 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:41:03.296 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:41:03.296 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:41:03.296(LocalDateTime), 2024-05-30T13:41:03.296(LocalDateTime)
2024-05-30 13:41:03.315 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:41:03.315 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:41:03.316 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 64(Long), 2024-05-30T13:41:03.315(LocalDateTime), 1(Long)
2024-05-30 13:41:03.336 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:41:03.337 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:03.337 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:03.348 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:03.350 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:41:03.350 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:03.360 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:03.362 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:41:03.362 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:41:03.373 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:41:03.375 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:41:03.375 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:41:03.384 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:41:03.385 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:41:03.386 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:41:03.398 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:41:03.399 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:41:03.400 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:03.413 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:41:05.227 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:41:05.227 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:05.238 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:41:05.249 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:05.250 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:05.259 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:05.261 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:41:05.261 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:05.271 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:05.272 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:41:05.272 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:05.282 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:41:05.283 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:41:05.283 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T13:41:05.283(LocalDateTime), 2024-05-30T13:41:05.283(LocalDateTime)
2024-05-30 13:41:05.303 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:41:05.304 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:41:05.304 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 65(Long), 2024-05-30T13:41:05.303(LocalDateTime), 1(Long)
2024-05-30 13:41:05.324 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:41:05.324 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:05.324 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:05.334 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:05.336 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:41:05.336 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:05.345 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:05.347 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:41:05.348 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:41:05.356 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:41:05.357 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:41:05.358 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:41:05.368 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:41:05.368 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:41:05.369 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:41:05.381 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:41:05.382 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:41:05.383 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:05.394 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:41:07.123 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:41:07.123 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:07.132 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:41:07.133 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:41:07.134 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 42(Long), 10(Long)
2024-05-30 13:41:07.143 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:41:10.013 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:41:10.013 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:10.021 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:41:10.031 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:10.031 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:10.041 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:10.043 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:41:10.043 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:10.051 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:10.053 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:41:10.053 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:10.063 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:41:10.064 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:41:10.065 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T13:41:10.063(LocalDateTime), 2024-05-30T13:41:10.063(LocalDateTime)
2024-05-30 13:41:10.081 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:41:10.081 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:41:10.082 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 66(Long), 2024-05-30T13:41:10.081(LocalDateTime), 1(Long)
2024-05-30 13:41:10.099 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:41:10.100 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:10.100 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:10.110 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:10.111 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:41:10.111 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:10.120 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:10.121 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:41:10.121 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:41:10.131 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:41:10.133 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:41:10.133 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:41:10.143 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:41:10.144 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:41:10.144 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:41:10.152 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:41:10.153 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:41:10.154 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:10.165 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:41:11.517 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:41:11.517 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:11.527 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:41:11.535 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:11.535 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:11.544 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:11.546 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:41:11.546 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:11.553 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:11.554 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:41:11.554 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:11.563 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:41:11.564 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:41:11.564 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 31(String), 2024-05-30T13:41:11.563(LocalDateTime), 2024-05-30T13:41:11.563(LocalDateTime)
2024-05-30 13:41:11.584 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:41:11.584 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:41:11.585 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 67(Long), 2024-05-30T13:41:11.584(LocalDateTime), 1(Long)
2024-05-30 13:41:11.602 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:41:11.602 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:11.602 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:11.612 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:11.614 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:41:11.614 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:11.622 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:11.623 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:41:11.623 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:41:11.632 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:41:11.633 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:41:11.633 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:41:11.642 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:41:11.643 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:41:11.643 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:41:11.654 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:41:11.655 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:41:11.655 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:11.666 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:41:16.678 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:41:16.679 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:16.689 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:41:16.970 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:41:16.970 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:16.980 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:41:16.999 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:41:16.999 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:41:17.009 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:41:17.909 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:41:17.909 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:41:17.910 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:17.910 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:17.918 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:41:17.918 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:41:17.919 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:41:17.920 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:41:17.930 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:41:17.936 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:41:17.936 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:41:17.956 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:41:23.046 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:41:23.046 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:23.054 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:41:23.063 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:23.064 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:23.073 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:23.074 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:41:23.075 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:23.084 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:23.085 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:41:23.085 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:23.093 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:41:23.094 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:41:23.095 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:41:23.093(LocalDateTime), 2024-05-30T13:41:23.093(LocalDateTime)
2024-05-30 13:41:23.113 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:41:23.113 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:41:23.114 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 68(Long), 2024-05-30T13:41:23.113(LocalDateTime), 1(Long)
2024-05-30 13:41:23.130 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:41:23.131 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:23.131 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:23.139 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:23.141 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:41:23.141 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:23.149 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:23.150 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:41:23.151 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:41:23.159 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:41:23.160 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:41:23.160 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:41:23.169 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:41:23.170 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:41:23.170 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:41:23.181 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:41:23.182 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:41:23.182 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:23.192 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:41:24.920 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:41:24.920 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:24.935 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:41:24.946 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:24.946 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:24.955 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:24.955 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:41:24.956 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:24.964 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:24.965 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:41:24.966 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:24.973 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:41:24.973 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:41:24.974 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T13:41:24.973(LocalDateTime), 2024-05-30T13:41:24.973(LocalDateTime)
2024-05-30 13:41:24.991 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:41:24.992 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:41:24.992 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 69(Long), 2024-05-30T13:41:24.991(LocalDateTime), 1(Long)
2024-05-30 13:41:25.011 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:41:25.011 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:25.011 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:25.019 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:25.021 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:41:25.021 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:25.030 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:25.031 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:41:25.031 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:41:25.040 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:41:25.041 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:41:25.041 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:41:25.051 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:41:25.051 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:41:25.052 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:41:25.063 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:41:25.064 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:41:25.064 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:25.075 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:41:26.019 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:41:26.019 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:26.028 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:41:26.037 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:26.037 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:26.045 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:26.046 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:41:26.046 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:26.054 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:26.055 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:41:26.055 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:26.065 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:41:26.065 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:41:26.066 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T13:41:26.065(LocalDateTime), 2024-05-30T13:41:26.065(LocalDateTime)
2024-05-30 13:41:26.082 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:41:26.083 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:41:26.083 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 70(Long), 2024-05-30T13:41:26.083(LocalDateTime), 1(Long)
2024-05-30 13:41:26.100 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:41:26.100 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:26.101 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:26.110 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:26.112 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:41:26.112 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:26.120 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:26.121 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:41:26.121 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:41:26.131 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:41:26.132 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:41:26.132 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:41:26.142 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:41:26.143 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:41:26.143 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:41:26.151 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:41:26.152 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:41:26.152 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:26.163 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:41:26.820 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:41:26.820 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:26.831 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:41:26.842 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:26.842 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:26.853 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:26.854 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:41:26.854 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:26.866 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:26.867 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:41:26.868 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:26.877 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:41:26.877 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:41:26.878 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 4(String), 2024-05-30T13:41:26.877(LocalDateTime), 2024-05-30T13:41:26.877(LocalDateTime)
2024-05-30 13:41:26.893 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:41:26.894 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:41:26.894 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 71(Long), 2024-05-30T13:41:26.894(LocalDateTime), 1(Long)
2024-05-30 13:41:26.914 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:41:26.915 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:26.915 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:26.924 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:26.926 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:41:26.926 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:26.935 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:26.937 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:41:26.937 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:41:26.946 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:41:26.947 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:41:26.947 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:41:26.957 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:41:26.958 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:41:26.959 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:41:26.971 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:41:26.972 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:41:26.973 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:26.984 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:41:27.472 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:41:27.473 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:27.481 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:41:27.493 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:27.495 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:27.505 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:27.508 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:41:27.508 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:27.520 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:27.522 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:41:27.523 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:27.533 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:41:27.534 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:41:27.535 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 12(String), 2024-05-30T13:41:27.533(LocalDateTime), 2024-05-30T13:41:27.533(LocalDateTime)
2024-05-30 13:41:27.557 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:41:27.558 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:41:27.558 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 72(Long), 2024-05-30T13:41:27.558(LocalDateTime), 1(Long)
2024-05-30 13:41:27.574 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:41:27.574 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:27.574 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:27.582 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:27.583 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:41:27.583 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:27.590 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:27.592 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:41:27.592 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:41:27.601 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:41:27.605 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:41:27.605 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:41:27.613 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:41:27.614 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:41:27.615 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:41:27.625 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:41:27.626 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:41:27.626 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:27.638 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:41:28.112 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:41:28.112 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:28.126 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:41:28.136 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:28.136 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:28.146 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:28.147 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:41:28.148 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:28.158 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:28.159 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:41:28.160 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:28.170 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:41:28.170 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:41:28.171 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 31(String), 2024-05-30T13:41:28.170(LocalDateTime), 2024-05-30T13:41:28.170(LocalDateTime)
2024-05-30 13:41:28.192 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:41:28.193 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:41:28.193 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 73(Long), 2024-05-30T13:41:28.192(LocalDateTime), 1(Long)
2024-05-30 13:41:28.220 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:41:28.220 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:28.220 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:28.231 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:28.232 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:41:28.233 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:28.243 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:28.244 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:41:28.244 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:41:28.254 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:41:28.255 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:41:28.255 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:41:28.266 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:41:28.266 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:41:28.267 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:41:28.279 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:41:28.279 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:41:28.280 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:28.291 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:41:31.112 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:41:31.112 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:31.121 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:41:31.132 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:31.132 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:31.142 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:31.144 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:41:31.144 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:31.154 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:31.156 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:41:31.156 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:31.165 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:41:31.166 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:41:31.166 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:41:31.165(LocalDateTime), 2024-05-30T13:41:31.165(LocalDateTime)
2024-05-30 13:41:31.182 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:41:31.183 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:41:31.183 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 74(Long), 2024-05-30T13:41:31.183(LocalDateTime), 1(Long)
2024-05-30 13:41:31.199 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:41:31.199 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:41:31.199 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:41:31.208 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:41:31.210 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:41:31.210 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:41:31.220 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:41:31.221 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:41:31.222 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:41:31.230 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:41:31.232 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:41:31.232 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:41:31.240 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:41:31.241 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:41:31.241 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:41:31.253 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:41:31.253 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:41:31.254 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:41:31.266 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:44:33.686 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:44:33.687 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:44:33.698 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:44:33.998 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:44:33.998 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:44:34.012 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:44:34.039 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:44:34.040 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:44:34.053 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:44:35.003 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:44:35.003 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:44:35.003 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:44:35.003 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:44:35.012 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:44:35.012 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:44:35.014 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:44:35.015 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:44:35.025 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:44:35.032 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:44:35.032 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:44:35.047 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:44:37.476 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:44:37.476 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:44:37.486 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:44:37.498 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:44:37.498 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:44:37.515 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:44:37.516 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:44:37.516 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:44:37.527 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:44:37.528 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:44:37.528 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:44:37.542 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:44:37.543 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:44:37.543 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:44:37.542(LocalDateTime), 2024-05-30T13:44:37.542(LocalDateTime)
2024-05-30 13:44:37.564 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:44:37.565 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:44:37.565 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 75(Long), 2024-05-30T13:44:37.564(LocalDateTime), 1(Long)
2024-05-30 13:44:37.583 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:44:37.583 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:44:37.583 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:44:37.597 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:44:37.598 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:44:37.598 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:44:37.606 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:44:37.607 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:44:37.607 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:44:37.617 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:44:37.619 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:44:37.619 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:44:37.629 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:44:37.630 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:44:37.630 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:44:37.642 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:44:37.642 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:44:37.643 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:44:37.653 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:44:41.007 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:44:41.008 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:44:41.018 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:44:41.027 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:44:41.027 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:44:41.036 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:44:41.037 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:44:41.037 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:44:41.046 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:44:41.048 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:44:41.048 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:44:41.055 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:44:41.056 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:44:41.056 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T13:44:41.055(LocalDateTime), 2024-05-30T13:44:41.055(LocalDateTime)
2024-05-30 13:44:41.073 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:44:41.074 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:44:41.074 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 76(Long), 2024-05-30T13:44:41.074(LocalDateTime), 1(Long)
2024-05-30 13:44:41.092 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:44:41.092 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:44:41.093 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:44:41.101 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:44:41.102 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:44:41.103 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:44:41.112 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:44:41.114 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:44:41.114 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:44:41.122 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:44:41.123 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:44:41.124 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:44:41.133 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:44:41.134 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:44:41.135 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:44:41.146 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:44:41.147 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:44:41.147 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:44:41.158 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:45:25.493 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:45:25.493 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:45:25.504 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:45:25.834 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:45:25.834 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:45:25.845 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:45:25.865 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:45:25.866 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:45:25.878 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:45:26.392 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:45:26.392 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:45:26.392 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:45:26.392 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:45:26.404 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:45:26.404 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:45:26.405 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:45:26.405 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:45:26.416 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:45:26.423 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:45:26.423 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:45:26.439 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:46:11.244 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:46:11.245 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:11.259 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:46:11.557 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:46:11.557 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:11.566 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:46:11.583 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:46:11.584 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:46:11.597 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:46:12.490 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:46:12.491 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:12.491 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:46:12.491 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:12.516 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:46:12.518 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:46:12.520 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:46:12.520 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:46:12.533 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:46:12.533 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:46:12.540 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:46:12.557 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:46:16.460 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:46:16.460 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:16.603 ERROR 10704 --- [http-nio-8820-exec-16] c.alibaba.druid.filter.stat.StatFilter   : slow sql 140 millis. SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=?  AND deleted=0[1]
2024-05-30 13:46:16.604 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:46:16.629 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:46:16.629 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:16.637 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:46:16.639 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:46:16.640 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:46:16.669 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:46:16.670 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:46:16.671 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:46:16.820 ERROR 10704 --- [http-nio-8820-exec-16] c.alibaba.druid.filter.stat.StatFilter   : slow sql 147 millis. SELECT COUNT( * ) AS total FROM room_group__user 
 WHERE  deleted=0

AND (room_group_id = ? AND user_id = ?)[1,1]
2024-05-30 13:46:16.820 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:46:16.820 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:46:16.821 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:46:16.820(LocalDateTime), 2024-05-30T13:46:16.820(LocalDateTime)
2024-05-30 13:46:17.237 ERROR 10704 --- [http-nio-8820-exec-16] c.alibaba.druid.filter.stat.StatFilter   : slow sql 415 millis. INSERT INTO message  ( user_id,
room_id,
type,
text,




created_at,
updated_at )  VALUES  ( ?,
?,
?,
?,




?,
? )[1,1,0,"1","<java.time.LocalDateTime>","<java.time.LocalDateTime>"]
2024-05-30 13:46:17.238 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:46:17.238 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:46:17.238 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 77(Long), 2024-05-30T13:46:17.238(LocalDateTime), 1(Long)
2024-05-30 13:46:17.598 ERROR 10704 --- [http-nio-8820-exec-16] c.alibaba.druid.filter.stat.StatFilter   : slow sql 359 millis. UPDATE room  SET last_message_id=?,

updated_at=?  WHERE id=?  AND deleted=0[77,"<java.time.LocalDateTime>",1]
2024-05-30 13:46:17.598 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:46:17.599 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:46:17.599 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:17.625 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:46:17.626 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:17.635 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:46:17.645 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:46:17.645 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:17.655 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:46:17.657 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:46:17.657 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:46:17.670 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:46:17.672 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:46:17.672 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:46:17.681 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:46:17.683 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:46:17.683 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:46:17.682(LocalDateTime), 2024-05-30T13:46:17.682(LocalDateTime)
2024-05-30 13:46:17.714 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:46:17.715 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:46:17.715 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 78(Long), 2024-05-30T13:46:17.715(LocalDateTime), 1(Long)
2024-05-30 13:46:17.728 ERROR 10704 --- [http-nio-8820-exec-16] c.alibaba.druid.filter.stat.StatFilter   : slow sql 128 millis. SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=?  AND deleted=0[1]
2024-05-30 13:46:17.729 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:46:17.731 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:46:17.731 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:46:17.914 ERROR 10704 --- [http-nio-8820-exec-16] c.alibaba.druid.filter.stat.StatFilter   : slow sql 183 millis. SELECT  id,room_id,name,avatar,created_at,updated_at,deleted  FROM room_group 
 WHERE  deleted=0

AND (room_id = ?)[1]
2024-05-30 13:46:17.914 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:46:17.916 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:46:17.916 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:46:18.078 ERROR 10704 --- [http-nio-8820-exec-16] c.alibaba.druid.filter.stat.StatFilter   : slow sql 161 millis. SELECT  id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted  FROM room_group__user 
 WHERE  deleted=0

AND (room_group_id = ?)[1]
2024-05-30 13:46:18.079 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:46:18.080 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:46:18.080 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:46:18.205 ERROR 10704 --- [http-nio-8820-exec-16] c.alibaba.druid.filter.stat.StatFilter   : slow sql 125 millis. SELECT  id,user_id,room_id,created_at,updated_at,deleted  FROM conversation 
 WHERE  deleted=0

AND (user_id = ? AND room_id = ?) limit 1[2,1]
2024-05-30 13:46:18.205 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:46:18.206 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:46:18.207 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:46:18.278 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:46:18.279 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:46:18.280 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:46:18.371 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:46:18.399 ERROR 10704 --- [http-nio-8820-exec-17] c.alibaba.druid.filter.stat.StatFilter   : slow sql 682 millis. UPDATE room  SET last_message_id=?,

updated_at=?  WHERE id=?  AND deleted=0[78,"<java.time.LocalDateTime>",1]
2024-05-30 13:46:18.399 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:46:18.399 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:46:18.400 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:18.410 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:46:18.411 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:46:18.411 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:46:18.421 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:46:18.423 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:46:18.423 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:46:18.448 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:46:18.449 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:46:18.450 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:46:18.465 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:46:18.466 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:46:18.466 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:46:18.489 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:46:18.490 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:46:18.490 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:46:18.510 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:46:26.706 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:46:26.706 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:26.716 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:46:26.717 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:46:26.717 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 67(Long), 10(Long)
2024-05-30 13:46:26.729 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:46:29.613 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:46:29.613 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:29.621 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:46:29.633 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:46:29.634 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:29.648 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:46:29.649 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:46:29.649 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:46:29.662 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:46:29.663 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:46:29.663 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:46:29.672 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:46:29.673 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:46:29.673 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 313(String), 2024-05-30T13:46:29.672(LocalDateTime), 2024-05-30T13:46:29.672(LocalDateTime)
2024-05-30 13:46:29.703 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:46:29.703 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:46:29.703 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 79(Long), 2024-05-30T13:46:29.703(LocalDateTime), 1(Long)
2024-05-30 13:46:29.724 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:46:29.724 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:46:29.724 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:29.734 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:46:29.736 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:46:29.736 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:46:29.745 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:46:29.746 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:46:29.746 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:46:29.756 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:46:29.757 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:46:29.757 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:46:29.766 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:46:29.767 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:46:29.767 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:46:29.778 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:46:29.779 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:46:29.780 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:46:29.790 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:46:34.542 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:46:34.542 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:34.556 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:46:34.839 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:46:34.840 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:34.850 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:46:34.871 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:46:34.872 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:46:34.884 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:46:35.668 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:46:35.669 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:35.671 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:46:35.671 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:35.900 ERROR 10704 --- [http-nio-8820-exec-23] c.alibaba.druid.filter.stat.StatFilter   : slow sql 231 millis. SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=?  AND deleted=0[1]
2024-05-30 13:46:35.901 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:46:35.930 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:46:35.930 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:46:35.943 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:46:36.028 ERROR 10704 --- [http-nio-8820-exec-22] c.alibaba.druid.filter.stat.StatFilter   : slow sql 356 millis. SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=?  AND deleted=0[1]
2024-05-30 13:46:36.029 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:46:36.031 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:46:36.031 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:46:36.040 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:46:43.384 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:46:43.384 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:43.394 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:46:43.395 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:46:43.395 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 70(Long), 10(Long)
2024-05-30 13:46:43.405 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:46:58.099 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:46:58.099 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:58.108 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:46:58.119 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:46:58.119 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:58.128 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:46:58.129 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:46:58.130 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:46:58.139 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:46:58.140 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:46:58.140 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:46:58.148 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:46:58.148 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:46:58.148 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 22222222(String), 2024-05-30T13:46:58.148(LocalDateTime), 2024-05-30T13:46:58.148(LocalDateTime)
2024-05-30 13:46:58.166 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:46:58.167 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:46:58.167 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 80(Long), 2024-05-30T13:46:58.166(LocalDateTime), 1(Long)
2024-05-30 13:46:58.183 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:46:58.184 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:46:58.184 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:46:58.192 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:46:58.193 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:46:58.194 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:46:58.202 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:46:58.203 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:46:58.203 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:46:58.215 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:46:58.217 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:46:58.217 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:46:58.226 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:46:58.227 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:46:58.227 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:46:58.235 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:46:58.236 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:46:58.237 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:46:58.247 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:47:06.513 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:47:06.513 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:06.524 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:47:06.536 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:47:06.536 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:06.550 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:47:06.551 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:47:06.551 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:47:06.561 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:47:06.563 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:47:06.563 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:47:06.573 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:47:06.574 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:47:06.574 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:47:06.573(LocalDateTime), 2024-05-30T13:47:06.573(LocalDateTime)
2024-05-30 13:47:06.594 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:47:06.595 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:47:06.596 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 81(Long), 2024-05-30T13:47:06.595(LocalDateTime), 1(Long)
2024-05-30 13:47:06.613 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:47:06.614 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:47:06.614 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:06.624 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:47:06.625 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:47:06.625 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:47:06.636 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:47:06.637 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:47:06.637 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:47:06.645 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:47:06.646 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:47:06.647 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:47:06.655 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:47:06.656 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:47:06.656 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:47:06.667 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:47:06.668 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:47:06.668 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:47:06.680 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:47:08.497 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:47:08.497 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:08.508 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:47:08.518 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:47:08.518 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:08.524 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:47:08.611 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:47:08.611 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:47:08.619 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:47:08.620 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:47:08.620 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:47:08.627 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:47:08.628 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:47:08.628 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T13:47:08.628(LocalDateTime), 2024-05-30T13:47:08.628(LocalDateTime)
2024-05-30 13:47:08.645 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:47:08.646 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:47:08.646 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 82(Long), 2024-05-30T13:47:08.645(LocalDateTime), 1(Long)
2024-05-30 13:47:08.664 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:47:08.665 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:47:08.665 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:08.678 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:47:08.679 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:47:08.679 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:47:08.689 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:47:08.690 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:47:08.690 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:47:08.698 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:47:08.699 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:47:08.699 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:47:08.708 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:47:08.708 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:47:08.708 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:47:08.717 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:47:08.718 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:47:08.718 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:47:08.731 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:47:11.245 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:47:11.246 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:11.255 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:47:11.266 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:47:11.266 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:11.277 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:47:11.278 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:47:11.278 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:47:11.291 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:47:11.292 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:47:11.292 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:47:11.303 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:47:11.304 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:47:11.304 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T13:47:11.304(LocalDateTime), 2024-05-30T13:47:11.304(LocalDateTime)
2024-05-30 13:47:11.322 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:47:11.323 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:47:11.323 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 83(Long), 2024-05-30T13:47:11.323(LocalDateTime), 1(Long)
2024-05-30 13:47:11.341 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:47:11.341 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:47:11.341 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:11.349 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:47:11.350 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:47:11.350 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:47:11.359 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:47:11.360 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:47:11.360 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:47:11.371 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:47:11.372 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:47:11.372 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:47:11.380 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:47:11.380 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:47:11.380 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:47:11.391 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:47:11.392 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:47:11.392 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:47:11.403 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:47:13.187 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:47:13.187 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:13.195 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:47:13.205 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:47:13.205 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:13.214 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:47:13.215 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:47:13.215 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:47:13.225 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:47:13.225 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:47:13.225 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:47:13.234 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:47:13.235 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:47:13.235 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 31(String), 2024-05-30T13:47:13.235(LocalDateTime), 2024-05-30T13:47:13.235(LocalDateTime)
2024-05-30 13:47:13.254 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:47:13.255 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:47:13.255 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 84(Long), 2024-05-30T13:47:13.255(LocalDateTime), 1(Long)
2024-05-30 13:47:13.270 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:47:13.271 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:47:13.271 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:13.281 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:47:13.281 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:47:13.282 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:47:13.295 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:47:13.295 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:47:13.296 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:47:13.303 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:47:13.304 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:47:13.304 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:47:13.312 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:47:13.313 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:47:13.313 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:47:13.325 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:47:13.326 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:47:13.448 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:47:13.459 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:47:30.774 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:47:30.774 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:30.784 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:47:30.785 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:47:30.786 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 60(Long), 10(Long)
2024-05-30 13:47:30.795 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:47:32.404 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:47:32.405 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:32.414 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:47:32.927 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:47:32.928 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:32.937 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:47:32.958 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:47:32.959 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:47:32.971 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:47:34.689 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:47:34.689 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:47:34.689 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:34.689 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:34.698 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:47:34.698 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:47:34.700 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:47:34.700 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:47:34.710 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:47:34.715 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:47:34.715 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:47:34.727 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:47:42.251 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:47:42.251 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:42.261 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:47:42.270 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:47:42.271 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:42.280 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:47:42.281 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:47:42.282 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:47:42.291 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:47:42.292 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:47:42.292 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:47:42.302 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:47:42.303 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:47:42.303 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:47:42.302(LocalDateTime), 2024-05-30T13:47:42.302(LocalDateTime)
2024-05-30 13:47:42.321 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:47:42.322 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:47:42.322 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 85(Long), 2024-05-30T13:47:42.322(LocalDateTime), 1(Long)
2024-05-30 13:47:42.341 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:47:42.342 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:47:42.342 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:42.351 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:47:42.353 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:47:42.354 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:47:42.361 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:47:42.363 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:47:42.363 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:47:42.372 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:47:42.374 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:47:42.374 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:47:42.383 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:47:42.383 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:47:42.384 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:47:42.396 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:47:42.397 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:47:42.397 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:47:42.409 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:47:48.578 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:47:48.578 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:48.589 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:47:48.590 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:47:48.590 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 75(Long), 10(Long)
2024-05-30 13:47:48.602 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:47:52.516 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:47:52.516 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:52.532 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:47:52.545 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:47:52.545 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:52.554 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:47:52.555 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:47:52.556 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:47:52.564 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:47:52.565 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:47:52.566 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:47:52.575 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:47:52.576 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:47:52.576 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T13:47:52.575(LocalDateTime), 2024-05-30T13:47:52.575(LocalDateTime)
2024-05-30 13:47:52.593 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:47:52.594 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:47:52.594 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 86(Long), 2024-05-30T13:47:52.593(LocalDateTime), 1(Long)
2024-05-30 13:47:52.610 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:47:52.611 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:47:52.611 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:52.619 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:47:52.621 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:47:52.621 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:47:52.630 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:47:52.632 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:47:52.632 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:47:52.641 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:47:52.642 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:47:52.642 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:47:52.652 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:47:52.653 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:47:52.653 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:47:52.664 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:47:52.665 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:47:52.665 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:47:52.677 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:47:59.239 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:47:59.239 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:59.248 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:47:59.258 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:47:59.258 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:59.266 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:47:59.267 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:47:59.267 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:47:59.275 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:47:59.276 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:47:59.276 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:47:59.287 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:47:59.288 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:47:59.288 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T13:47:59.287(LocalDateTime), 2024-05-30T13:47:59.287(LocalDateTime)
2024-05-30 13:47:59.304 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:47:59.304 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:47:59.305 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 87(Long), 2024-05-30T13:47:59.304(LocalDateTime), 1(Long)
2024-05-30 13:47:59.320 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:47:59.321 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:47:59.321 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:47:59.330 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:47:59.331 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:47:59.331 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:47:59.338 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:47:59.339 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:47:59.340 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:47:59.348 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:47:59.350 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:47:59.350 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:47:59.357 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:47:59.357 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:47:59.357 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:47:59.369 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:47:59.369 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:47:59.370 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:47:59.379 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:48:02.692 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:48:02.692 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:48:02.699 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:48:02.708 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:48:02.708 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:48:02.716 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:48:02.718 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:48:02.718 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:48:02.727 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:48:02.729 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:48:02.729 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:48:02.739 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:48:02.740 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:48:02.740 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T13:48:02.740(LocalDateTime), 2024-05-30T13:48:02.740(LocalDateTime)
2024-05-30 13:48:02.761 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:48:02.761 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:48:02.762 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 88(Long), 2024-05-30T13:48:02.761(LocalDateTime), 1(Long)
2024-05-30 13:48:02.780 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:48:02.780 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:48:02.780 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:48:02.788 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:48:02.789 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:48:02.789 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:48:02.797 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:48:02.798 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:48:02.798 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:48:02.807 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:48:02.809 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:48:02.809 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:48:02.817 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:48:02.818 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:48:02.818 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:48:02.830 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:48:02.831 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:48:02.831 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:48:02.840 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:48:08.268 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:48:08.268 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:48:08.275 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:48:08.284 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:48:08.284 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:48:08.294 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:48:08.295 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:48:08.295 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:48:08.303 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:48:08.304 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:48:08.304 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:48:08.314 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:48:08.314 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:48:08.314 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T13:48:08.314(LocalDateTime), 2024-05-30T13:48:08.314(LocalDateTime)
2024-05-30 13:48:08.329 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:48:08.330 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:48:08.330 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 89(Long), 2024-05-30T13:48:08.330(LocalDateTime), 1(Long)
2024-05-30 13:48:08.346 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:48:08.346 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:48:08.347 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:48:08.356 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:48:08.357 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:48:08.357 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:48:08.366 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:48:08.367 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:48:08.367 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:48:08.376 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:48:08.377 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:48:08.378 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:48:08.387 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:48:08.388 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:48:08.388 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:48:08.396 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:48:08.397 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:48:08.398 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:48:08.410 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:48:44.725 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:48:44.725 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:48:44.734 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:48:45.022 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:48:45.022 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:48:45.032 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:48:45.050 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:48:45.052 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:48:45.065 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:48:46.066 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:48:46.066 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:48:46.072 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:48:46.073 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:48:46.075 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:48:46.076 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:48:46.076 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:48:46.081 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:48:46.087 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:48:46.099 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:48:46.099 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:48:46.113 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:49:34.715 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:49:34.715 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:34.725 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:49:34.734 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:34.734 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:34.743 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:34.744 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:49:34.744 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:34.753 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:34.754 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:49:34.754 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:34.764 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:49:34.764 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:49:34.765 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T13:49:34.764(LocalDateTime), 2024-05-30T13:49:34.764(LocalDateTime)
2024-05-30 13:49:34.781 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:49:34.784 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:49:34.784 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 90(Long), 2024-05-30T13:49:34.783(LocalDateTime), 1(Long)
2024-05-30 13:49:34.801 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:49:34.801 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:34.802 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:34.809 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:34.811 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:49:34.811 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:34.819 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:34.820 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:49:34.820 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:49:34.830 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:49:34.832 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:49:34.832 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:49:34.842 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:49:34.843 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:49:34.843 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:49:34.853 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:49:34.854 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:49:34.854 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:34.865 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:49:38.996 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:49:38.996 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:39.003 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:49:39.013 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:39.013 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:39.022 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:39.023 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:49:39.023 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:39.034 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:39.035 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:49:39.035 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:39.046 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:49:39.047 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:49:39.047 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T13:49:39.047(LocalDateTime), 2024-05-30T13:49:39.047(LocalDateTime)
2024-05-30 13:49:39.066 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:49:39.067 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:49:39.068 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 91(Long), 2024-05-30T13:49:39.067(LocalDateTime), 1(Long)
2024-05-30 13:49:39.087 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:49:39.087 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:39.087 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:39.098 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:39.099 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:49:39.099 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:39.107 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:39.108 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:49:39.108 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:49:39.118 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:49:39.119 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:49:39.119 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:49:39.128 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:49:39.129 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:49:39.129 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:49:39.140 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:49:39.141 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:49:39.142 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:39.154 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:49:40.142 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:49:40.142 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:40.152 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:49:40.163 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:40.163 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:40.175 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:40.176 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:49:40.176 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:40.186 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:40.188 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:49:40.188 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:40.197 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:49:40.197 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:49:40.198 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 31(String), 2024-05-30T13:49:40.197(LocalDateTime), 2024-05-30T13:49:40.197(LocalDateTime)
2024-05-30 13:49:40.216 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:49:40.217 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:49:40.217 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 92(Long), 2024-05-30T13:49:40.216(LocalDateTime), 1(Long)
2024-05-30 13:49:40.233 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:49:40.234 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:40.234 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:40.243 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:40.245 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:49:40.245 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:40.252 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:40.253 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:49:40.253 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:49:40.263 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:49:40.265 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:49:40.265 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:49:40.275 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:49:40.276 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:49:40.276 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:49:40.286 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:49:40.287 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:49:40.288 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:40.299 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:49:41.487 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:49:41.487 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:41.499 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:49:41.508 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:41.508 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:41.517 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:41.518 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:49:41.518 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:41.529 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:41.531 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:49:41.531 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:41.540 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:49:41.540 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:49:41.540 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 13(String), 2024-05-30T13:49:41.540(LocalDateTime), 2024-05-30T13:49:41.540(LocalDateTime)
2024-05-30 13:49:41.561 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:49:41.561 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:49:41.562 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 93(Long), 2024-05-30T13:49:41.561(LocalDateTime), 1(Long)
2024-05-30 13:49:41.580 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:49:41.581 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:41.581 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:41.590 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:41.591 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:49:41.591 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:41.601 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:41.602 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:49:41.602 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:49:41.612 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:49:41.613 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:49:41.613 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:49:41.622 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:49:41.623 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:49:41.623 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:49:41.633 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:49:41.634 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:49:41.634 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:41.645 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:49:42.359 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:49:42.359 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:42.371 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:49:42.382 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:42.382 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:42.392 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:42.393 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:49:42.393 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:42.402 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:42.403 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:49:42.403 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:42.414 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:49:42.414 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:49:42.415 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 13(String), 2024-05-30T13:49:42.414(LocalDateTime), 2024-05-30T13:49:42.414(LocalDateTime)
2024-05-30 13:49:42.432 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:49:42.433 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:49:42.433 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 94(Long), 2024-05-30T13:49:42.433(LocalDateTime), 1(Long)
2024-05-30 13:49:42.450 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:49:42.450 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:42.450 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:42.461 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:42.462 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:49:42.462 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:42.471 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:42.472 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:49:42.473 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:49:42.482 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:49:42.484 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:49:42.484 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:49:42.495 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:49:42.495 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:49:42.496 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:49:42.507 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:49:42.508 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:49:42.508 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:42.520 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:49:43.700 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:49:43.700 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:43.707 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:49:43.716 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:43.716 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:43.723 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:43.725 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:49:43.725 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:43.734 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:43.735 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:49:43.735 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:43.745 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:49:43.745 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:49:43.745 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), .0(String), 2024-05-30T13:49:43.745(LocalDateTime), 2024-05-30T13:49:43.745(LocalDateTime)
2024-05-30 13:49:43.760 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:49:43.761 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:49:43.761 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 95(Long), 2024-05-30T13:49:43.761(LocalDateTime), 1(Long)
2024-05-30 13:49:43.777 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:49:43.778 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:43.778 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:43.786 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:43.788 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:49:43.788 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:43.798 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:43.800 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:49:43.800 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:49:43.810 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:49:43.811 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:49:43.811 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:49:43.823 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:49:43.824 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:49:43.824 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:49:43.837 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:49:43.838 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:49:43.838 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:43.850 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:49:45.061 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:49:45.061 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:45.072 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:49:45.096 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:45.096 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:45.105 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:45.107 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:49:45.107 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:45.116 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:45.118 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:49:45.118 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:45.126 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:49:45.127 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:49:45.127 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 23(String), 2024-05-30T13:49:45.126(LocalDateTime), 2024-05-30T13:49:45.126(LocalDateTime)
2024-05-30 13:49:45.146 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:49:45.147 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:49:45.147 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 96(Long), 2024-05-30T13:49:45.146(LocalDateTime), 1(Long)
2024-05-30 13:49:45.165 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:49:45.165 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:45.166 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:45.176 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:45.178 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:49:45.178 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:45.186 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:45.188 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:49:45.188 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:49:45.197 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:49:45.199 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:49:45.199 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:49:45.207 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:49:45.208 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:49:45.208 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:49:45.220 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:49:45.220 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:49:45.221 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:45.230 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:49:46.485 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:49:46.485 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:46.497 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:49:46.506 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:46.506 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:46.513 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:46.515 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:49:46.515 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:46.524 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:46.525 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:49:46.525 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:46.534 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:49:46.535 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:49:46.536 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 231(String), 2024-05-30T13:49:46.535(LocalDateTime), 2024-05-30T13:49:46.535(LocalDateTime)
2024-05-30 13:49:46.558 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:49:46.560 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:49:46.560 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 97(Long), 2024-05-30T13:49:46.559(LocalDateTime), 1(Long)
2024-05-30 13:49:46.576 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:49:46.576 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:46.576 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:46.586 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:46.587 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:49:46.587 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:46.597 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:46.598 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:49:46.598 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:49:46.607 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:49:46.608 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:49:46.608 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:49:46.617 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:49:46.617 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:49:46.617 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:49:46.627 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:49:46.628 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:49:46.628 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:46.639 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:49:48.229 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:49:48.230 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:48.239 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:49:48.253 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:48.254 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:48.263 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:48.264 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:49:48.264 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:48.273 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:48.274 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:49:48.274 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:48.281 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:49:48.281 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:49:48.281 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3215(String), 2024-05-30T13:49:48.281(LocalDateTime), 2024-05-30T13:49:48.281(LocalDateTime)
2024-05-30 13:49:48.299 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:49:48.300 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:49:48.301 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 98(Long), 2024-05-30T13:49:48.299(LocalDateTime), 1(Long)
2024-05-30 13:49:48.314 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:49:48.315 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:48.315 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:48.322 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:48.324 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:49:48.324 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:48.333 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:48.334 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:49:48.334 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:49:48.343 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:49:48.344 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:49:48.345 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:49:48.354 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:49:48.355 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:49:48.355 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:49:48.367 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:49:48.368 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:49:48.368 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:48.379 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:49:49.358 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:49:49.358 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:49.371 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:49:49.381 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:49.381 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:49.388 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:49.390 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:49:49.390 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:49.399 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:49.401 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:49:49.401 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:49.409 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:49:49.410 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:49:49.410 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 54(String), 2024-05-30T13:49:49.409(LocalDateTime), 2024-05-30T13:49:49.409(LocalDateTime)
2024-05-30 13:49:49.427 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:49:49.428 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:49:49.429 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 99(Long), 2024-05-30T13:49:49.428(LocalDateTime), 1(Long)
2024-05-30 13:49:49.450 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:49:49.451 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:49.451 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:49.459 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:49.460 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:49:49.460 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:49.468 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:49.469 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:49:49.469 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:49:49.478 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:49:49.479 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:49:49.479 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:49:49.487 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:49:49.488 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:49:49.488 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:49:49.499 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:49:49.500 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:49:49.500 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:49.508 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:49:50.424 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:49:50.424 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:50.434 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:49:50.444 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:50.444 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:50.452 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:50.454 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:49:50.454 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:50.461 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:50.463 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:49:50.463 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:50.471 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:49:50.472 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:49:50.472 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 15(String), 2024-05-30T13:49:50.471(LocalDateTime), 2024-05-30T13:49:50.471(LocalDateTime)
2024-05-30 13:49:50.487 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:49:50.488 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:49:50.488 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 100(Long), 2024-05-30T13:49:50.487(LocalDateTime), 1(Long)
2024-05-30 13:49:50.504 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:49:50.504 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:50.504 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:50.512 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:50.514 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:49:50.514 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:50.529 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:50.530 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:49:50.530 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:49:50.537 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:49:50.538 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:49:50.538 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:49:50.546 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:49:50.547 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:49:50.547 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:49:50.560 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:49:50.561 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:49:50.562 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:50.571 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:49:51.412 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:49:51.412 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:51.421 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:49:51.432 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:51.432 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:51.441 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:51.442 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:49:51.442 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:51.452 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:51.453 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:49:51.454 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:51.461 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:49:51.463 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:49:51.463 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 54(String), 2024-05-30T13:49:51.462(LocalDateTime), 2024-05-30T13:49:51.462(LocalDateTime)
2024-05-30 13:49:51.486 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:49:51.487 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:49:51.487 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 101(Long), 2024-05-30T13:49:51.486(LocalDateTime), 1(Long)
2024-05-30 13:49:51.502 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:49:51.503 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:51.503 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:51.513 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:51.514 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:49:51.514 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:51.522 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:51.523 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:49:51.523 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:49:51.532 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:49:51.534 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:49:51.534 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:49:51.543 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:49:51.544 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:49:51.544 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:49:51.558 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:49:51.559 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:49:51.560 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:51.570 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:49:52.430 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:49:52.431 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:52.440 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:49:52.453 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:52.453 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:52.461 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:52.462 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:49:52.463 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:52.469 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:52.471 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:49:52.471 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:52.478 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:49:52.479 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:49:52.479 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 456(String), 2024-05-30T13:49:52.478(LocalDateTime), 2024-05-30T13:49:52.478(LocalDateTime)
2024-05-30 13:49:52.497 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:49:52.497 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:49:52.498 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 102(Long), 2024-05-30T13:49:52.497(LocalDateTime), 1(Long)
2024-05-30 13:49:52.513 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:49:52.513 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:52.513 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:52.522 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:52.523 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:49:52.523 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:52.531 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:52.532 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:49:52.532 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:49:52.542 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:49:52.543 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:49:52.544 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:49:52.559 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:49:52.559 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:49:52.560 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:49:52.571 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:49:52.572 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:49:52.572 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:52.583 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:49:52.699 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:49:52.699 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:52.709 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:49:52.857 ERROR 10704 --- [http-nio-8820-exec-28] com.slipper.handler.RunExceptionHandler  : Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 

org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.resolveArgument(RequestResponseBodyMethodProcessor.java:141)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:122)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:179)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:146)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 13:49:55.497 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:49:55.497 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:55.505 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:49:55.516 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:55.516 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:55.528 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:55.530 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:49:55.530 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:55.546 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:55.547 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:49:55.547 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:55.559 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:49:55.560 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:49:55.560 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 111(String), 2024-05-30T13:49:55.559(LocalDateTime), 2024-05-30T13:49:55.559(LocalDateTime)
2024-05-30 13:49:55.574 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:49:55.575 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:49:55.575 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 103(Long), 2024-05-30T13:49:55.574(LocalDateTime), 1(Long)
2024-05-30 13:49:55.591 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:49:56.118 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:56.119 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:56.127 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:56.130 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:49:56.131 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:56.140 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:56.142 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:49:56.143 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:49:56.152 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:49:56.156 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:49:56.156 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:49:56.168 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:49:56.170 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:49:56.171 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:49:56.185 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:49:56.188 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:49:56.189 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:56.208 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:49:59.109 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:49:59.110 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:59.120 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:49:59.131 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:59.131 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:59.140 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:59.141 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:49:59.142 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:59.151 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:59.153 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:49:59.153 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:59.162 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:49:59.162 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:49:59.163 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 4466(String), 2024-05-30T13:49:59.162(LocalDateTime), 2024-05-30T13:49:59.162(LocalDateTime)
2024-05-30 13:49:59.184 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:49:59.185 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:49:59.185 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 104(Long), 2024-05-30T13:49:59.184(LocalDateTime), 1(Long)
2024-05-30 13:49:59.204 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:49:59.204 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:49:59.204 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:49:59.213 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:49:59.214 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:49:59.215 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:49:59.222 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:49:59.223 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:49:59.224 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:49:59.232 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:49:59.234 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:49:59.234 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:49:59.244 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:49:59.245 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:49:59.246 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:49:59.257 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:49:59.257 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:49:59.258 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:49:59.268 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:50:28.452 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:50:28.453 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:50:28.460 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:50:28.807 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:50:28.807 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:50:28.815 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:50:28.834 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:50:28.835 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:50:28.847 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:50:32.440 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:50:32.440 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:50:32.449 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:50:32.450 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:50:32.451 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:50:32.460 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:50:32.462 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:50:32.462 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:50:32.465 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:50:32.465 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:50:32.473 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:50:32.479 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:50:36.720 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:50:36.721 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:50:36.730 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:50:36.741 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:50:36.741 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:50:36.750 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:50:36.751 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:50:36.752 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:50:36.762 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:50:36.764 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:50:36.764 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:50:36.772 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:50:36.773 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:50:36.773 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 你好(String), 2024-05-30T13:50:36.772(LocalDateTime), 2024-05-30T13:50:36.772(LocalDateTime)
2024-05-30 13:50:36.792 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:50:36.793 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:50:36.793 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 105(Long), 2024-05-30T13:50:36.792(LocalDateTime), 1(Long)
2024-05-30 13:50:36.811 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:50:36.812 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:50:36.812 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:50:36.822 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:50:36.824 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:50:36.824 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:50:36.834 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:50:36.836 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:50:36.836 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:50:36.844 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:50:36.846 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:50:36.846 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:50:36.856 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:50:36.857 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:50:36.857 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:50:36.869 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:50:36.870 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:50:36.870 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:50:36.883 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:51:22.693 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:51:22.694 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:51:22.703 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:51:22.704 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:51:22.704 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 95(Long), 10(Long)
2024-05-30 13:51:22.715 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:51:58.710 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:51:58.710 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:51:58.722 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:51:58.723 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:51:58.723 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 85(Long), 10(Long)
2024-05-30 13:51:58.740 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:52:00.686 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:52:00.686 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:52:00.696 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:52:00.698 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:52:00.698 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 75(Long), 10(Long)
2024-05-30 13:52:00.710 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:52:05.315 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:52:05.315 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:52:05.323 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:52:05.324 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:52:05.324 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 65(Long), 10(Long)
2024-05-30 13:52:05.337 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:53:25.400 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:25.400 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:25.411 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:25.799 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:25.799 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:25.810 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:25.828 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:53:25.829 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:53:25.840 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:53:39.975 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:39.975 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:39.975 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:39.975 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:39.985 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:39.991 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:39.992 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:53:39.992 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:53:40.002 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:53:40.002 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:53:40.007 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:53:40.015 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:53:40.822 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:40.822 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:40.830 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:40.841 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:53:40.841 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:40.851 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:53:40.852 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:53:40.852 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:53:40.862 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:53:40.863 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:53:40.863 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:53:40.871 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:53:40.872 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:53:40.872 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:53:40.872(LocalDateTime), 2024-05-30T13:53:40.872(LocalDateTime)
2024-05-30 13:53:40.893 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:53:40.893 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:53:40.894 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 106(Long), 2024-05-30T13:53:40.893(LocalDateTime), 1(Long)
2024-05-30 13:53:40.913 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:53:40.913 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:53:40.914 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:40.922 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:53:40.923 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:53:40.923 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:53:40.931 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:53:40.933 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:53:40.933 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:53:40.942 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:53:40.944 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:53:40.944 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:53:40.953 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:53:40.954 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:53:40.954 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:53:40.965 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:53:40.966 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:53:40.966 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:53:40.978 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:53:41.384 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:41.384 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:41.399 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:41.414 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:53:41.414 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:41.427 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:53:41.428 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:53:41.428 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:53:41.441 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:53:41.442 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:53:41.442 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:53:41.455 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:53:41.455 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:53:41.456 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T13:53:41.455(LocalDateTime), 2024-05-30T13:53:41.455(LocalDateTime)
2024-05-30 13:53:41.477 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:53:41.479 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:53:41.479 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 107(Long), 2024-05-30T13:53:41.478(LocalDateTime), 1(Long)
2024-05-30 13:53:41.499 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:53:41.499 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:53:41.499 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:41.512 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:53:41.513 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:53:41.513 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:53:41.529 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:53:41.530 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:53:41.530 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:53:41.544 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:53:41.545 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:53:41.545 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:53:41.559 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:53:41.560 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:53:41.561 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:53:41.575 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:53:41.576 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:53:41.576 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:53:41.588 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:53:41.935 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:41.935 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:41.945 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:41.954 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:53:41.954 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:41.962 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:53:41.963 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:53:41.964 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:53:41.971 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:53:41.972 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:53:41.972 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:53:41.981 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:53:41.982 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:53:41.982 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T13:53:41.982(LocalDateTime), 2024-05-30T13:53:41.982(LocalDateTime)
2024-05-30 13:53:42.002 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:53:42.003 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:53:42.003 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 108(Long), 2024-05-30T13:53:42.003(LocalDateTime), 1(Long)
2024-05-30 13:53:42.024 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:53:42.025 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:53:42.025 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:42.037 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:53:42.038 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:53:42.039 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:53:42.048 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:53:42.049 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:53:42.050 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:53:42.060 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:53:42.061 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:53:42.061 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:53:42.072 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:53:42.072 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:53:42.073 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:53:42.086 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:53:42.087 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:53:42.087 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:53:42.100 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:53:42.491 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:42.496 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:42.506 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:42.515 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:53:42.516 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:42.525 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:53:42.526 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:53:42.526 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:53:42.536 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:53:42.538 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:53:42.538 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:53:42.548 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:53:42.549 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:53:42.549 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:53:42.548(LocalDateTime), 2024-05-30T13:53:42.548(LocalDateTime)
2024-05-30 13:53:42.572 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:53:42.574 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:53:42.574 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 109(Long), 2024-05-30T13:53:42.573(LocalDateTime), 1(Long)
2024-05-30 13:53:42.595 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:53:42.595 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:53:42.596 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:42.603 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:53:42.605 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:53:42.605 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:53:42.614 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:53:42.615 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:53:42.615 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:53:42.624 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:53:42.625 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:53:42.625 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:53:42.634 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:53:42.635 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:53:42.635 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:53:42.647 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:53:42.647 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:53:42.648 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:53:42.658 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:53:42.975 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:42.976 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:42.984 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:42.986 ERROR 10704 --- [http-nio-8820-exec-19] com.slipper.handler.RunExceptionHandler  : Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 

org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.resolveArgument(RequestResponseBodyMethodProcessor.java:141)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:122)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:179)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:146)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 13:53:43.468 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:43.468 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:43.478 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:43.488 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:53:43.488 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:43.498 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:53:43.499 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:53:43.499 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:53:43.508 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:53:43.509 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:53:43.509 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:53:43.519 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:53:43.519 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:53:43.519 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:53:43.519(LocalDateTime), 2024-05-30T13:53:43.519(LocalDateTime)
2024-05-30 13:53:43.538 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:53:43.539 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:53:43.539 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 110(Long), 2024-05-30T13:53:43.538(LocalDateTime), 1(Long)
2024-05-30 13:53:43.555 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:53:43.556 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:53:43.556 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:43.563 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:53:43.565 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:53:43.565 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:53:43.572 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:53:43.574 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:53:43.574 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:53:43.584 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:53:43.585 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:53:43.585 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:53:43.594 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:53:43.595 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:53:43.595 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:53:43.608 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:53:43.609 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:53:43.609 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:53:43.620 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:53:44.001 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:44.001 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:44.011 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:44.021 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:53:44.021 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:44.030 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:53:44.031 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:53:44.031 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:53:44.040 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:53:44.041 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:53:44.041 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:53:44.050 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:53:44.050 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:53:44.050 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:53:44.050(LocalDateTime), 2024-05-30T13:53:44.050(LocalDateTime)
2024-05-30 13:53:44.069 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:53:44.069 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:53:44.070 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 111(Long), 2024-05-30T13:53:44.069(LocalDateTime), 1(Long)
2024-05-30 13:53:44.087 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:53:44.087 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:53:44.087 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:44.095 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:53:44.096 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:53:44.096 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:53:44.104 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:53:44.105 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:53:44.105 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:53:44.114 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:53:44.116 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:53:44.116 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:53:44.125 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:53:44.126 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:53:44.126 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:53:44.137 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:53:44.138 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:53:44.138 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:53:44.150 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:53:44.579 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:44.579 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:44.589 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:44.597 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:53:44.597 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:44.604 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:53:44.605 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:53:44.605 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:53:44.615 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:53:44.616 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:53:44.616 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:53:44.626 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:53:44.626 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:53:44.627 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:53:44.626(LocalDateTime), 2024-05-30T13:53:44.626(LocalDateTime)
2024-05-30 13:53:44.642 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:53:44.642 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:53:44.642 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 112(Long), 2024-05-30T13:53:44.642(LocalDateTime), 1(Long)
2024-05-30 13:53:44.660 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:53:44.661 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:53:44.661 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:44.669 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:53:44.670 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:53:44.670 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:53:44.679 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:53:44.680 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:53:44.681 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:53:44.690 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:53:44.691 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:53:44.691 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:53:44.699 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:53:44.700 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:53:44.700 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:53:44.712 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:53:44.712 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:53:44.713 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:53:44.725 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:53:44.959 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:44.959 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:44.966 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:44.968 ERROR 10704 --- [http-nio-8820-exec-23] com.slipper.handler.RunExceptionHandler  : Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 

org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.resolveArgument(RequestResponseBodyMethodProcessor.java:141)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:122)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:179)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:146)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 13:53:45.135 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:45.135 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:45.144 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:45.146 ERROR 10704 --- [http-nio-8820-exec-22] com.slipper.handler.RunExceptionHandler  : Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 

org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.resolveArgument(RequestResponseBodyMethodProcessor.java:141)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:122)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:179)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:146)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 13:53:45.260 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:45.260 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:45.269 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:45.270 ERROR 10704 --- [http-nio-8820-exec-24] com.slipper.handler.RunExceptionHandler  : Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 

org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.resolveArgument(RequestResponseBodyMethodProcessor.java:141)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:122)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:179)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:146)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 13:53:45.431 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:45.432 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:45.440 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:45.441 ERROR 10704 --- [http-nio-8820-exec-25] com.slipper.handler.RunExceptionHandler  : Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 

org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.resolveArgument(RequestResponseBodyMethodProcessor.java:141)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:122)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:179)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:146)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 13:53:45.582 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:45.583 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:45.592 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:45.594 ERROR 10704 --- [http-nio-8820-exec-26] com.slipper.handler.RunExceptionHandler  : Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 

org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.resolveArgument(RequestResponseBodyMethodProcessor.java:141)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:122)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:179)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:146)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 13:53:45.708 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:45.709 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:45.719 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:45.721 ERROR 10704 --- [http-nio-8820-exec-27] com.slipper.handler.RunExceptionHandler  : Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 

org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.resolveArgument(RequestResponseBodyMethodProcessor.java:141)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:122)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:179)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:146)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 13:53:45.838 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:45.839 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:45.848 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:45.849 ERROR 10704 --- [http-nio-8820-exec-28] com.slipper.handler.RunExceptionHandler  : Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 

org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.resolveArgument(RequestResponseBodyMethodProcessor.java:141)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:122)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:179)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:146)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 13:53:52.693 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:52.693 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:52.703 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:52.704 ERROR 10704 --- [http-nio-8820-exec-30] com.slipper.handler.RunExceptionHandler  : Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 

org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.resolveArgument(RequestResponseBodyMethodProcessor.java:141)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:122)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:179)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:146)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 13:53:53.150 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:53.150 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:53.159 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:53.160 ERROR 10704 --- [http-nio-8820-exec-29] com.slipper.handler.RunExceptionHandler  : Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 

org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.resolveArgument(RequestResponseBodyMethodProcessor.java:141)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:122)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:179)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:146)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 13:53:53.270 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:53:53.271 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:53:53.282 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:53:53.283 ERROR 10704 --- [http-nio-8820-exec-2] com.slipper.handler.RunExceptionHandler  : Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 

org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.resolveArgument(RequestResponseBodyMethodProcessor.java:141)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:122)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:179)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:146)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 13:55:43.867 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:55:43.867 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:55:43.877 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:55:43.881 ERROR 10704 --- [http-nio-8820-exec-3] com.slipper.handler.RunExceptionHandler  : Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 

org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public com.slipper.common.pojo.Result<com.slipper.modules.conversation.model.res.ConversationResVO> com.slipper.modules.message.controller.MessageController.create(com.slipper.modules.message.model.req.MessageCreateReqVO): [Field error in object 'messageCreateReqVO' on field 'content': rejected value []; codes [NotBlank.messageCreateReqVO.content,NotBlank.content,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [messageCreateReqVO.content,content]; arguments []; default message [content]]; default message [内容不能为空]] 
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.resolveArgument(RequestResponseBodyMethodProcessor.java:141)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:122)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:179)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:146)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 13:56:05.165 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:56:05.165 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:56:05.176 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:56:05.542 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:56:05.542 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:56:05.552 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:56:05.572 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 13:56:05.572 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 13:56:05.584 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 13:56:07.888 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:56:07.888 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:56:07.889 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:56:07.889 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:56:07.900 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:56:07.901 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:56:07.901 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 13:56:07.906 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:56:07.909 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:56:07.925 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 13:56:07.925 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 13:56:07.942 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 13:57:12.738 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:57:12.738 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:57:12.747 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:57:12.756 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:57:12.756 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:57:12.763 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:57:12.764 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:57:12.764 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:57:12.773 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:57:12.774 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:57:12.774 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:57:12.782 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:57:12.783 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:57:12.783 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 🤭(String), 2024-05-30T13:57:12.783(LocalDateTime), 2024-05-30T13:57:12.783(LocalDateTime)
2024-05-30 13:57:12.799 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:57:12.799 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:57:12.800 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 113(Long), 2024-05-30T13:57:12.799(LocalDateTime), 1(Long)
2024-05-30 13:57:12.815 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:57:12.815 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:57:12.815 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:57:12.825 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:57:12.826 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:57:12.826 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:57:12.834 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:57:12.834 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:57:12.835 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:57:12.844 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:57:12.845 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:57:12.845 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:57:12.855 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:57:12.855 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:57:12.855 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:57:12.866 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:57:12.866 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:57:12.867 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:57:12.875 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:57:31.233 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:57:31.234 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:57:31.243 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:57:31.255 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:57:31.256 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:57:31.266 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:57:31.267 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:57:31.267 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:57:31.275 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:57:31.275 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:57:31.276 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:57:31.285 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:57:31.286 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, image, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:57:31.291 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 1(Integer), http://admin.gumingchen.icu/avatar/1f446996-9f8a-4ce7-b00f-479013132493.jpg(String), 2024-05-30T13:57:31.286(LocalDateTime), 2024-05-30T13:57:31.286(LocalDateTime)
2024-05-30 13:57:31.310 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:57:31.310 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:57:31.310 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 114(Long), 2024-05-30T13:57:31.310(LocalDateTime), 1(Long)
2024-05-30 13:57:31.328 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:57:31.329 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:57:31.329 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:57:31.338 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:57:31.339 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:57:31.339 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:57:31.347 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:57:31.348 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:57:31.348 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:57:31.355 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:57:31.356 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:57:31.356 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:57:31.366 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:57:31.366 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:57:31.367 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:57:31.377 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:57:31.378 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:57:31.378 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:57:31.389 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 13:57:37.982 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:57:37.983 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:57:37.990 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:57:37.991 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:57:37.991 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 103(Long), 10(Long)
2024-05-30 13:57:38.002 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:57:40.652 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:57:40.652 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:57:40.661 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:57:40.663 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:57:40.663 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 94(Long), 10(Long)
2024-05-30 13:57:40.672 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:57:41.784 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:57:41.785 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:57:41.794 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:57:41.806 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:57:41.807 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 84(Long), 10(Long)
2024-05-30 13:57:41.817 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:57:43.588 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:57:43.588 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:57:43.596 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:57:43.596 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:57:43.597 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 74(Long), 10(Long)
2024-05-30 13:57:43.607 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:57:45.027 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:57:45.027 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:57:45.035 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:57:45.036 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:57:45.036 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 64(Long), 10(Long)
2024-05-30 13:57:45.046 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:57:46.426 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:57:46.427 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:57:46.434 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:57:46.435 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:57:46.435 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 54(Long), 10(Long)
2024-05-30 13:57:46.447 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:57:47.786 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:57:47.786 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:57:47.793 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:57:47.794 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:57:47.794 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 44(Long), 10(Long)
2024-05-30 13:57:47.804 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:57:49.308 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:57:49.308 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:57:49.315 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:57:49.316 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:57:49.316 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 34(Long), 10(Long)
2024-05-30 13:57:49.327 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:57:51.254 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:57:51.254 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:57:51.263 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:57:51.265 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:57:51.265 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 24(Long), 10(Long)
2024-05-30 13:57:51.273 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:57:52.816 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:57:52.817 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:57:52.826 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:57:52.838 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:57:52.838 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 14(Long), 10(Long)
2024-05-30 13:57:52.848 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 13:57:54.443 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:57:54.444 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:57:54.451 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:57:54.453 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:57:54.453 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 4(Long), 10(Long)
2024-05-30 13:57:54.462 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 3
2024-05-30 13:57:55.739 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:57:55.750 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:57:55.759 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:57:55.760 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 13:57:55.761 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 13:57:55.770 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 13:59:49.235 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 13:59:49.235 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:59:49.248 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 13:59:49.259 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:59:49.259 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:59:49.269 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:59:49.271 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 13:59:49.271 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:59:49.281 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:59:49.282 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 13:59:49.282 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:59:49.291 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 13:59:49.292 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 13:59:49.292 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T13:59:49.291(LocalDateTime), 2024-05-30T13:59:49.291(LocalDateTime)
2024-05-30 13:59:49.309 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 13:59:49.310 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 13:59:49.310 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 115(Long), 2024-05-30T13:59:49.310(LocalDateTime), 1(Long)
2024-05-30 13:59:49.327 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 13:59:49.327 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 13:59:49.328 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 13:59:49.335 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 13:59:49.336 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 13:59:49.336 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 13:59:49.344 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 13:59:49.345 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 13:59:49.345 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 13:59:49.354 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 13:59:49.355 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 13:59:49.355 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 13:59:49.362 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 13:59:49.363 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 13:59:49.363 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 13:59:49.374 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 13:59:49.375 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 13:59:49.375 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 13:59:49.386 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:03:40.170 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:03:40.170 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:03:40.178 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:03:40.188 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:03:40.188 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:03:40.198 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:03:40.199 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:03:40.199 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:03:40.208 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:03:40.209 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:03:40.209 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:03:40.218 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:03:40.219 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:03:40.219 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T14:03:40.218(LocalDateTime), 2024-05-30T14:03:40.218(LocalDateTime)
2024-05-30 14:03:40.235 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:03:40.236 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:03:40.236 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 116(Long), 2024-05-30T14:03:40.235(LocalDateTime), 1(Long)
2024-05-30 14:03:40.250 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:03:40.251 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:03:40.251 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:03:40.259 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:03:40.260 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:03:40.260 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:03:40.269 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:03:40.270 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:03:40.270 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:03:40.279 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:03:40.280 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:03:40.281 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:03:40.290 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:03:40.290 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:03:40.291 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:03:40.298 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:03:40.299 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:03:40.301 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:03:40.302 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:03:40.302 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:03:40.309 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:03:40.312 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:03:40.318 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:03:40.319 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:03:40.327 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:03:40.328 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:03:40.328 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:03:40.339 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:03:40.340 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:03:40.341 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:03:40.348 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:03:40.349 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:03:40.349 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T14:03:40.348(LocalDateTime), 2024-05-30T14:03:40.348(LocalDateTime)
2024-05-30 14:03:40.364 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:03:40.365 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:03:40.365 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 117(Long), 2024-05-30T14:03:40.365(LocalDateTime), 1(Long)
2024-05-30 14:03:40.383 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:03:40.384 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:03:40.384 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:03:40.393 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:03:40.394 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:03:40.394 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:03:40.403 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:03:40.404 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:03:40.404 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:03:40.412 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:03:40.414 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:03:40.414 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:03:40.423 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:03:40.423 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:03:40.424 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:03:40.434 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:03:40.435 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:03:40.435 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:03:40.443 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:05:42.774 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:05:42.774 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:05:42.793 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:05:42.806 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:05:42.807 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:05:42.815 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:05:42.816 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:05:42.817 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:05:42.827 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:05:42.828 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:05:42.829 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:05:42.838 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:05:42.839 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:05:42.839 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T14:05:42.838(LocalDateTime), 2024-05-30T14:05:42.838(LocalDateTime)
2024-05-30 14:05:42.854 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:05:42.855 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:05:42.855 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 118(Long), 2024-05-30T14:05:42.854(LocalDateTime), 1(Long)
2024-05-30 14:05:42.872 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:05:42.872 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:05:42.872 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:05:42.873 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:05:42.873 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:05:42.882 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:05:42.882 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:05:42.884 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:05:42.884 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:05:42.893 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:05:42.894 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:05:42.894 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:05:42.895 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:05:42.895 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:05:42.903 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:05:42.904 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:05:42.905 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:05:42.905 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:05:42.905 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:05:42.905 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:05:42.914 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:05:42.915 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:05:42.915 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:05:42.915 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:05:42.916 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:05:42.916 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:05:42.925 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:05:42.926 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:05:42.926 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T14:05:42.926(LocalDateTime), 2024-05-30T14:05:42.926(LocalDateTime)
2024-05-30 14:05:42.927 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:05:42.927 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:05:42.928 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:05:42.936 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:05:42.942 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:05:42.943 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:05:42.943 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 119(Long), 2024-05-30T14:05:42.943(LocalDateTime), 1(Long)
2024-05-30 14:05:42.962 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:05:42.962 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:05:42.962 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:05:42.972 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:05:42.974 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:05:42.974 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:05:42.982 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:05:42.984 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:05:42.984 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:05:42.994 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:05:42.995 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:05:42.995 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:05:43.003 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:05:43.017 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:05:43.017 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:05:43.029 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:05:43.029 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:05:43.030 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:05:43.041 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:06:15.411 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:06:15.412 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:06:15.421 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:06:15.431 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:06:15.431 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:06:15.438 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:06:15.440 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:06:15.440 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:06:15.450 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:06:15.451 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:06:15.452 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:06:15.461 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:06:15.462 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:06:15.462 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T14:06:15.461(LocalDateTime), 2024-05-30T14:06:15.461(LocalDateTime)
2024-05-30 14:06:15.481 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:06:15.482 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:06:15.482 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 120(Long), 2024-05-30T14:06:15.481(LocalDateTime), 1(Long)
2024-05-30 14:06:15.500 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:06:15.501 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:06:15.501 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:06:15.511 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:06:15.513 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:06:15.513 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:06:15.520 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:06:15.522 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:06:15.522 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:06:15.533 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:06:15.534 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:06:15.534 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:06:15.544 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:06:15.545 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:06:15.545 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:06:15.557 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:06:15.558 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:06:15.558 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:06:15.571 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:06:17.577 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:06:17.577 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:06:17.597 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:06:17.606 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:06:17.607 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:06:17.616 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:06:17.617 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:06:17.618 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:06:17.627 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:06:17.628 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:06:17.628 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:06:17.637 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:06:17.638 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:06:17.638 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T14:06:17.637(LocalDateTime), 2024-05-30T14:06:17.637(LocalDateTime)
2024-05-30 14:06:17.654 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:06:17.655 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:06:17.655 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 121(Long), 2024-05-30T14:06:17.655(LocalDateTime), 1(Long)
2024-05-30 14:06:17.673 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:06:17.673 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:06:17.673 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:06:17.683 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:06:17.685 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:06:17.685 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:06:17.693 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:06:17.694 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:06:17.695 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:06:17.703 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:06:17.704 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:06:17.704 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:06:17.715 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:06:17.716 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:06:17.716 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:06:17.727 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:06:17.728 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:06:17.729 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:06:17.740 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:06:24.502 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:06:24.502 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:06:24.513 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:06:24.524 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:06:24.524 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:06:24.534 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:06:24.535 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:06:24.535 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:06:24.553 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:06:24.554 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:06:24.554 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:06:24.569 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:06:24.570 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:06:24.571 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T14:06:24.570(LocalDateTime), 2024-05-30T14:06:24.570(LocalDateTime)
2024-05-30 14:06:24.598 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:06:24.599 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:06:24.599 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 122(Long), 2024-05-30T14:06:24.598(LocalDateTime), 1(Long)
2024-05-30 14:06:24.631 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:06:24.632 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:06:24.632 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:06:24.645 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:06:24.646 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:06:24.646 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:06:24.659 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:06:24.660 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:06:24.660 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:06:24.678 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:06:24.679 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:06:24.679 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:06:24.691 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:06:24.691 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:06:24.692 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:06:24.720 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:06:24.721 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:06:24.721 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:06:24.735 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:07:00.818 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:07:00.829 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:00.840 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:07:00.848 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:07:00.848 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:00.857 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:07:00.858 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:07:00.858 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:07:00.867 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:07:00.868 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:07:00.869 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:07:00.875 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:07:00.876 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:07:00.876 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 213(String), 2024-05-30T14:07:00.876(LocalDateTime), 2024-05-30T14:07:00.876(LocalDateTime)
2024-05-30 14:07:00.892 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:07:00.893 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:07:00.893 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 123(Long), 2024-05-30T14:07:00.893(LocalDateTime), 1(Long)
2024-05-30 14:07:00.909 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:07:00.909 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:07:00.909 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:00.917 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:07:00.918 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:07:00.918 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:07:00.925 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:07:00.926 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:07:00.927 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:07:00.936 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:07:00.941 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:07:00.941 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:07:00.950 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:07:00.950 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:07:00.951 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:07:00.961 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:07:00.962 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:07:00.963 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:07:00.974 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:07:04.185 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:07:04.186 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:04.195 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:07:04.206 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:07:04.217 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:04.227 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:07:04.228 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:07:04.228 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:07:04.237 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:07:04.239 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:07:04.239 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:07:04.245 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:07:04.246 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:07:04.246 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 313nighihi21(String), 2024-05-30T14:07:04.246(LocalDateTime), 2024-05-30T14:07:04.246(LocalDateTime)
2024-05-30 14:07:04.261 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:07:04.263 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:07:04.263 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 124(Long), 2024-05-30T14:07:04.262(LocalDateTime), 1(Long)
2024-05-30 14:07:04.278 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:07:04.279 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:07:04.279 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:04.287 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:07:04.288 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:07:04.288 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:07:04.296 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:07:04.297 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:07:04.297 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:07:04.305 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:07:04.306 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:07:04.306 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:07:04.315 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:07:04.315 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:07:04.316 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:07:04.327 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:07:04.328 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:07:04.328 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:07:04.339 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:07:32.705 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:07:32.706 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:32.716 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:07:32.727 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:07:32.728 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:32.735 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:07:32.736 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:07:32.736 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:07:32.745 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:07:32.747 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:07:32.747 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:07:32.760 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:07:32.761 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:07:32.761 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T14:07:32.761(LocalDateTime), 2024-05-30T14:07:32.761(LocalDateTime)
2024-05-30 14:07:32.796 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:07:32.797 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:07:32.797 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 125(Long), 2024-05-30T14:07:32.796(LocalDateTime), 1(Long)
2024-05-30 14:07:32.881 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:07:32.881 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:07:32.881 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:32.985 ERROR 10704 --- [http-nio-8820-exec-3] c.alibaba.druid.filter.stat.StatFilter   : slow sql 102 millis. SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=?  AND deleted=0[1]
2024-05-30 14:07:32.986 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:07:32.987 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:07:32.987 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:07:33.029 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:07:33.030 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:07:33.030 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:07:33.055 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:07:33.056 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:07:33.056 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:07:33.113 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:07:33.114 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:07:33.114 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:07:33.218 ERROR 10704 --- [http-nio-8820-exec-3] c.alibaba.druid.filter.stat.StatFilter   : slow sql 104 millis. SELECT c.id, c.room_id, c.user_id,
               m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage,
               m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt,
               mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex,
               rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar,
               f.id AS friendId, f.remark,
               u.id AS userId, u.nickname, u.avatar, u.sex, u.online
        FROM conversation AS c
                 LEFT JOIN room AS r ON r.id = c.room_id
                 LEFT JOIN message AS m ON m.id = r.last_message_id
                 LEFT JOIN user AS mu ON mu.id = m.user_id
                 LEFT JOIN room_group AS rg ON rg.room_id = c.room_id
                 LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id
                 LEFT JOIN user AS u
                           ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id)
                               OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id)
                 LEFT JOIN friend AS f
                           ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id
        WHERE c.deleted = 0
     
        AND c.id IN  (  
                        ?
                     )[2]
2024-05-30 14:07:33.218 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:07:33.219 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:07:33.219 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:07:33.247 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:07:33.685 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:07:33.686 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:33.754 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:07:33.778 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:07:33.778 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:33.798 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:07:33.799 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:07:33.800 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:07:33.828 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:07:33.829 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:07:33.829 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:07:33.894 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:07:33.895 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:07:33.895 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T14:07:33.894(LocalDateTime), 2024-05-30T14:07:33.894(LocalDateTime)
2024-05-30 14:07:33.995 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:07:33.996 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:07:33.996 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 126(Long), 2024-05-30T14:07:33.995(LocalDateTime), 1(Long)
2024-05-30 14:07:34.092 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:07:34.093 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:07:34.093 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:34.170 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:07:34.172 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:07:34.172 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:07:34.238 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:07:34.239 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:07:34.239 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:07:34.247 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:07:34.248 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:07:34.248 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:07:34.257 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:07:34.258 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:07:34.258 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:07:34.273 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:07:34.274 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:07:34.274 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:07:34.286 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:07:35.409 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:07:35.410 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:35.419 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:07:35.431 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:07:35.431 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:35.439 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:07:35.441 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:07:35.441 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:07:35.449 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:07:35.451 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:07:35.452 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:07:35.459 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:07:35.460 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:07:35.460 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3
13(String), 2024-05-30T14:07:35.459(LocalDateTime), 2024-05-30T14:07:35.459(LocalDateTime)
2024-05-30 14:07:35.475 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:07:35.475 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:07:35.476 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 127(Long), 2024-05-30T14:07:35.475(LocalDateTime), 1(Long)
2024-05-30 14:07:35.493 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:07:35.493 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:07:35.494 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:35.502 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:07:35.503 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:07:35.504 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:07:35.514 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:07:35.515 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:07:35.515 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:07:35.525 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:07:35.526 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:07:35.526 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:07:35.533 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:07:35.534 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:07:35.535 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:07:35.548 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:07:35.549 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:07:35.549 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:07:35.560 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:07:35.784 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:07:35.784 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:35.793 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:07:35.803 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:07:35.803 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:35.812 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:07:35.812 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:07:35.812 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:07:35.819 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:07:35.819 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:07:35.820 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:07:35.826 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:07:35.826 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:07:35.826 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 13(String), 2024-05-30T14:07:35.826(LocalDateTime), 2024-05-30T14:07:35.826(LocalDateTime)
2024-05-30 14:07:35.841 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:07:35.842 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:07:35.842 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 128(Long), 2024-05-30T14:07:35.841(LocalDateTime), 1(Long)
2024-05-30 14:07:35.861 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:07:35.861 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:07:35.862 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:35.871 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:07:35.872 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:07:35.872 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:07:35.878 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:07:35.880 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:07:35.880 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:07:35.887 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:07:35.888 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:07:35.888 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:07:35.894 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:07:35.896 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:07:35.896 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:07:35.906 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:07:35.907 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:07:35.907 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:07:35.917 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:07:36.060 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:07:36.061 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:36.073 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:07:36.084 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:07:36.084 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:36.094 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:07:36.097 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:07:36.097 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:07:36.106 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:07:36.108 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:07:36.108 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:07:36.116 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:07:36.116 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:07:36.117 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 13(String), 2024-05-30T14:07:36.116(LocalDateTime), 2024-05-30T14:07:36.116(LocalDateTime)
2024-05-30 14:07:36.133 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:07:36.134 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:07:36.134 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 129(Long), 2024-05-30T14:07:36.134(LocalDateTime), 1(Long)
2024-05-30 14:07:36.149 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:07:36.150 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:07:36.150 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:36.158 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:07:36.162 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:07:36.163 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:07:36.172 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:07:36.173 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:07:36.173 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:07:36.183 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:07:36.184 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:07:36.185 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:07:36.195 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:07:36.199 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:07:36.200 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:07:36.210 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:07:36.211 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:07:36.211 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:07:36.223 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:07:36.313 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:07:36.313 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:36.323 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:07:36.331 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:07:36.331 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:36.343 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:07:36.347 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:07:36.347 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:07:36.360 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:07:36.361 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:07:36.362 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:07:36.370 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:07:36.371 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:07:36.371 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 13(String), 2024-05-30T14:07:36.370(LocalDateTime), 2024-05-30T14:07:36.370(LocalDateTime)
2024-05-30 14:07:36.387 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:07:36.391 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:07:36.392 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 130(Long), 2024-05-30T14:07:36.391(LocalDateTime), 1(Long)
2024-05-30 14:07:36.407 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:07:36.407 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:07:36.408 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:36.417 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:07:36.419 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:07:36.419 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:07:36.427 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:07:36.433 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:07:36.434 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:07:36.442 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:07:36.443 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:07:36.444 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:07:36.459 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:07:36.460 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:07:36.460 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:07:36.471 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:07:36.472 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:07:36.473 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:07:36.483 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:07:36.580 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:07:36.580 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:36.588 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:07:36.603 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:07:36.603 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:36.612 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:07:36.614 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:07:36.614 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:07:36.622 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:07:36.628 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:07:36.628 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:07:36.636 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:07:36.637 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:07:36.637 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 13(String), 2024-05-30T14:07:36.636(LocalDateTime), 2024-05-30T14:07:36.636(LocalDateTime)
2024-05-30 14:07:36.653 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:07:36.654 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:07:36.654 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 131(Long), 2024-05-30T14:07:36.653(LocalDateTime), 1(Long)
2024-05-30 14:07:36.671 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:07:36.672 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:07:36.672 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:07:36.680 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:07:36.683 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:07:36.683 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:07:36.691 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:07:36.692 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:07:36.692 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:07:36.703 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:07:36.705 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:07:36.705 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:07:36.714 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:07:36.714 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:07:36.715 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:07:36.733 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:07:36.735 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:07:36.736 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:07:36.746 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:09:43.515 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:09:43.515 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:09:43.527 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:09:43.870 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:09:43.871 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:09:43.880 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:09:43.899 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:09:43.900 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:09:43.908 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:11:04.333 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:11:04.333 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:11:04.341 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:11:04.676 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:11:04.679 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:11:04.687 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:11:04.706 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:11:04.706 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:11:04.718 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:11:29.302 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:11:29.305 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:11:29.316 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:11:29.677 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:11:29.678 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:11:29.686 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:11:29.706 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:11:29.707 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:11:29.718 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:12:06.249 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:12:06.249 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:12:06.258 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:12:06.570 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:12:06.570 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:12:06.580 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:12:06.598 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:12:06.598 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:12:06.609 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:12:08.172 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:12:08.172 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:12:08.183 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:12:08.185 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:12:08.186 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:12:08.197 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:12:08.209 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:12:08.210 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:12:08.217 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:12:08.218 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:12:08.431 ERROR 10704 --- [http-nio-8820-exec-17] c.alibaba.druid.filter.stat.StatFilter   : slow sql 212 millis. SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at,
               u.id AS userId, u.nickname, u.avatar, u.sex
        FROM message AS m
        LEFT JOIN user AS u ON u.id = m.user_id
        WHERE m.deleted = 0
     
        AND m.room_id = ?
         
        ORDER BY m.created_at DESC
        LIMIT ?[1,10]
2024-05-30 14:12:08.432 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 14:12:08.434 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:12:09.063 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:12:09.063 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:12:09.073 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:12:09.082 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:12:09.083 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:12:09.090 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:12:09.091 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:12:09.091 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:12:09.100 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:12:09.101 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:12:09.101 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:12:09.110 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:12:09.111 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:12:09.111 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T14:12:09.111(LocalDateTime), 2024-05-30T14:12:09.111(LocalDateTime)
2024-05-30 14:12:09.127 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:12:09.129 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:12:09.129 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 132(Long), 2024-05-30T14:12:09.128(LocalDateTime), 1(Long)
2024-05-30 14:12:09.149 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:12:09.150 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:12:09.150 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:12:09.160 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:12:09.160 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:12:09.161 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:12:09.171 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:12:09.172 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:12:09.172 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:12:09.182 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:12:09.183 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:12:09.183 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:12:09.193 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:12:09.194 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:12:09.194 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:12:09.205 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:12:09.206 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:12:09.206 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:12:09.217 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:12:11.488 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:12:11.488 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:12:11.497 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:12:11.507 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:12:11.507 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:12:11.516 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:12:11.518 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:12:11.518 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:12:11.526 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:12:11.527 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:12:11.527 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:12:11.535 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:12:11.536 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:12:11.536 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T14:12:11.535(LocalDateTime), 2024-05-30T14:12:11.535(LocalDateTime)
2024-05-30 14:12:11.551 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:12:11.551 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:12:11.552 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 133(Long), 2024-05-30T14:12:11.551(LocalDateTime), 1(Long)
2024-05-30 14:12:11.566 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:12:11.567 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:12:11.567 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:12:11.577 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:12:11.578 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:12:11.578 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:12:11.588 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:12:11.589 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:12:11.589 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:12:11.598 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:12:11.599 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:12:11.599 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:12:11.607 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:12:11.608 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:12:11.608 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:12:11.619 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:12:11.620 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:12:11.620 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:12:11.630 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:12:38.370 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:12:38.370 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:12:38.380 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:12:38.893 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:12:38.894 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:12:38.903 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:12:38.923 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:12:38.924 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:12:38.934 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:12:49.319 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:12:49.320 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:12:49.329 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:12:49.679 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:12:49.680 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:12:49.688 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:12:49.707 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:12:49.707 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:12:49.718 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:13:18.338 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:13:18.338 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:13:18.347 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:13:18.720 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:13:18.720 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:13:18.728 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:13:18.743 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:13:18.744 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:13:18.752 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:14:12.429 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:14:12.430 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:14:12.440 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:14:13.061 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:14:13.062 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:14:13.070 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:14:13.090 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:14:13.095 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:14:13.107 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:14:22.324 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:14:22.324 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:14:22.332 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:14:22.669 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:14:22.669 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:14:22.679 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:14:22.699 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:14:22.699 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:14:22.710 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:14:46.460 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:14:46.460 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:14:46.469 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:14:46.853 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:14:46.854 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:14:46.863 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:14:46.882 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:14:46.883 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:14:46.891 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:14:53.286 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:14:53.287 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:14:53.294 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:14:53.694 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:14:53.694 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:14:53.706 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:14:53.726 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:14:53.726 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:14:53.735 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:15:18.701 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:15:18.701 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:15:18.702 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:15:18.702 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:15:18.711 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:15:18.712 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:15:18.713 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:15:18.714 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:15:18.721 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 14:15:18.732 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:15:18.732 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:15:18.744 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:16:19.944 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:16:19.944 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:16:19.953 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:16:20.244 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:16:20.244 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:16:20.253 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:16:20.269 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:16:20.269 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:16:20.285 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:16:21.254 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:16:21.254 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:16:21.264 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:16:21.280 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:16:21.280 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:16:21.289 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:16:21.290 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:16:21.292 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:16:21.299 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:16:21.300 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:16:21.301 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:16:21.311 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 14:17:01.112 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:17:01.112 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:17:01.122 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:17:01.171 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:17:01.171 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:17:01.203 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:17:01.214 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:17:01.214 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:17:01.233 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:17:01.234 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:17:01.234 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:17:01.245 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:17:01.246 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:17:01.247 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:17:01.266 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:17:01.267 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, file, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:17:01.270 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 3(Integer), http://admin.gumingchen.icu/file/f439fa93-78d3-4a08-9c7c-f894c4e2c941.md(String), 2024-05-30T14:17:01.267(LocalDateTime), 2024-05-30T14:17:01.267(LocalDateTime)
2024-05-30 14:17:01.285 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:17:01.286 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:17:01.286 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 134(Long), 2024-05-30T14:17:01.286(LocalDateTime), 1(Long)
2024-05-30 14:17:01.477 ERROR 10704 --- [http-nio-8820-exec-11] c.alibaba.druid.filter.stat.StatFilter   : slow sql 190 millis. UPDATE room  SET last_message_id=?,

updated_at=?  WHERE id=?  AND deleted=0[134,"<java.time.LocalDateTime>",1]
2024-05-30 14:17:01.477 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:17:01.478 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:17:01.478 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:17:01.488 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:17:01.489 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:17:01.490 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:17:01.499 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:17:01.500 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:17:01.500 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:17:01.510 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:17:01.511 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:17:01.511 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:17:01.521 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:17:01.522 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:17:01.522 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:17:01.533 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:17:01.534 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:17:01.534 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:17:01.548 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:17:08.612 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:17:08.612 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:17:08.621 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:17:09.121 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:17:09.121 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:17:09.130 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:17:09.146 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:17:09.147 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:17:09.156 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:17:10.268 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:17:10.268 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:17:10.268 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:17:10.268 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:17:10.276 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:17:10.277 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:17:10.277 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:17:10.279 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:17:10.287 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 14:17:10.295 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:17:10.296 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:17:10.308 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:17:11.980 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:17:11.980 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:17:11.987 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:17:11.989 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:17:11.990 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 125(Long), 10(Long)
2024-05-30 14:17:11.999 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 14:17:13.582 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:17:13.582 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:17:13.589 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:17:13.591 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:17:13.591 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 115(Long), 10(Long)
2024-05-30 14:17:13.600 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 14:21:44.153 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:21:44.153 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:21:44.161 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:21:44.451 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:21:44.452 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:21:44.458 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:21:44.474 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:21:44.475 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:21:44.485 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:21:45.636 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:21:45.637 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:21:45.637 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:21:45.637 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:21:45.642 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:21:45.645 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:21:45.646 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:21:45.646 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:21:45.655 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 14:21:45.661 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:21:45.661 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:21:45.672 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:21:57.471 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:21:57.472 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:21:57.479 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:21:57.480 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:21:57.480 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 125(Long), 10(Long)
2024-05-30 14:21:57.490 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 14:22:54.661 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:22:54.662 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:22:54.670 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:22:54.672 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:22:54.672 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 115(Long), 10(Long)
2024-05-30 14:22:54.682 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 14:23:29.506 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:23:29.507 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:23:29.514 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:23:29.515 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:23:29.515 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 105(Long), 10(Long)
2024-05-30 14:23:29.524 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 14:27:51.389 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:27:51.389 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:27:51.400 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:27:51.728 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:27:51.728 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:27:51.738 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:27:51.758 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:27:51.758 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:27:51.775 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:27:52.501 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:27:52.501 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:27:52.501 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:27:52.502 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:27:52.509 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:27:52.511 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:27:52.512 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:27:52.512 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:27:52.522 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 1
2024-05-30 14:27:52.528 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:27:52.528 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:27:52.540 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:32:42.902 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:32:42.903 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:32:42.913 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:32:42.925 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:32:42.925 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:32:42.934 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:32:42.937 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:32:42.937 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:32:42.948 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:32:42.949 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:32:42.950 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:32:42.959 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:32:42.960 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:32:42.961 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 你好(String), 2024-05-30T14:32:42.960(LocalDateTime), 2024-05-30T14:32:42.960(LocalDateTime)
2024-05-30 14:32:42.978 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:32:42.979 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:32:42.979 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 2(Long), 2024-05-30T14:32:42.978(LocalDateTime), 1(Long)
2024-05-30 14:32:42.995 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:32:42.995 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:32:42.996 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:32:43.002 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:32:43.003 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:32:43.003 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:32:43.010 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:32:43.011 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:32:43.012 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:32:43.020 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:32:43.022 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:32:43.022 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:32:43.030 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:32:43.031 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:32:43.031 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:32:43.041 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:32:43.043 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:32:43.043 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:32:43.053 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:32:46.160 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:32:46.161 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:32:46.169 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:32:46.178 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:32:46.178 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:32:46.187 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:32:46.188 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:32:46.189 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:32:46.198 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:32:46.199 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:32:46.199 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:32:46.206 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:32:46.207 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:32:46.207 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 为什么(String), 2024-05-30T14:32:46.207(LocalDateTime), 2024-05-30T14:32:46.207(LocalDateTime)
2024-05-30 14:32:46.221 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:32:46.222 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:32:46.222 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 3(Long), 2024-05-30T14:32:46.222(LocalDateTime), 1(Long)
2024-05-30 14:32:46.237 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:32:46.238 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:32:46.238 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:32:46.246 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:32:46.247 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:32:46.248 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:32:46.258 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:32:46.259 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:32:46.259 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:32:46.269 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:32:46.270 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:32:46.270 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:32:46.280 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:32:46.281 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:32:46.282 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:32:46.293 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:32:46.295 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:32:46.296 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:32:46.304 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:32:49.677 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:32:49.678 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:32:49.687 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:32:49.696 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:32:49.696 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:32:49.705 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:32:49.706 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:32:49.706 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:32:49.715 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:32:49.716 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:32:49.716 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:32:49.725 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:32:49.725 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:32:49.726 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 你说什么东西(String), 2024-05-30T14:32:49.725(LocalDateTime), 2024-05-30T14:32:49.725(LocalDateTime)
2024-05-30 14:32:49.743 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:32:49.743 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:32:49.744 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 4(Long), 2024-05-30T14:32:49.743(LocalDateTime), 1(Long)
2024-05-30 14:32:49.761 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:32:49.762 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:32:49.762 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:32:49.771 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:32:49.772 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:32:49.772 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:32:49.781 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:32:49.782 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:32:49.782 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:32:49.792 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:32:49.794 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:32:49.794 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:32:49.802 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:32:49.803 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:32:49.804 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:32:49.815 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:32:49.816 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:32:49.817 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:32:49.827 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:32:53.482 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:32:53.482 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:32:53.490 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:32:53.499 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:32:53.500 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:32:53.508 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:32:53.509 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:32:53.509 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:32:53.518 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:32:53.519 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:32:53.519 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:32:53.527 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:32:53.527 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:32:53.527 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 这不好吧(String), 2024-05-30T14:32:53.527(LocalDateTime), 2024-05-30T14:32:53.527(LocalDateTime)
2024-05-30 14:32:53.542 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:32:53.543 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:32:53.543 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 5(Long), 2024-05-30T14:32:53.543(LocalDateTime), 1(Long)
2024-05-30 14:32:53.559 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:32:53.559 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:32:53.559 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:32:53.568 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:32:53.569 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:32:53.570 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:32:53.578 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:32:53.579 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:32:53.580 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:32:53.594 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:32:53.596 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:32:53.596 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:32:53.604 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:32:53.605 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:32:53.605 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:32:53.615 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:32:53.616 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:32:53.616 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:32:53.627 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:32:54.685 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:32:54.685 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:32:54.694 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:32:54.695 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:32:54.696 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 14:32:54.703 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 14:32:59.501 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:32:59.501 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:32:59.510 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:32:59.521 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:32:59.521 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:32:59.529 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:32:59.530 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:32:59.530 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:32:59.539 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:32:59.540 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:32:59.540 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:32:59.550 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:32:59.551 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:32:59.551 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 这样真的好吗(String), 2024-05-30T14:32:59.550(LocalDateTime), 2024-05-30T14:32:59.550(LocalDateTime)
2024-05-30 14:32:59.568 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:32:59.569 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:32:59.569 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 6(Long), 2024-05-30T14:32:59.568(LocalDateTime), 1(Long)
2024-05-30 14:32:59.585 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:32:59.586 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:32:59.586 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:32:59.593 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:32:59.595 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:32:59.595 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:32:59.604 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:32:59.607 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:32:59.607 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:32:59.614 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:32:59.616 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:32:59.616 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:32:59.624 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:32:59.624 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:32:59.625 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:32:59.635 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:32:59.636 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:32:59.636 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:32:59.646 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:33:04.623 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:33:04.623 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:04.631 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:33:04.641 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:33:04.641 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:04.650 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:33:04.651 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:33:04.651 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:33:04.660 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:33:04.661 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:33:04.662 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:33:04.672 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:33:04.673 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:33:04.674 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 杠杠(String), 2024-05-30T14:33:04.673(LocalDateTime), 2024-05-30T14:33:04.673(LocalDateTime)
2024-05-30 14:33:04.692 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:33:04.692 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:33:04.692 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 7(Long), 2024-05-30T14:33:04.692(LocalDateTime), 1(Long)
2024-05-30 14:33:04.709 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:33:04.709 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:33:04.709 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:04.717 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:33:04.718 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:33:04.719 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:33:04.726 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:33:04.727 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:33:04.727 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:33:04.736 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:33:04.738 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:33:04.738 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:33:04.747 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:33:04.748 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:33:04.749 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:33:04.759 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:33:04.760 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:33:04.761 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:33:04.771 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:33:21.405 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:33:21.405 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:21.415 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:33:21.751 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:33:21.751 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:21.762 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:33:21.781 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:33:21.782 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:33:21.794 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:33:23.002 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:33:23.003 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:23.003 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:33:23.004 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:23.011 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:33:23.011 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:33:23.013 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:33:23.013 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:33:23.021 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 1
2024-05-30 14:33:23.030 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:33:23.030 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:33:23.042 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:33:24.451 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:33:24.451 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:24.461 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:33:24.470 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:33:24.470 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:24.478 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:33:24.480 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:33:24.480 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:33:24.488 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:33:24.489 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:33:24.489 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:33:24.496 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:33:24.497 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:33:24.497 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T14:33:24.496(LocalDateTime), 2024-05-30T14:33:24.496(LocalDateTime)
2024-05-30 14:33:24.511 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:33:24.512 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:33:24.512 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 2(Long), 2024-05-30T14:33:24.511(LocalDateTime), 1(Long)
2024-05-30 14:33:24.528 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:33:24.529 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:33:24.529 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:24.536 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:33:24.537 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:33:24.538 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:33:24.545 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:33:24.546 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:33:24.547 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:33:24.555 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:33:24.556 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:33:24.557 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:33:24.564 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:33:24.564 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:33:24.565 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:33:24.576 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:33:24.577 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:33:24.577 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:33:24.588 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:33:25.202 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:33:25.202 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:25.211 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:33:25.219 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:33:25.219 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:25.226 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:33:25.227 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:33:25.228 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:33:25.237 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:33:25.239 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:33:25.239 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:33:25.247 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:33:25.248 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:33:25.248 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T14:33:25.248(LocalDateTime), 2024-05-30T14:33:25.248(LocalDateTime)
2024-05-30 14:33:25.264 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:33:25.265 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:33:25.265 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 3(Long), 2024-05-30T14:33:25.265(LocalDateTime), 1(Long)
2024-05-30 14:33:25.280 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:33:25.281 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:33:25.281 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:25.290 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:33:25.291 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:33:25.291 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:33:25.301 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:33:25.302 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:33:25.302 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:33:25.310 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:33:25.312 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:33:25.312 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:33:25.322 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:33:25.323 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:33:25.324 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:33:25.336 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:33:25.337 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:33:25.337 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:33:25.349 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:33:25.853 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:33:25.853 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:25.861 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:33:25.877 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:33:25.877 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:25.886 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:33:25.888 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:33:25.888 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:33:25.896 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:33:25.897 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:33:25.898 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:33:25.906 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:33:25.907 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:33:25.907 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T14:33:25.907(LocalDateTime), 2024-05-30T14:33:25.907(LocalDateTime)
2024-05-30 14:33:25.921 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:33:25.922 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:33:25.923 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 4(Long), 2024-05-30T14:33:25.922(LocalDateTime), 1(Long)
2024-05-30 14:33:25.939 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:33:25.939 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:33:25.939 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:25.946 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:33:25.948 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:33:25.948 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:33:25.957 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:33:25.958 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:33:25.958 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:33:25.967 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:33:25.968 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:33:25.968 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:33:25.974 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:33:25.974 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:33:25.975 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:33:25.985 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:33:25.986 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:33:25.986 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:33:25.996 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:33:26.957 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:33:26.957 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:26.965 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:33:26.975 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:33:26.975 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:26.981 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:33:26.983 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:33:26.983 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:33:26.991 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:33:26.992 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:33:26.993 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:33:27.001 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:33:27.001 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:33:27.001 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 4(String), 2024-05-30T14:33:27.001(LocalDateTime), 2024-05-30T14:33:27.001(LocalDateTime)
2024-05-30 14:33:27.022 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:33:27.022 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:33:27.022 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 5(Long), 2024-05-30T14:33:27.022(LocalDateTime), 1(Long)
2024-05-30 14:33:27.038 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:33:27.038 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:33:27.038 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:27.046 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:33:27.048 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:33:27.048 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:33:27.055 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:33:27.057 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:33:27.057 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:33:27.064 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:33:27.065 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:33:27.065 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:33:27.073 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:33:27.074 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:33:27.074 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:33:27.084 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:33:27.085 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:33:27.085 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:33:27.096 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:33:28.141 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:33:28.141 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:33:28.153 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:33:28.155 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:33:28.155 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 14:33:28.168 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 14:34:09.598 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.c.s.h.AuthenticationEntryPointImpl   : [访问 URL http://localhost:8820/chatterbox/message/page/id 时，未登录]
2024-05-30 14:34:29.391 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:34:29.391 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:29.401 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:34:29.719 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:34:29.720 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:29.730 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:34:29.748 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:34:29.749 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:34:29.761 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:34:37.504 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:34:37.505 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:37.512 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:34:37.512 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:37.512 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:34:37.514 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:34:37.514 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:34:37.520 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:34:37.523 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 1
2024-05-30 14:34:37.540 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:34:37.540 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:34:37.552 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:34:40.123 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:34:40.123 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:40.134 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:34:40.144 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:34:40.144 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:40.153 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:34:40.154 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:34:40.155 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:34:40.164 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:34:40.165 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:34:40.165 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:34:40.175 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:34:40.176 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:34:40.176 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T14:34:40.175(LocalDateTime), 2024-05-30T14:34:40.175(LocalDateTime)
2024-05-30 14:34:40.192 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:34:40.192 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:34:40.193 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 2(Long), 2024-05-30T14:34:40.192(LocalDateTime), 1(Long)
2024-05-30 14:34:40.208 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:34:40.208 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:34:40.208 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:40.217 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:34:40.218 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:34:40.218 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:34:40.225 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:34:40.227 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:34:40.227 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:34:40.236 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:34:40.237 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:34:40.237 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:34:40.247 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:34:40.248 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:34:40.248 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:34:40.260 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:34:40.260 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:34:40.261 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:34:40.272 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:34:40.944 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:34:40.944 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:40.954 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:34:40.965 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:34:40.965 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:40.974 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:34:40.975 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:34:40.975 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:34:40.984 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:34:40.986 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:34:40.986 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:34:40.997 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:34:40.997 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:34:40.997 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T14:34:40.997(LocalDateTime), 2024-05-30T14:34:40.997(LocalDateTime)
2024-05-30 14:34:41.014 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:34:41.015 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:34:41.015 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 3(Long), 2024-05-30T14:34:41.015(LocalDateTime), 1(Long)
2024-05-30 14:34:41.033 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:34:41.033 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:34:41.033 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:41.041 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:34:41.042 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:34:41.042 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:34:41.051 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:34:41.052 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:34:41.052 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:34:41.061 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:34:41.062 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:34:41.062 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:34:41.072 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:34:41.072 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:34:41.073 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:34:41.083 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:34:41.085 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:34:41.085 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:34:41.096 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:34:42.155 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:34:42.156 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:42.164 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:34:42.166 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:34:42.167 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 14:34:42.175 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 14:34:43.271 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:34:43.271 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:43.282 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:34:43.293 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:34:43.293 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:43.301 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:34:43.303 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:34:43.303 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:34:43.312 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:34:43.313 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:34:43.313 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:34:43.322 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:34:43.323 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:34:43.323 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T14:34:43.323(LocalDateTime), 2024-05-30T14:34:43.323(LocalDateTime)
2024-05-30 14:34:43.343 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:34:43.344 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:34:43.344 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 4(Long), 2024-05-30T14:34:43.343(LocalDateTime), 1(Long)
2024-05-30 14:34:43.362 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:34:43.363 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:34:43.363 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:43.373 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:34:43.375 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:34:43.375 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:34:43.384 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:34:43.385 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:34:43.385 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:34:43.394 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:34:43.395 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:34:43.395 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:34:43.403 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:34:43.404 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:34:43.405 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:34:43.417 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:34:43.419 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:34:43.419 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:34:43.427 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:34:44.201 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:34:44.201 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:44.211 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:34:44.219 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:34:44.219 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:44.228 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:34:44.230 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:34:44.230 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:34:44.237 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:34:44.238 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:34:44.238 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:34:44.247 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:34:44.248 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:34:44.248 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 4(String), 2024-05-30T14:34:44.247(LocalDateTime), 2024-05-30T14:34:44.247(LocalDateTime)
2024-05-30 14:34:44.262 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:34:44.263 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:34:44.263 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 5(Long), 2024-05-30T14:34:44.262(LocalDateTime), 1(Long)
2024-05-30 14:34:44.280 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:34:44.280 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:34:44.280 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:44.289 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:34:44.290 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:34:44.290 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:34:44.299 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:34:44.300 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:34:44.300 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:34:44.310 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:34:44.312 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:34:44.312 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:34:44.321 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:34:44.322 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:34:44.322 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:34:44.333 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:34:44.333 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:34:44.334 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:34:44.345 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:34:46.514 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:34:46.515 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:46.523 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:34:46.534 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:34:46.534 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:46.542 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:34:46.544 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:34:46.544 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:34:46.551 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:34:46.552 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:34:46.553 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:34:46.561 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:34:46.562 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:34:46.562 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 5(String), 2024-05-30T14:34:46.562(LocalDateTime), 2024-05-30T14:34:46.562(LocalDateTime)
2024-05-30 14:34:46.579 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:34:46.580 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:34:46.580 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 6(Long), 2024-05-30T14:34:46.580(LocalDateTime), 1(Long)
2024-05-30 14:34:46.595 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:34:46.595 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:34:46.596 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:34:46.603 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:34:46.605 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:34:46.605 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:34:46.614 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:34:46.615 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:34:46.615 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:34:46.624 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:34:46.625 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:34:46.625 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:34:46.635 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:34:46.635 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:34:46.636 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:34:46.646 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:34:46.647 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:34:46.647 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:34:46.670 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:35:13.573 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:35:13.573 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:35:13.581 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:35:13.925 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:35:13.926 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:35:13.935 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:35:13.955 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:35:13.955 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:35:13.964 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:35:15.092 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:35:15.092 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:35:15.092 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:35:15.092 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:35:15.101 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:35:15.101 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:35:15.102 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:35:15.102 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:35:15.112 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 6
2024-05-30 14:35:15.120 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:35:15.120 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:35:15.137 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:35:18.374 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:35:18.374 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:35:18.385 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:35:18.388 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:35:18.389 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 14:35:18.398 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 14:35:55.034 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:35:55.034 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:35:55.043 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:35:55.465 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:35:55.465 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:35:55.475 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:35:55.495 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:35:55.496 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:35:55.508 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:35:56.974 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:35:56.974 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:35:56.974 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:35:56.974 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:35:56.981 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:35:56.982 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:35:56.983 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:35:56.983 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:35:56.992 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 1
2024-05-30 14:35:56.999 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:35:56.999 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:35:57.018 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:35:59.012 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:35:59.013 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:35:59.023 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:35:59.033 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:35:59.033 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:35:59.043 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:35:59.044 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:35:59.044 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:35:59.054 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:35:59.055 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:35:59.055 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:35:59.065 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:35:59.065 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:35:59.066 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T14:35:59.065(LocalDateTime), 2024-05-30T14:35:59.065(LocalDateTime)
2024-05-30 14:35:59.084 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:35:59.085 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:35:59.086 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 2(Long), 2024-05-30T14:35:59.084(LocalDateTime), 1(Long)
2024-05-30 14:35:59.102 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:35:59.103 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:35:59.103 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:35:59.112 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:35:59.114 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:35:59.114 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:35:59.123 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:35:59.125 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:35:59.126 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:35:59.136 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:35:59.137 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:35:59.138 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:35:59.146 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:35:59.148 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:35:59.148 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:35:59.159 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:35:59.160 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:35:59.160 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:35:59.172 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:36:00.815 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:36:00.815 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:36:00.824 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:36:00.834 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:36:00.834 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:36:00.845 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:36:00.847 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:36:00.847 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:36:00.857 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:36:00.858 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:36:00.858 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:36:00.867 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:36:00.868 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:36:00.869 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T14:36:00.867(LocalDateTime), 2024-05-30T14:36:00.867(LocalDateTime)
2024-05-30 14:36:00.885 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:36:00.885 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:36:00.886 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 3(Long), 2024-05-30T14:36:00.885(LocalDateTime), 1(Long)
2024-05-30 14:36:00.903 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:36:00.903 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:36:00.904 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:36:00.913 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:36:00.915 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:36:00.916 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:36:00.924 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:36:00.925 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:36:00.925 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:36:00.935 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:36:00.937 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:36:00.937 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:36:00.944 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:36:00.945 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:36:00.945 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:36:00.955 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:36:00.956 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:36:00.956 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:36:00.965 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:36:01.523 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:36:01.524 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:36:01.532 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:36:01.544 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:36:01.544 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:36:01.554 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:36:01.556 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:36:01.556 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:36:01.564 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:36:01.566 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:36:01.566 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:36:01.731 ERROR 10704 --- [http-nio-8820-exec-6] c.alibaba.druid.filter.stat.StatFilter   : slow sql 164 millis. SELECT COUNT( * ) AS total FROM room_group__user 
 WHERE  deleted=0

AND (room_group_id = ? AND user_id = ?)[1,1]
2024-05-30 14:36:01.731 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:36:01.732 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:36:01.732 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T14:36:01.731(LocalDateTime), 2024-05-30T14:36:01.731(LocalDateTime)
2024-05-30 14:36:01.753 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:36:01.754 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:36:01.754 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 4(Long), 2024-05-30T14:36:01.753(LocalDateTime), 1(Long)
2024-05-30 14:36:01.774 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:36:01.774 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:36:01.775 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:36:01.793 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:36:01.794 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:36:01.794 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:36:01.808 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:36:01.809 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:36:01.809 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:36:01.821 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:36:01.822 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:36:01.822 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:36:01.831 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:36:01.832 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:36:01.833 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:36:01.846 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:36:01.847 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:36:01.848 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:36:01.862 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:36:02.362 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:36:02.362 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:36:02.390 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:36:02.403 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:36:02.403 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:36:02.414 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:36:02.415 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:36:02.415 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:36:02.436 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:36:02.437 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:36:02.437 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:36:02.453 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:36:02.454 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:36:02.454 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 4(String), 2024-05-30T14:36:02.453(LocalDateTime), 2024-05-30T14:36:02.453(LocalDateTime)
2024-05-30 14:36:02.476 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:36:02.477 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:36:02.477 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 5(Long), 2024-05-30T14:36:02.477(LocalDateTime), 1(Long)
2024-05-30 14:36:02.501 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:36:02.501 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:36:02.501 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:36:02.511 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:36:02.512 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:36:02.513 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:36:02.525 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:36:02.527 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:36:02.527 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:36:02.541 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:36:02.542 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:36:02.542 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:36:02.562 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:36:02.563 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:36:02.563 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:36:02.575 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:36:02.577 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:36:02.577 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:36:02.590 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:36:03.654 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:36:03.654 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:36:03.667 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:36:03.668 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:36:03.668 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 14:36:03.681 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 14:36:17.121 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:36:17.121 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:36:17.131 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:36:17.142 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:36:17.142 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:36:17.153 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:36:17.154 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:36:17.154 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:36:17.162 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:36:17.164 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:36:17.164 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:36:17.174 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:36:17.175 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:36:17.175 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 31(String), 2024-05-30T14:36:17.175(LocalDateTime), 2024-05-30T14:36:17.175(LocalDateTime)
2024-05-30 14:36:17.193 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:36:17.194 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:36:17.194 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 6(Long), 2024-05-30T14:36:17.194(LocalDateTime), 1(Long)
2024-05-30 14:36:17.211 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:36:17.212 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:36:17.212 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:36:17.221 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:36:17.221 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:36:17.221 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:36:17.233 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:36:17.234 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:36:17.234 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:36:17.244 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:36:17.246 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:36:17.246 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:36:17.255 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:36:17.256 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:36:17.256 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:36:17.264 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:36:17.265 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:36:17.266 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:36:17.274 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:37:13.443 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:37:13.443 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:13.453 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:37:13.812 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:37:13.812 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:13.841 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:37:13.864 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:37:13.865 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:37:13.878 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:37:14.965 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:37:14.965 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:14.972 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:37:14.972 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:14.973 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:37:14.982 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:37:14.984 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:37:14.984 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:37:14.990 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:37:14.990 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:37:14.992 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 1
2024-05-30 14:37:15.002 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:37:16.113 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:37:16.114 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:16.121 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:37:16.131 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:37:16.132 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:16.145 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:37:16.146 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:37:16.146 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:37:16.157 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:37:16.159 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:37:16.159 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:37:16.166 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:37:16.167 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:37:16.168 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T14:37:16.167(LocalDateTime), 2024-05-30T14:37:16.167(LocalDateTime)
2024-05-30 14:37:16.183 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:37:16.183 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:37:16.183 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 2(Long), 2024-05-30T14:37:16.183(LocalDateTime), 1(Long)
2024-05-30 14:37:16.202 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:37:16.202 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:37:16.202 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:16.209 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:37:16.210 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:37:16.211 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:37:16.218 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:37:16.219 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:37:16.220 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:37:16.227 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:37:16.229 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:37:16.229 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:37:16.238 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:37:16.239 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:37:16.239 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:37:16.250 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:37:16.251 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:37:16.252 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:37:16.261 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:37:19.158 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:37:19.158 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:19.168 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:37:19.180 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:37:19.180 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:19.190 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:37:19.191 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:37:19.191 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:37:19.200 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:37:19.201 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:37:19.201 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:37:19.211 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:37:19.212 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:37:19.212 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T14:37:19.211(LocalDateTime), 2024-05-30T14:37:19.211(LocalDateTime)
2024-05-30 14:37:19.230 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:37:19.231 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:37:19.231 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 3(Long), 2024-05-30T14:37:19.230(LocalDateTime), 1(Long)
2024-05-30 14:37:19.249 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:37:19.250 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:37:19.250 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:19.258 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:37:19.259 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:37:19.259 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:37:19.268 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:37:19.269 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:37:19.269 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:37:19.277 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:37:19.278 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:37:19.279 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:37:19.289 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:37:19.290 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:37:19.290 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:37:19.303 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:37:19.304 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:37:19.304 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:37:19.315 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:37:20.072 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:37:20.072 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:20.082 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:37:20.092 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:37:20.092 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:20.102 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:37:20.103 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:37:20.103 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:37:20.118 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:37:20.119 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:37:20.119 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:37:20.128 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:37:20.129 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:37:20.129 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T14:37:20.129(LocalDateTime), 2024-05-30T14:37:20.129(LocalDateTime)
2024-05-30 14:37:20.152 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:37:20.153 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:37:20.153 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 4(Long), 2024-05-30T14:37:20.152(LocalDateTime), 1(Long)
2024-05-30 14:37:20.174 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:37:20.175 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:37:20.175 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:20.184 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:37:20.185 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:37:20.185 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:37:20.193 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:37:20.194 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:37:20.194 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:37:20.202 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:37:20.203 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:37:20.204 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:37:20.220 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:37:20.221 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:37:20.221 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:37:20.233 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:37:20.234 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:37:20.234 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:37:20.245 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:37:20.927 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:37:20.927 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:20.936 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:37:20.945 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:37:20.945 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:20.952 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:37:20.953 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:37:20.954 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:37:20.963 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:37:20.964 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:37:20.964 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:37:20.972 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:37:20.972 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:37:20.972 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 4(String), 2024-05-30T14:37:20.972(LocalDateTime), 2024-05-30T14:37:20.972(LocalDateTime)
2024-05-30 14:37:20.993 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:37:20.994 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:37:20.994 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 5(Long), 2024-05-30T14:37:20.994(LocalDateTime), 1(Long)
2024-05-30 14:37:21.011 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:37:21.012 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:37:21.012 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:21.021 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:37:21.023 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:37:21.023 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:37:21.033 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:37:21.034 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:37:21.034 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:37:21.042 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:37:21.043 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:37:21.043 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:37:21.053 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:37:21.054 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:37:21.054 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:37:21.066 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:37:21.067 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:37:21.068 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:37:21.076 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:37:22.133 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:37:22.133 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:22.142 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:37:22.144 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:37:22.145 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 14:37:22.154 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 14:37:42.473 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:37:42.473 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:42.482 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:37:42.490 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:37:42.490 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:42.499 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:37:42.500 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:37:42.500 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:37:42.509 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:37:42.511 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:37:42.511 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:37:42.521 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:37:42.522 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:37:42.522 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T14:37:42.522(LocalDateTime), 2024-05-30T14:37:42.522(LocalDateTime)
2024-05-30 14:37:42.541 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:37:42.542 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:37:42.543 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 6(Long), 2024-05-30T14:37:42.542(LocalDateTime), 1(Long)
2024-05-30 14:37:42.560 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:37:42.561 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:37:42.561 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:37:42.572 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:37:42.573 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:37:42.573 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:37:42.590 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:37:42.592 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:37:42.592 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:37:42.601 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:37:42.602 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:37:42.602 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:37:42.611 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:37:42.612 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:37:42.612 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:37:42.623 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:37:42.624 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:37:42.624 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:37:42.634 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:38:00.295 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:38:00.295 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:00.305 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:38:00.317 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:38:00.318 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:00.330 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:38:00.332 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:38:00.332 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:38:00.367 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:38:00.368 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:38:00.369 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:38:00.470 ERROR 10704 --- [http-nio-8820-exec-23] c.alibaba.druid.filter.stat.StatFilter   : slow sql 101 millis. SELECT COUNT( * ) AS total FROM room_group__user 
 WHERE  deleted=0

AND (room_group_id = ? AND user_id = ?)[1,1]
2024-05-30 14:38:00.470 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:38:00.471 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:38:00.471 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T14:38:00.470(LocalDateTime), 2024-05-30T14:38:00.470(LocalDateTime)
2024-05-30 14:38:00.590 ERROR 10704 --- [http-nio-8820-exec-23] c.alibaba.druid.filter.stat.StatFilter   : slow sql 118 millis. INSERT INTO message  ( user_id,
room_id,
type,
text,




created_at,
updated_at )  VALUES  ( ?,
?,
?,
?,




?,
? )[1,1,0,"1","<java.time.LocalDateTime>","<java.time.LocalDateTime>"]
2024-05-30 14:38:00.590 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:38:00.591 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:38:00.591 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 2(Long), 2024-05-30T14:38:00.590(LocalDateTime), 1(Long)
2024-05-30 14:38:00.646 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:38:00.647 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:38:00.647 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:00.680 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:38:00.681 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:38:00.681 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:38:00.730 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:38:00.732 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:38:00.732 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:38:00.744 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:38:00.746 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:38:00.746 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:38:00.778 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:38:00.779 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:38:00.779 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:38:00.825 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:38:00.826 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:38:00.827 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:38:00.838 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:38:03.267 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:38:03.268 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:03.274 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:38:03.606 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:38:03.606 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:03.617 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:38:03.635 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:38:03.635 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:38:03.645 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:38:05.257 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:38:05.258 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:38:05.258 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:05.258 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:05.267 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:38:05.268 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:38:05.269 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:38:05.269 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:38:05.277 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 2
2024-05-30 14:38:05.284 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:38:05.284 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:38:05.296 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:38:06.597 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:38:06.598 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:06.604 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:38:06.624 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:38:06.625 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:06.631 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:38:06.633 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:38:06.633 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:38:06.644 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:38:06.645 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:38:06.645 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:38:06.653 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:38:06.654 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:38:06.654 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T14:38:06.654(LocalDateTime), 2024-05-30T14:38:06.654(LocalDateTime)
2024-05-30 14:38:06.670 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:38:06.671 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:38:06.671 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 3(Long), 2024-05-30T14:38:06.671(LocalDateTime), 1(Long)
2024-05-30 14:38:06.686 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:38:06.686 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:38:06.686 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:06.693 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:38:06.695 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:38:06.695 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:38:06.702 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:38:06.703 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:38:06.703 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:38:06.713 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:38:06.714 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:38:06.714 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:38:06.723 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:38:06.723 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:38:06.724 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:38:06.734 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:38:06.735 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:38:06.735 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:38:06.746 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:38:08.758 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:38:08.758 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:08.769 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:38:08.779 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:38:08.779 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:08.789 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:38:08.790 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:38:08.790 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:38:08.800 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:38:08.801 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:38:08.802 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:38:08.809 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:38:08.810 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:38:08.810 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 4(String), 2024-05-30T14:38:08.810(LocalDateTime), 2024-05-30T14:38:08.810(LocalDateTime)
2024-05-30 14:38:08.827 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:38:08.828 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:38:08.828 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 4(Long), 2024-05-30T14:38:08.827(LocalDateTime), 1(Long)
2024-05-30 14:38:08.842 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:38:08.843 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:38:08.843 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:08.851 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:38:08.852 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:38:08.852 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:38:08.861 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:38:08.862 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:38:08.862 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:38:08.871 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:38:08.872 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:38:08.872 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:38:08.880 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:38:08.881 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:38:08.881 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:38:08.892 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:38:08.894 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:38:08.894 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:38:08.904 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:38:09.438 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:38:09.438 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:09.448 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:38:09.458 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:38:09.458 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:09.468 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:38:09.469 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:38:09.469 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:38:09.477 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:38:09.479 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:38:09.479 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:38:09.488 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:38:09.488 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:38:09.489 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 5(String), 2024-05-30T14:38:09.488(LocalDateTime), 2024-05-30T14:38:09.488(LocalDateTime)
2024-05-30 14:38:09.505 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:38:09.505 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:38:09.506 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 5(Long), 2024-05-30T14:38:09.505(LocalDateTime), 1(Long)
2024-05-30 14:38:09.522 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:38:09.522 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:38:09.522 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:09.533 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:38:09.535 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:38:09.535 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:38:09.545 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:38:09.546 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:38:09.546 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:38:09.555 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:38:09.556 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:38:09.556 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:38:09.564 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:38:09.564 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:38:09.565 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:38:09.579 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:38:09.581 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:38:09.581 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:38:09.590 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:38:10.462 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:38:10.462 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:10.471 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:38:10.482 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:38:10.482 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:10.490 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:38:10.492 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:38:10.492 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:38:10.500 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:38:10.502 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:38:10.503 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:38:10.512 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:38:10.513 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:38:10.513 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 6(String), 2024-05-30T14:38:10.512(LocalDateTime), 2024-05-30T14:38:10.512(LocalDateTime)
2024-05-30 14:38:10.529 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:38:10.529 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:38:10.530 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 6(Long), 2024-05-30T14:38:10.529(LocalDateTime), 1(Long)
2024-05-30 14:38:10.542 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:38:10.543 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:38:10.543 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:10.550 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:38:10.552 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:38:10.552 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:38:10.560 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:38:10.562 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:38:10.562 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:38:10.571 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:38:10.572 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:38:10.572 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:38:10.587 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:38:10.588 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:38:10.589 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:38:10.601 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:38:10.602 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:38:10.603 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:38:10.615 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:38:11.666 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:38:11.666 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:38:11.674 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:38:11.676 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:38:11.676 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 14:38:11.685 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 14:39:57.337 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:39:57.337 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:39:57.348 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:39:57.908 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:39:57.919 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:39:57.927 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:39:57.943 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:39:57.944 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:39:58.219 ERROR 10704 --- [http-nio-8820-exec-4] c.alibaba.druid.filter.stat.StatFilter   : slow sql 275 millis. SELECT c.id, c.room_id, c.user_id,
               m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage,
               m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt,
               mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex,
               rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar,
               f.id AS friendId, f.remark,
               u.id AS userId, u.nickname, u.avatar, u.sex, u.online
        FROM conversation AS c
                 LEFT JOIN room AS r ON r.id = c.room_id
                 LEFT JOIN message AS m ON m.id = r.last_message_id
                 LEFT JOIN user AS mu ON mu.id = m.user_id
                 LEFT JOIN room_group AS rg ON rg.room_id = c.room_id
                 LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id
                 LEFT JOIN user AS u
                           ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id)
                               OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id)
                 LEFT JOIN friend AS f
                           ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id
        WHERE c.deleted = 0
     
            AND c.user_id = ?
        ORDER BY m.created_at DESC[1]
2024-05-30 14:39:58.220 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:39:59.782 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:39:59.782 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:39:59.782 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:39:59.787 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:39:59.796 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:39:59.797 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:39:59.798 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:39:59.798 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:39:59.805 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 6
2024-05-30 14:39:59.813 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:39:59.813 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:40:00.691 ERROR 10704 --- [http-nio-8820-exec-5] c.alibaba.druid.filter.stat.StatFilter   : slow sql 878 millis. SELECT  id,url,content,type,created_at,updated_at,deleted  FROM expression 
 WHERE  deleted=0[]
2024-05-30 14:40:00.694 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:40:02.300 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:40:02.300 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:02.552 ERROR 10704 --- [http-nio-8820-exec-8] c.alibaba.druid.filter.stat.StatFilter   : slow sql 251 millis. SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=?  AND deleted=0[1]
2024-05-30 14:40:02.553 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:40:02.554 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:40:02.554 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 14:40:02.562 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 14:40:06.119 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:40:06.119 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:06.126 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:40:06.137 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:40:06.138 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:06.145 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:40:06.147 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:40:06.147 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:40:06.157 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:40:06.159 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:40:06.159 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:40:06.167 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:40:06.167 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:40:06.167 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T14:40:06.167(LocalDateTime), 2024-05-30T14:40:06.167(LocalDateTime)
2024-05-30 14:40:06.185 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:40:06.186 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:40:06.186 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 7(Long), 2024-05-30T14:40:06.186(LocalDateTime), 1(Long)
2024-05-30 14:40:06.201 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:40:06.202 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:40:06.202 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:06.211 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:40:06.212 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:40:06.212 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:40:06.222 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:40:06.223 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:40:06.223 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:40:06.230 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:40:06.232 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:40:06.232 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:40:06.239 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:40:06.239 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:40:06.240 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:40:06.251 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:40:06.252 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:40:06.252 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:40:06.263 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:40:07.005 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:40:07.005 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:07.014 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:40:07.023 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:40:07.023 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:07.031 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:40:07.033 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:40:07.033 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:40:07.040 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:40:07.041 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:40:07.041 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:40:07.050 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:40:07.050 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:40:07.051 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 13(String), 2024-05-30T14:40:07.050(LocalDateTime), 2024-05-30T14:40:07.050(LocalDateTime)
2024-05-30 14:40:07.067 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:40:07.067 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:40:07.067 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 8(Long), 2024-05-30T14:40:07.067(LocalDateTime), 1(Long)
2024-05-30 14:40:07.083 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:40:07.084 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:40:07.084 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:07.092 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:40:07.094 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:40:07.094 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:40:07.103 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:40:07.104 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:40:07.105 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:40:07.112 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:40:07.113 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:40:07.113 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:40:07.122 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:40:07.122 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:40:07.123 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:40:07.132 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:40:07.133 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:40:07.133 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:40:07.142 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:40:07.623 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:40:07.623 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:07.632 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:40:07.640 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:40:07.640 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:07.647 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:40:07.648 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:40:07.648 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:40:07.654 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:40:07.655 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:40:07.655 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:40:07.662 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:40:07.662 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:40:07.662 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 4(String), 2024-05-30T14:40:07.662(LocalDateTime), 2024-05-30T14:40:07.662(LocalDateTime)
2024-05-30 14:40:07.673 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:40:07.676 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:40:07.676 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 9(Long), 2024-05-30T14:40:07.675(LocalDateTime), 1(Long)
2024-05-30 14:40:07.693 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:40:07.693 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:40:07.693 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:07.701 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:40:07.702 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:40:07.702 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:40:07.711 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:40:07.713 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:40:07.713 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:40:07.719 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:40:07.721 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:40:07.721 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:40:07.732 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:40:07.733 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:40:07.733 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:40:07.774 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:40:07.775 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:40:07.776 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:40:07.785 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:40:08.126 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:40:08.126 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:08.140 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:40:08.156 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:40:08.156 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:08.168 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:40:08.170 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:40:08.171 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:40:08.185 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:40:08.187 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:40:08.187 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:40:08.199 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:40:08.200 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:40:08.200 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 12(String), 2024-05-30T14:40:08.199(LocalDateTime), 2024-05-30T14:40:08.199(LocalDateTime)
2024-05-30 14:40:08.225 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:40:08.226 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:40:08.227 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 10(Long), 2024-05-30T14:40:08.226(LocalDateTime), 1(Long)
2024-05-30 14:40:08.247 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:40:08.247 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:40:08.247 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:08.264 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:40:08.266 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:40:08.266 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:40:08.276 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:40:08.278 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:40:08.278 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:40:08.286 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:40:08.287 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:40:08.288 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:40:08.294 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:40:08.295 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:40:08.296 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:40:08.307 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:40:08.308 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:40:08.308 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:40:08.318 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:40:18.277 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:40:18.277 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:18.286 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:40:18.624 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:40:18.624 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:18.634 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:40:18.649 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:40:18.650 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:40:18.661 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:40:20.599 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:40:20.599 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:40:20.599 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:20.599 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:20.607 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:40:20.610 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:40:20.610 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:40:20.611 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:40:20.620 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 10
2024-05-30 14:40:20.630 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:40:20.630 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:40:20.656 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:40:27.346 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:40:27.346 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:27.358 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:40:27.653 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:40:27.653 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:27.662 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:40:27.680 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:40:27.681 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:40:27.694 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:40:28.543 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:40:28.543 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:40:28.543 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:28.543 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:28.552 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:40:28.554 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:40:28.554 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:40:28.555 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:40:28.563 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 1
2024-05-30 14:40:28.573 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:40:28.573 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:40:28.601 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:40:35.611 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:40:35.611 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:35.622 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:40:35.633 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:40:35.633 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:35.643 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:40:35.644 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:40:35.644 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:40:35.655 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:40:35.657 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:40:35.657 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:40:35.676 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:40:35.677 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:40:35.677 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T14:40:35.677(LocalDateTime), 2024-05-30T14:40:35.677(LocalDateTime)
2024-05-30 14:40:35.695 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:40:35.696 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:40:35.697 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 2(Long), 2024-05-30T14:40:35.696(LocalDateTime), 1(Long)
2024-05-30 14:40:35.713 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:40:35.714 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:40:35.714 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:35.724 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:40:35.725 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:40:35.725 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:40:35.734 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:40:35.736 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:40:35.736 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:40:35.744 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:40:35.745 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:40:35.745 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:40:35.754 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:40:35.754 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:40:35.755 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:40:35.765 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:40:35.766 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:40:35.767 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:40:35.778 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:40:36.529 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:40:36.529 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:36.537 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:40:36.545 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:40:36.545 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:36.554 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:40:36.555 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:40:36.555 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:40:36.565 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:40:36.566 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:40:36.566 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:40:36.576 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:40:36.576 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:40:36.577 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T14:40:36.576(LocalDateTime), 2024-05-30T14:40:36.576(LocalDateTime)
2024-05-30 14:40:36.592 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:40:36.592 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:40:36.593 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 3(Long), 2024-05-30T14:40:36.592(LocalDateTime), 1(Long)
2024-05-30 14:40:36.611 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:40:36.611 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:40:36.611 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:36.620 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:40:36.621 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:40:36.621 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:40:36.629 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:40:36.631 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:40:36.631 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:40:36.641 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:40:36.643 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:40:36.643 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:40:36.651 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:40:36.652 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:40:36.652 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:40:36.663 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:40:36.665 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:40:36.665 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:40:36.677 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:40:37.841 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:40:37.842 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:37.852 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:40:37.864 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:40:37.864 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:37.873 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:40:37.874 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:40:37.874 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:40:37.883 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:40:37.884 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:40:37.884 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:40:37.895 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:40:37.896 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:40:37.896 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 4(String), 2024-05-30T14:40:37.895(LocalDateTime), 2024-05-30T14:40:37.895(LocalDateTime)
2024-05-30 14:40:37.914 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:40:37.914 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:40:37.915 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 4(Long), 2024-05-30T14:40:37.914(LocalDateTime), 1(Long)
2024-05-30 14:40:37.932 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:40:37.932 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:40:37.932 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:37.942 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:40:37.943 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:40:37.943 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:40:37.952 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:40:37.953 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:40:37.953 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:40:37.963 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:40:37.965 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:40:37.965 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:40:37.975 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:40:37.976 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:40:37.977 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:40:37.986 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:40:37.987 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:40:37.987 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:40:37.996 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:40:53.456 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:40:53.457 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:40:53.465 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:40:53.468 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:40:53.468 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 14:40:53.477 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 14:41:18.784 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:41:18.785 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:41:18.793 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:41:19.133 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:41:19.133 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:41:19.146 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:41:19.168 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:41:19.169 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:41:19.180 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:41:20.097 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:41:20.097 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:41:20.098 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:41:20.098 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:41:20.107 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:41:20.108 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:41:20.108 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:41:20.119 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 4
2024-05-30 14:41:20.143 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:41:20.161 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:41:20.162 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:41:20.520 ERROR 10704 --- [http-nio-8820-exec-26] c.alibaba.druid.filter.stat.StatFilter   : slow sql 358 millis. SELECT  id,url,content,type,created_at,updated_at,deleted  FROM expression 
 WHERE  deleted=0[]
2024-05-30 14:41:20.524 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:41:22.582 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:41:22.582 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:41:22.591 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:41:22.593 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:41:22.593 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 14:41:22.603 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 14:41:28.404 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:41:28.404 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:41:28.412 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:41:28.731 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:41:28.731 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:41:28.742 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:41:28.760 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:41:28.760 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:41:28.773 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:41:29.752 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:41:29.752 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:41:29.752 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:41:29.752 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:41:29.760 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:41:29.761 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:41:29.762 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:41:29.762 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:41:29.771 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 1
2024-05-30 14:41:29.777 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:41:29.777 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:41:29.875 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:42:02.211 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:02.211 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:02.218 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:02.230 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:42:02.230 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:02.239 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:42:02.240 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:42:02.240 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:42:02.248 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:42:02.250 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:42:02.250 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:42:02.257 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:42:02.258 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:42:02.258 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T14:42:02.257(LocalDateTime), 2024-05-30T14:42:02.257(LocalDateTime)
2024-05-30 14:42:02.274 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:42:02.275 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:42:02.275 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 2(Long), 2024-05-30T14:42:02.274(LocalDateTime), 1(Long)
2024-05-30 14:42:02.289 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:42:02.290 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:42:02.290 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:02.297 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:42:02.298 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:42:02.298 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:42:02.306 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:42:02.308 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:42:02.308 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:42:02.317 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:42:02.318 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:42:02.318 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:42:02.327 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:42:02.328 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:42:02.329 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:42:02.338 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:42:02.339 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:42:02.340 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:42:02.351 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:42:03.610 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:03.611 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:03.621 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:03.630 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:42:03.630 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:03.638 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:42:03.639 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:42:03.639 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:42:03.648 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:42:03.649 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:42:03.650 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:42:03.658 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:42:03.658 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:42:03.658 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T14:42:03.658(LocalDateTime), 2024-05-30T14:42:03.658(LocalDateTime)
2024-05-30 14:42:03.674 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:42:03.675 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:42:03.675 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 3(Long), 2024-05-30T14:42:03.674(LocalDateTime), 1(Long)
2024-05-30 14:42:03.692 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:42:03.693 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:42:03.693 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:03.702 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:42:03.703 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:42:03.704 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:42:03.711 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:42:03.713 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:42:03.713 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:42:03.722 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:42:03.723 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:42:03.723 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:42:03.730 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:42:03.730 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:42:03.731 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:42:03.739 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:42:03.740 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:42:03.740 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:42:03.749 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:42:04.690 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:04.691 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:04.700 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:04.709 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:42:04.710 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:04.718 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:42:04.719 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:42:04.719 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:42:04.728 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:42:04.730 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:42:04.730 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:42:04.737 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:42:04.738 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:42:04.738 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T14:42:04.738(LocalDateTime), 2024-05-30T14:42:04.738(LocalDateTime)
2024-05-30 14:42:04.756 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:42:04.757 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:42:04.757 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 4(Long), 2024-05-30T14:42:04.757(LocalDateTime), 1(Long)
2024-05-30 14:42:04.775 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:42:04.776 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:42:04.776 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:04.784 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:42:04.785 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:42:04.785 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:42:04.793 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:42:04.795 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:42:04.795 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:42:04.805 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:42:04.806 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:42:04.806 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:42:04.814 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:42:04.815 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:42:04.815 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:42:04.824 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:42:04.825 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:42:04.825 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:42:04.836 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:42:14.686 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:14.687 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:14.709 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:15.251 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:15.252 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:15.261 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:15.280 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:42:15.281 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:42:15.292 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:42:17.155 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:17.156 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:17.156 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:17.156 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:17.165 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:17.167 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:17.168 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:42:17.168 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:42:17.183 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 4
2024-05-30 14:42:17.183 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:42:17.184 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:42:17.213 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:42:19.257 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:19.257 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:19.267 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:19.278 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:42:19.278 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:19.288 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:42:19.290 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:42:19.290 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:42:19.299 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:42:19.300 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:42:19.300 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:42:19.309 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:42:19.310 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:42:19.311 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T14:42:19.310(LocalDateTime), 2024-05-30T14:42:19.310(LocalDateTime)
2024-05-30 14:42:19.326 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:42:19.327 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:42:19.327 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 5(Long), 2024-05-30T14:42:19.327(LocalDateTime), 1(Long)
2024-05-30 14:42:19.344 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:42:19.345 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:42:19.345 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:19.356 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:42:19.357 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:42:19.357 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:42:19.368 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:42:19.369 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:42:19.370 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:42:19.378 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:42:19.380 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:42:19.380 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:42:19.388 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:42:19.389 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:42:19.389 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:42:19.398 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:42:19.398 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:42:19.399 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:42:19.408 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:42:20.529 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:20.529 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:20.538 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:20.547 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:42:20.548 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:20.558 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:42:20.585 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:42:20.586 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:42:20.595 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:42:20.596 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:42:20.596 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:42:20.606 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:42:20.607 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:42:20.607 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T14:42:20.607(LocalDateTime), 2024-05-30T14:42:20.607(LocalDateTime)
2024-05-30 14:42:20.624 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:42:20.624 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:42:20.625 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 6(Long), 2024-05-30T14:42:20.624(LocalDateTime), 1(Long)
2024-05-30 14:42:20.641 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:42:20.642 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:42:20.642 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:20.651 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:42:20.652 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:42:20.652 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:42:20.661 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:42:20.661 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:42:20.661 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:42:20.670 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:42:20.671 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:42:20.671 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:42:20.682 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:42:20.683 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:42:20.684 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:42:20.695 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:42:20.696 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:42:20.696 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:42:20.706 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:42:22.345 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:22.345 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:22.354 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:22.364 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:42:22.364 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:22.375 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:42:22.377 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:42:22.377 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:42:22.389 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:42:22.390 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:42:22.390 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:42:22.401 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:42:22.401 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:42:22.402 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 4(String), 2024-05-30T14:42:22.401(LocalDateTime), 2024-05-30T14:42:22.401(LocalDateTime)
2024-05-30 14:42:22.418 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:42:22.419 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:42:22.419 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 7(Long), 2024-05-30T14:42:22.419(LocalDateTime), 1(Long)
2024-05-30 14:42:22.437 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:42:22.437 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:42:22.437 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:22.447 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:42:22.448 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:42:22.448 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:42:22.459 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:42:22.460 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:42:22.460 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:42:22.469 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:42:22.469 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:42:22.469 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:42:22.480 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:42:22.481 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:42:22.482 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:42:22.494 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:42:22.495 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:42:22.496 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:42:22.507 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:42:25.930 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:25.930 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:25.938 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:26.278 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:26.278 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:26.287 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:26.306 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:42:26.306 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:42:26.316 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:42:28.553 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:28.553 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:28.554 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:28.554 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:28.564 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:28.565 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:28.565 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:42:28.566 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:42:28.575 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 7
2024-05-30 14:42:28.582 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:42:28.582 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:42:28.602 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:42:29.333 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:29.333 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:29.341 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:29.351 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:42:29.351 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:29.361 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:42:29.362 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 14:42:29.363 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:42:29.371 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:42:29.373 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 14:42:29.373 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:42:29.380 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 14:42:29.380 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 14:42:29.380 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T14:42:29.380(LocalDateTime), 2024-05-30T14:42:29.380(LocalDateTime)
2024-05-30 14:42:29.396 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 14:42:29.397 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 14:42:29.397 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 8(Long), 2024-05-30T14:42:29.396(LocalDateTime), 1(Long)
2024-05-30 14:42:29.410 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 14:42:29.411 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 14:42:29.411 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:29.418 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 14:42:29.419 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 14:42:29.419 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 14:42:29.427 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 14:42:29.428 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 14:42:29.428 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 14:42:29.437 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 14:42:29.438 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 14:42:29.438 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 14:42:29.445 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 14:42:29.446 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 14:42:29.446 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 14:42:29.458 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 14:42:29.459 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 14:42:29.459 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 14:42:29.467 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 14:42:37.374 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:37.374 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:37.382 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:37.395 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:42:37.395 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 14:42:37.406 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 14:42:45.575 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:45.575 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:45.584 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:45.913 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:45.913 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:45.921 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:45.938 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 14:42:45.938 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 14:42:45.950 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 14:42:47.127 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:47.127 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:42:47.127 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:47.127 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:42:47.135 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:47.143 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:42:47.144 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 14:42:47.145 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 14:42:47.150 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 14:42:47.150 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 14:42:47.154 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 1
2024-05-30 14:42:47.161 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 14:59:01.509 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 14:59:01.511 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 14:59:01.526 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 14:59:01.640 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 14:59:01.645 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 14:59:01.661 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:00:34.176 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:00:34.177 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:00:34.186 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:00:34.468 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:00:34.469 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:00:34.478 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:00:34.496 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:00:34.496 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:00:34.507 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:01:37.942 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:01:37.943 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:01:37.953 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:01:37.975 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:01:37.976 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:01:37.986 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:02:47.614 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:02:47.615 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:02:47.626 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:02:47.643 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:02:47.643 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:02:47.653 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:03:49.205 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:03:49.206 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:03:49.215 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:03:49.234 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:03:49.235 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:03:49.243 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:04:42.127 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:04:42.127 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:04:42.136 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:04:42.157 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:04:42.157 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:04:42.196 DEBUG 10704 --- [http-nio-8820-exec-28] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:04:44.991 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:04:44.992 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:04:45.001 DEBUG 10704 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:04:45.299 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:04:45.299 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:04:45.309 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:04:45.327 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:04:45.327 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:04:45.336 DEBUG 10704 --- [http-nio-8820-exec-29] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:05:43.143 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:05:43.143 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:05:43.152 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:05:43.170 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 15:05:43.173 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 15:05:43.184 DEBUG 10704 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 15:05:43.703 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:05:43.703 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:05:43.706 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:05:43.706 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:05:43.712 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:05:43.713 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:05:43.733 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 15:05:43.733 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 15:05:43.736 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:05:43.736 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 15:05:43.743 DEBUG 10704 --- [http-nio-8820-exec-4] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 15:05:43.744 DEBUG 10704 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 1
2024-05-30 15:08:59.433 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:08:59.435 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:08:59.445 DEBUG 10704 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:09:00.021 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:09:00.022 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:09:00.030 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:09:00.049 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 15:09:00.050 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 15:09:00.060 DEBUG 10704 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 15:09:09.693 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:09:09.693 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:09:09.701 DEBUG 10704 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:09:09.977 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:09:09.978 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:09:09.987 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:09:10.005 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 15:09:10.005 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 15:09:10.018 DEBUG 10704 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 15:09:11.335 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:09:11.335 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:09:11.335 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:09:11.336 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:09:11.342 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:09:11.343 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:09:11.345 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:09:11.345 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 15:09:11.353 DEBUG 10704 --- [http-nio-8820-exec-6] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 1
2024-05-30 15:09:11.360 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 15:09:11.360 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 15:09:11.373 DEBUG 10704 --- [http-nio-8820-exec-10] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 15:09:15.880 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:09:15.880 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:09:15.889 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:09:15.933 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 15:09:15.933 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:09:15.943 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 15:09:15.959 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 15:09:15.959 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 15:09:15.968 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 15:09:15.970 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 15:09:15.972 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 15:09:15.981 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 15:09:15.987 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 15:09:15.993 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T15:09:15.986(LocalDateTime), 2024-05-30T15:09:15.986(LocalDateTime)
2024-05-30 15:09:16.009 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 15:09:16.014 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 15:09:16.015 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 2(Long), 2024-05-30T15:09:16.013(LocalDateTime), 1(Long)
2024-05-30 15:09:16.032 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 15:09:16.033 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 15:09:16.033 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:09:16.042 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 15:09:16.043 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 15:09:16.044 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 15:09:16.053 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 15:09:16.055 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 15:09:16.055 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 15:09:16.063 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 15:09:16.067 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 15:09:16.067 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 15:09:16.077 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 15:09:16.079 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 15:09:16.080 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 15:09:16.091 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 15:09:16.095 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 15:09:16.095 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 15:09:16.106 DEBUG 10704 --- [http-nio-8820-exec-9] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 15:09:29.264 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:09:29.264 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:09:29.273 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:09:29.292 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:09:29.292 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:09:29.302 DEBUG 10704 --- [http-nio-8820-exec-12] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:11:08.489 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:11:08.489 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:11:08.498 DEBUG 10704 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:11:08.797 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:11:08.798 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:11:08.808 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:11:08.828 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:11:08.828 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:11:08.840 DEBUG 10704 --- [http-nio-8820-exec-13] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:11:20.105 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:11:20.105 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:11:20.115 DEBUG 10704 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:11:20.354 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:11:20.354 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:11:20.364 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:11:20.382 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:11:20.383 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:11:20.393 DEBUG 10704 --- [http-nio-8820-exec-15] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:11:33.198 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:11:33.198 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:11:33.209 DEBUG 10704 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:12:06.711 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:12:06.711 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:12:06.728 DEBUG 10704 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:12:07.017 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:12:07.017 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:12:07.025 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:12:07.044 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:12:07.044 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:12:07.052 DEBUG 10704 --- [http-nio-8820-exec-19] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:12:28.342 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:12:28.343 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:12:28.353 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:12:28.368 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:12:28.369 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:12:28.379 DEBUG 10704 --- [http-nio-8820-exec-20] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:12:30.250 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:12:30.251 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:12:30.265 DEBUG 10704 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:12:30.518 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:12:30.519 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:12:30.528 DEBUG 10704 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:12:30.616 ERROR 10704 --- [http-nio-8820-exec-21] com.slipper.handler.RunExceptionHandler  : 操作太频繁,请稍后重试！

com.slipper.exception.RunException: 操作太频繁,请稍后重试！
	at com.slipper.core.repeat.aspect.RepeatAspect.around(RepeatAspect.java:64)
	at sun.reflect.GeneratedMethodAccessor103.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.grouping.controller.GroupingController$$EnhancerBySpringCGLIB$$8373b803.queryGroupingFriend(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:529)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 15:12:32.887 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:12:32.887 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:12:32.895 DEBUG 10704 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:12:33.126 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:12:33.126 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:12:33.137 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:12:33.157 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:12:33.157 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:12:33.173 DEBUG 10704 --- [http-nio-8820-exec-22] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:13:20.748 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:13:20.749 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:13:20.760 DEBUG 10704 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:13:20.971 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:13:20.972 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:13:20.982 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:13:20.999 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:13:21.000 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:13:21.009 DEBUG 10704 --- [http-nio-8820-exec-25] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:13:24.441 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:13:24.441 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:13:24.449 DEBUG 10704 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:13:24.691 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:13:24.691 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:13:24.700 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:13:24.743 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:13:24.743 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:13:24.754 DEBUG 10704 --- [http-nio-8820-exec-27] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:16:21.679  INFO 10704 --- [SpringApplicationShutdownHook] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} closing ...
2024-05-30 15:16:21.696  INFO 10704 --- [SpringApplicationShutdownHook] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} closed
2024-05-30 15:16:27.727  INFO 12584 --- [main] com.slipper.SlipperApplication           : Starting SlipperApplication using Java 1.8.0_291 on SZ-PC-PDC-135 with PID 12584 (E:\github\chatterbox-pro\target\classes started by gumingchen in E:\github\chatterbox-pro)
2024-05-30 15:16:27.729 DEBUG 12584 --- [main] com.slipper.SlipperApplication           : Running with Spring Boot v2.7.18, Spring v5.3.31
2024-05-30 15:16:27.730  INFO 12584 --- [main] com.slipper.SlipperApplication           : The following 1 profile is active: "dev"
2024-05-30 15:16:28.585  INFO 12584 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2024-05-30 15:16:28.587  INFO 12584 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2024-05-30 15:16:28.651  INFO 12584 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 47 ms. Found 0 Redis repository interfaces.
2024-05-30 15:16:29.314  INFO 12584 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8820 (http)
2024-05-30 15:16:29.322  INFO 12584 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2024-05-30 15:16:29.322  INFO 12584 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.83]
2024-05-30 15:16:29.468  INFO 12584 --- [main] o.a.c.c.C.[.[localhost].[/chatterbox]    : Initializing Spring embedded WebApplicationContext
2024-05-30 15:16:29.468  INFO 12584 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1701 ms
2024-05-30 15:16:30.089  INFO 12584 --- [main] c.a.d.s.b.a.DruidDataSourceAutoConfigure : Init DruidDataSource
2024-05-30 15:16:30.635 ERROR 12584 --- [main] c.alibaba.druid.filter.stat.StatFilter   : slow sql 116 millis. SELECT 1[]
2024-05-30 15:16:31.515  INFO 12584 --- [main] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} inited
2024-05-30 15:16:32.261 DEBUG 12584 --- [main] c.s.c.s.f.TokenAuthenticationFilter      : Filter 'tokenAuthenticationFilter' configured for use
2024-05-30 15:16:32.939  INFO 12584 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@4e45fbd0, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@19ce19b7, org.springframework.security.web.context.SecurityContextPersistenceFilter@4a2653a0, org.springframework.security.web.header.HeaderWriterFilter@7cbe3a05, org.springframework.web.filter.CorsFilter@13047d3d, org.springframework.security.web.authentication.logout.LogoutFilter@56d5460f, com.slipper.core.security.filter.TokenAuthenticationFilter@3bdbf8d3, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@5ac646b3, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@24b38e8f, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@4b240276, org.springframework.security.web.session.SessionManagementFilter@50734cea, org.springframework.security.web.access.ExceptionTranslationFilter@120d13ae, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@2b19b346]
2024-05-30 15:16:33.280  INFO 12584 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8820 (http) with context path '/chatterbox'
2024-05-30 15:16:33.289  INFO 12584 --- [main] com.slipper.SlipperApplication           : Started SlipperApplication in 6.018 seconds (JVM running for 6.789)
2024-05-30 15:16:33.359  INFO 12584 --- [task-executor-1] com.slipper.core.netty.WebSocketServer   : 🤝[服务器启动端口]: 8821

2024-05-30 15:17:10.171  INFO 12584 --- [http-nio-8820-exec-1] o.a.c.c.C.[.[localhost].[/chatterbox]    : Initializing Spring DispatcherServlet 'dispatcherServlet'
2024-05-30 15:17:10.171  INFO 12584 --- [http-nio-8820-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2024-05-30 15:17:10.173  INFO 12584 --- [http-nio-8820-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
2024-05-30 15:17:10.822 DEBUG 12584 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:17:10.881 DEBUG 12584 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:17:10.903 DEBUG 12584 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:17:11.227 DEBUG 12584 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:17:11.229 DEBUG 12584 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:17:11.238 DEBUG 12584 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:17:11.289 DEBUG 12584 --- [http-nio-8820-exec-2] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.lastAt, u.createdAt FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:17:11.294 DEBUG 12584 --- [http-nio-8820-exec-2] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:17:11.352 ERROR 12584 --- [http-nio-8820-exec-2] com.slipper.handler.RunExceptionHandler  : 
### Error querying database.  Cause: java.sql.SQLSyntaxErrorException: Unknown column 'u.lastAt' in 'field list'
### The error may exist in file [E:\github\chatterbox-pro\target\classes\mapper\grouping\GroupingMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: SELECT g.id, g.name, g.fixed,                f.id AS friend_id, f.remark, f.friend_id AS user_id,                u.nickname, u.avatar, u.sex, u.online, u.email, u.lastAt, u.createdAt         FROM `grouping` AS g         LEFT JOIN friend AS f ON f.grouping_id = g.id         LEFT JOIN user AS u ON u.id = f.friend_id         WHERE g.deleted = 0 AND g.user_id = ?         ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
### Cause: java.sql.SQLSyntaxErrorException: Unknown column 'u.lastAt' in 'field list'
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Unknown column 'u.lastAt' in 'field list'

org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: java.sql.SQLSyntaxErrorException: Unknown column 'u.lastAt' in 'field list'
### The error may exist in file [E:\github\chatterbox-pro\target\classes\mapper\grouping\GroupingMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: SELECT g.id, g.name, g.fixed,                f.id AS friend_id, f.remark, f.friend_id AS user_id,                u.nickname, u.avatar, u.sex, u.online, u.email, u.lastAt, u.createdAt         FROM `grouping` AS g         LEFT JOIN friend AS f ON f.grouping_id = g.id         LEFT JOIN user AS u ON u.id = f.friend_id         WHERE g.deleted = 0 AND g.user_id = ?         ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
### Cause: java.sql.SQLSyntaxErrorException: Unknown column 'u.lastAt' in 'field list'
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Unknown column 'u.lastAt' in 'field list'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:236)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy96.selectList(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:224)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.executeForMany(MybatisMapperMethod.java:166)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:77)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:148)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89)
	at com.sun.proxy.$Proxy97.queryList(Unknown Source)
	at com.slipper.modules.grouping.service.impl.GroupingServiceImpl.queryList(GroupingServiceImpl.java:68)
	at com.slipper.modules.grouping.service.impl.GroupingServiceImpl$$FastClassBySpringCGLIB$$fe8b1983.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at com.slipper.modules.grouping.service.impl.GroupingServiceImpl$$EnhancerBySpringCGLIB$$ef989033.queryList(<generated>)
	at com.slipper.modules.grouping.controller.GroupingController.queryGroupingFriend(GroupingController.java:70)
	at com.slipper.modules.grouping.controller.GroupingController$$FastClassBySpringCGLIB$$333eca8b.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at com.slipper.core.repeat.aspect.RepeatAspect.around(RepeatAspect.java:69)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.grouping.controller.GroupingController$$EnhancerBySpringCGLIB$$b6bdc459.queryGroupingFriend(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:529)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLSyntaxErrorException: Unknown column 'u.lastAt' in 'field list'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.alibaba.druid.filter.FilterChainImpl.preparedStatement_execute(FilterChainImpl.java:3461)
	at com.alibaba.druid.wall.WallFilter.preparedStatement_execute(WallFilter.java:664)
	at com.alibaba.druid.filter.FilterChainImpl.preparedStatement_execute(FilterChainImpl.java:3459)
	at com.alibaba.druid.filter.FilterEventAdapter.preparedStatement_execute(FilterEventAdapter.java:440)
	at com.alibaba.druid.filter.FilterChainImpl.preparedStatement_execute(FilterChainImpl.java:3459)
	at com.alibaba.druid.proxy.jdbc.PreparedStatementProxyImpl.execute(PreparedStatementProxyImpl.java:167)
	at com.alibaba.druid.pool.DruidPooledPreparedStatement.execute(DruidPooledPreparedStatement.java:497)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:59)
	at com.sun.proxy.$Proxy155.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.query(PreparedStatementHandler.java:64)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:79)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:64)
	at com.sun.proxy.$Proxy153.query(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:63)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:325)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:156)
	at com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor.intercept(MybatisPlusInterceptor.java:81)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:62)
	at com.sun.proxy.$Proxy152.query(Unknown Source)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:151)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:145)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:140)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 139 common frames omitted

2024-05-30 15:17:38.959  INFO 12584 --- [SpringApplicationShutdownHook] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} closing ...
2024-05-30 15:17:38.965  INFO 12584 --- [SpringApplicationShutdownHook] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} closed
2024-05-30 15:17:41.822  INFO 20860 --- [main] com.slipper.SlipperApplication           : Starting SlipperApplication using Java 1.8.0_291 on SZ-PC-PDC-135 with PID 20860 (E:\github\chatterbox-pro\target\classes started by gumingchen in E:\github\chatterbox-pro)
2024-05-30 15:17:41.824 DEBUG 20860 --- [main] com.slipper.SlipperApplication           : Running with Spring Boot v2.7.18, Spring v5.3.31
2024-05-30 15:17:41.825  INFO 20860 --- [main] com.slipper.SlipperApplication           : The following 1 profile is active: "dev"
2024-05-30 15:17:42.474  INFO 20860 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2024-05-30 15:17:42.476  INFO 20860 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2024-05-30 15:17:42.533  INFO 20860 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 44 ms. Found 0 Redis repository interfaces.
2024-05-30 15:17:43.105  INFO 20860 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8820 (http)
2024-05-30 15:17:43.112  INFO 20860 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2024-05-30 15:17:43.112  INFO 20860 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.83]
2024-05-30 15:17:43.256  INFO 20860 --- [main] o.a.c.c.C.[.[localhost].[/chatterbox]    : Initializing Spring embedded WebApplicationContext
2024-05-30 15:17:43.256  INFO 20860 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1402 ms
2024-05-30 15:17:43.704  INFO 20860 --- [main] c.a.d.s.b.a.DruidDataSourceAutoConfigure : Init DruidDataSource
2024-05-30 15:17:44.179 ERROR 20860 --- [main] c.alibaba.druid.filter.stat.StatFilter   : slow sql 104 millis. SELECT 1[]
2024-05-30 15:17:45.111  INFO 20860 --- [main] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} inited
2024-05-30 15:17:45.805 DEBUG 20860 --- [main] c.s.c.s.f.TokenAuthenticationFilter      : Filter 'tokenAuthenticationFilter' configured for use
2024-05-30 15:17:46.438  INFO 20860 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@42db955e, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@6bd2f039, org.springframework.security.web.context.SecurityContextPersistenceFilter@60c4cf2b, org.springframework.security.web.header.HeaderWriterFilter@59014efe, org.springframework.web.filter.CorsFilter@6c8ad6d7, org.springframework.security.web.authentication.logout.LogoutFilter@4e6280de, com.slipper.core.security.filter.TokenAuthenticationFilter@4f4d05b3, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@303fbc4, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@4cd90c36, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@2d0778d0, org.springframework.security.web.session.SessionManagementFilter@5621a671, org.springframework.security.web.access.ExceptionTranslationFilter@17a77a7e, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@1760e688]
2024-05-30 15:17:46.746  INFO 20860 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8820 (http) with context path '/chatterbox'
2024-05-30 15:17:46.754  INFO 20860 --- [main] com.slipper.SlipperApplication           : Started SlipperApplication in 5.309 seconds (JVM running for 6.017)
2024-05-30 15:17:46.817  INFO 20860 --- [task-executor-1] com.slipper.core.netty.WebSocketServer   : 🤝[服务器启动端口]: 8821

2024-05-30 15:17:51.931  INFO 20860 --- [http-nio-8820-exec-2] o.a.c.c.C.[.[localhost].[/chatterbox]    : Initializing Spring DispatcherServlet 'dispatcherServlet'
2024-05-30 15:17:51.931  INFO 20860 --- [http-nio-8820-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2024-05-30 15:17:51.932  INFO 20860 --- [http-nio-8820-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2024-05-30 15:17:52.542 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:17:52.595 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:17:52.614 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:17:52.897 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:17:52.897 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:17:52.906 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:17:52.947 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:17:52.952 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:17:52.962 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:18:48.294 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:18:48.294 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:18:48.305 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:18:48.333 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 15:18:48.336 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 15:18:48.349 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 15:21:01.790 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:21:01.791 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:21:01.815 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:21:02.086 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:21:02.086 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:21:02.097 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:21:02.117 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:21:02.118 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:21:02.129 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:30:37.853 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:30:37.856 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:30:37.868 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:30:37.898 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 15:30:37.900 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 15:30:37.913 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 15:43:12.967 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:43:12.970 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:43:12.982 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:43:13.294 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:43:13.296 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:43:13.304 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:43:13.329 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:43:13.330 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:43:13.342 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:44:00.278 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:44:00.278 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:44:00.289 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:44:00.359 ERROR 20860 --- [http-nio-8820-exec-9] com.slipper.handler.RunExceptionHandler  : JSON parse error: Cannot construct instance of `com.slipper.modules.conversation.model.req.ConversationCreateReqVO` (although at least one Creator exists): no int/Int-argument constructor/factory method to deserialize from Number value (2); nested exception is com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot construct instance of `com.slipper.modules.conversation.model.req.ConversationCreateReqVO` (although at least one Creator exists): no int/Int-argument constructor/factory method to deserialize from Number value (2)
 at [Source: (org.springframework.util.StreamUtils$NonClosingInputStream); line: 1, column: 1]

org.springframework.http.converter.HttpMessageNotReadableException: JSON parse error: Cannot construct instance of `com.slipper.modules.conversation.model.req.ConversationCreateReqVO` (although at least one Creator exists): no int/Int-argument constructor/factory method to deserialize from Number value (2); nested exception is com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot construct instance of `com.slipper.modules.conversation.model.req.ConversationCreateReqVO` (although at least one Creator exists): no int/Int-argument constructor/factory method to deserialize from Number value (2)
 at [Source: (org.springframework.util.StreamUtils$NonClosingInputStream); line: 1, column: 1]
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.readJavaType(AbstractJackson2HttpMessageConverter.java:391)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.read(AbstractJackson2HttpMessageConverter.java:343)
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodArgumentResolver.readWithMessageConverters(AbstractMessageConverterMethodArgumentResolver.java:185)
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.readWithMessageConverters(RequestResponseBodyMethodProcessor.java:160)
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.resolveArgument(RequestResponseBodyMethodProcessor.java:133)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:122)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:179)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:146)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot construct instance of `com.slipper.modules.conversation.model.req.ConversationCreateReqVO` (although at least one Creator exists): no int/Int-argument constructor/factory method to deserialize from Number value (2)
 at [Source: (org.springframework.util.StreamUtils$NonClosingInputStream); line: 1, column: 1]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:63)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1728)
	at com.fasterxml.jackson.databind.DeserializationContext.handleMissingInstantiator(DeserializationContext.java:1353)
	at com.fasterxml.jackson.databind.deser.ValueInstantiator.createFromInt(ValueInstantiator.java:324)
	at com.fasterxml.jackson.databind.deser.std.StdValueInstantiator.createFromInt(StdValueInstantiator.java:376)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeFromNumber(BeanDeserializerBase.java:1442)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeOther(BeanDeserializer.java:199)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:187)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3682)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.readJavaType(AbstractJackson2HttpMessageConverter.java:380)
	... 104 common frames omitted

2024-05-30 15:44:54.561 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:44:54.562 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:44:54.571 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:44:54.573 ERROR 20860 --- [http-nio-8820-exec-10] com.slipper.handler.RunExceptionHandler  : JSON parse error: Cannot construct instance of `com.slipper.modules.conversation.model.req.ConversationCreateReqVO` (although at least one Creator exists): no int/Int-argument constructor/factory method to deserialize from Number value (2); nested exception is com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot construct instance of `com.slipper.modules.conversation.model.req.ConversationCreateReqVO` (although at least one Creator exists): no int/Int-argument constructor/factory method to deserialize from Number value (2)
 at [Source: (org.springframework.util.StreamUtils$NonClosingInputStream); line: 1, column: 1]

org.springframework.http.converter.HttpMessageNotReadableException: JSON parse error: Cannot construct instance of `com.slipper.modules.conversation.model.req.ConversationCreateReqVO` (although at least one Creator exists): no int/Int-argument constructor/factory method to deserialize from Number value (2); nested exception is com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot construct instance of `com.slipper.modules.conversation.model.req.ConversationCreateReqVO` (although at least one Creator exists): no int/Int-argument constructor/factory method to deserialize from Number value (2)
 at [Source: (org.springframework.util.StreamUtils$NonClosingInputStream); line: 1, column: 1]
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.readJavaType(AbstractJackson2HttpMessageConverter.java:391)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.read(AbstractJackson2HttpMessageConverter.java:343)
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodArgumentResolver.readWithMessageConverters(AbstractMessageConverterMethodArgumentResolver.java:185)
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.readWithMessageConverters(RequestResponseBodyMethodProcessor.java:160)
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.resolveArgument(RequestResponseBodyMethodProcessor.java:133)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:122)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:179)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:146)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)
Caused by: com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot construct instance of `com.slipper.modules.conversation.model.req.ConversationCreateReqVO` (although at least one Creator exists): no int/Int-argument constructor/factory method to deserialize from Number value (2)
 at [Source: (org.springframework.util.StreamUtils$NonClosingInputStream); line: 1, column: 1]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:63)
	at com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1728)
	at com.fasterxml.jackson.databind.DeserializationContext.handleMissingInstantiator(DeserializationContext.java:1353)
	at com.fasterxml.jackson.databind.deser.ValueInstantiator.createFromInt(ValueInstantiator.java:324)
	at com.fasterxml.jackson.databind.deser.std.StdValueInstantiator.createFromInt(StdValueInstantiator.java:376)
	at com.fasterxml.jackson.databind.deser.BeanDeserializerBase.deserializeFromNumber(BeanDeserializerBase.java:1442)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeOther(BeanDeserializer.java:199)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:187)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4674)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3682)
	at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.readJavaType(AbstractJackson2HttpMessageConverter.java:380)
	... 104 common frames omitted

2024-05-30 15:45:55.427 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:45:55.429 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:45:55.440 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:45:55.720 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:45:55.721 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:45:55.731 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:45:55.756 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:45:55.757 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:45:55.767 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:45:58.720 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:45:58.720 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:45:58.728 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:46:03.439 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.f.mapper.FriendMapper.selectList   : ==>  Preparing: SELECT id,user_id,friend_id,grouping_id,remark,created_at,updated_at,deleted FROM friend WHERE deleted=0 AND (user_id = ? AND friend_id = ?) limit 1
2024-05-30 15:46:03.444 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.f.mapper.FriendMapper.selectList   : ==> Parameters: 1(Long), 2(Long)
2024-05-30 15:46:03.454 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.f.mapper.FriendMapper.selectList   : <==      Total: 1
2024-05-30 15:46:03.471 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 15:46:03.471 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 15:46:03.482 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 15:46:03.484 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 15:46:03.485 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 15:46:03.496 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 0
2024-05-30 15:46:03.502  WARN 20860 --- [http-nio-8820-exec-13] c.b.mybatisplus.extension.toolkit.Db     : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@51efb0bb] Transaction not enabled
2024-05-30 15:46:03.512 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.insert      : ==>  Preparing: INSERT INTO conversation ( user_id, room_id, created_at, updated_at ) VALUES ( ?, ?, ?, ? )
2024-05-30 15:46:03.528 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.insert      : ==> Parameters: 1(Long), 2(Long), 2024-05-30T15:46:03.511(LocalDateTime), 2024-05-30T15:46:03.511(LocalDateTime)
2024-05-30 15:46:03.553 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryInfo   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id = ?
2024-05-30 15:46:03.555 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryInfo   : ==> Parameters: 3(Long)
2024-05-30 15:46:03.571 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryInfo   : <==      Total: 1
2024-05-30 15:47:44.857 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:47:44.858 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:47:44.871 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:47:45.128 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:47:45.128 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:47:45.137 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:47:45.160 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:47:45.161 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:47:45.175 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:47:45.783 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:47:45.783 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:47:45.796 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:47:45.822 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 15:47:45.823 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 15:47:45.835 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 2
2024-05-30 15:47:47.605 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:47:47.605 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:47:47.608 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:47:47.608 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:47:47.616 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:47:47.617 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:47:47.656 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:47:47.657 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 15:47:47.658 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 10(Long)
2024-05-30 15:47:47.658 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 15:47:47.668 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:47:47.680 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 15:47:48.529 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:47:48.530 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:47:48.540 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:47:48.543 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:47:48.543 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 15:47:48.557 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 2
2024-05-30 15:47:49.943 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:47:49.944 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:47:49.953 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:47:49.955 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:47:49.956 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 10(Long)
2024-05-30 15:47:49.967 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:47:50.923 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:47:50.924 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:47:50.935 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:47:50.937 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:47:50.938 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 15:47:50.951 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:47:51.411 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:47:51.412 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:47:51.420 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:47:51.424 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:47:51.425 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 10(Long)
2024-05-30 15:47:51.437 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:47:52.196 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:47:52.197 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:47:52.208 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:47:52.212 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:47:52.213 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 15:47:52.223 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:47:52.569 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:47:52.570 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:47:52.580 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:47:52.583 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:47:52.585 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 10(Long)
2024-05-30 15:47:52.595 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:47:54.126 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:47:54.127 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:47:54.139 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:47:54.142 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:47:54.143 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 15:47:54.153 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:47:57.717 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:47:57.718 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:47:57.727 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:47:57.730 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:47:57.731 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 10(Long)
2024-05-30 15:47:57.741 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:48:01.143 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:48:01.144 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:48:01.154 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:48:01.291 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 15:48:01.291 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 15:48:01.301 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 15:48:01.310 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 15:48:01.313 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 15:48:01.326 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 15:48:01.332 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 15:48:01.336 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 2(Long), 0(Integer), 1(String), 2024-05-30T15:48:01.332(LocalDateTime), 2024-05-30T15:48:01.332(LocalDateTime)
2024-05-30 15:48:01.357 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 15:48:01.362 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 15:48:01.367 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 3(Long), 2024-05-30T15:48:01.361(LocalDateTime), 2(Long)
2024-05-30 15:48:01.387 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 15:48:01.388 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 15:48:01.388 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 15:48:01.397 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 15:48:01.400 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?)
2024-05-30 15:48:01.400 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 15:48:01.409 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 15:48:01.413 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 15:48:01.414 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 2(Long)
2024-05-30 15:48:01.424 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 0
2024-05-30 15:48:01.426 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.insert      : ==>  Preparing: INSERT INTO conversation ( user_id, room_id, created_at, updated_at ) VALUES ( ?, ?, ?, ? )
2024-05-30 15:48:01.426 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.c.m.ConversationMapper.insert      : ==> Parameters: 2(Long), 2(Long), 2024-05-30T15:48:01.425(LocalDateTime), 2024-05-30T15:48:01.425(LocalDateTime)
2024-05-30 15:48:01.452 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 15:48:01.455 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 4(Long)
2024-05-30 15:48:01.467 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 15:48:01.481 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 15:48:01.483 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 2(Long), 1(Long)
2024-05-30 15:48:01.494 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 15:48:07.146 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.c.s.h.AuthenticationEntryPointImpl   : [访问 URL http://localhost:8820/chatterbox/message/page/id 时，未登录]
2024-05-30 15:48:24.322 DEBUG 20860 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:48:24.322 DEBUG 20860 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:48:24.330 DEBUG 20860 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:48:24.333 DEBUG 20860 --- [http-nio-8820-exec-29] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:48:24.333 DEBUG 20860 --- [http-nio-8820-exec-29] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 15:48:24.344 DEBUG 20860 --- [http-nio-8820-exec-29] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:48:24.949 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:48:24.949 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:48:24.958 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:48:24.960 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:48:24.961 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 3(Long), 10(Long)
2024-05-30 15:48:24.970 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:48:25.656 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:48:25.657 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:48:25.666 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:48:25.668 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:48:25.668 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 15:48:25.678 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:48:26.199 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:48:26.200 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:48:26.210 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:48:26.212 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:48:26.212 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 3(Long), 10(Long)
2024-05-30 15:48:26.222 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:48:26.728 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:48:26.728 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:48:26.740 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:48:26.742 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:48:26.742 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 15:48:26.752 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:48:27.222 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:48:27.222 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:48:27.229 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:48:27.231 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:48:27.232 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 3(Long), 10(Long)
2024-05-30 15:48:27.240 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:48:27.723 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:48:27.723 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:48:27.735 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:48:27.738 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:48:27.739 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 15:48:27.748 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:48:28.249 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:48:28.249 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:48:28.259 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:48:28.261 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:48:28.261 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 3(Long), 10(Long)
2024-05-30 15:48:28.271 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:48:28.712 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:48:28.712 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:48:28.723 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:48:28.724 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:48:28.725 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 15:48:28.732 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:48:29.195 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:48:29.196 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:48:29.205 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:48:29.207 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:48:29.208 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 3(Long), 10(Long)
2024-05-30 15:48:29.216 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:48:29.670 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:48:29.670 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:48:29.679 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:48:29.681 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:48:29.681 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 15:48:29.691 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:48:30.965 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:48:30.965 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:48:30.974 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:48:30.976 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:48:30.976 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 3(Long), 10(Long)
2024-05-30 15:48:30.983 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:48:33.429 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:48:33.430 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:48:33.437 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:48:33.442 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? AND m.id < ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:48:33.443 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 1(Long), 10(Long)
2024-05-30 15:48:33.451 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 15:49:40.826 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:49:40.827 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:49:40.852 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:49:41.187 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:49:41.188 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:49:41.201 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:49:41.224 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 15:49:41.226 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 15:49:41.239 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 2
2024-05-30 15:49:43.186 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:49:43.187 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:49:43.198 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:49:43.200 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:49:43.200 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:49:43.201 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:49:43.201 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 10(Long)
2024-05-30 15:49:43.208 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:49:43.211 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 1
2024-05-30 15:49:43.229 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 15:49:43.230 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 15:49:43.246 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 15:49:44.086 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:49:44.086 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:49:44.097 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:49:44.098 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:49:44.099 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 15:49:44.108 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 2
2024-05-30 15:51:50.012 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:51:50.012 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:51:50.023 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:51:50.339 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:51:50.339 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:51:50.348 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:51:50.367 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 15:51:50.368 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 15:51:50.385 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 2
2024-05-30 15:53:23.681 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:53:23.683 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:53:23.689 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:53:24.001 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:53:24.002 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:53:24.008 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:53:24.031 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 15:53:24.032 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 15:53:24.042 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 2
2024-05-30 15:53:34.792 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:53:34.792 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:53:34.800 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:53:34.800 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:53:34.800 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:53:34.802 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:53:34.802 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 10(Long)
2024-05-30 15:53:34.809 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 1
2024-05-30 15:53:34.810 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:53:34.830 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 15:53:34.831 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 15:53:34.845 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 15:54:27.544 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:54:27.544 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:54:27.558 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:54:27.885 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:54:27.885 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:54:27.894 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:54:27.915 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 15:54:27.917 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 15:54:27.931 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 2
2024-05-30 15:54:30.840 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:54:30.840 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:54:30.852 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:54:30.875 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:54:30.876 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:54:30.889 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:54:39.861 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:54:39.861 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:54:39.870 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:54:39.872 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:54:39.872 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 15:54:39.882 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 2
2024-05-30 15:54:39.892 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:54:39.892 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:54:39.901 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:54:39.922 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 15:54:39.922 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 15:54:39.934 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 15:54:40.347 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:54:40.348 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:54:40.355 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:54:40.357 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 15:54:40.357 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 10(Long)
2024-05-30 15:54:40.368 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 1
2024-05-30 15:54:47.579 DEBUG 20860 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:54:47.579 DEBUG 20860 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:54:47.590 DEBUG 20860 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:54:47.888 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:54:47.889 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:54:47.897 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:54:47.916 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 15:54:47.917 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 15:54:47.935 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 15:54:49.732 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:54:49.732 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:54:49.741 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:54:49.761 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:54:49.762 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:54:49.772 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:54:52.395 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:54:52.396 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:54:52.405 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:54:52.429 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.f.mapper.FriendMapper.selectList   : ==>  Preparing: SELECT id,user_id,friend_id,grouping_id,remark,created_at,updated_at,deleted FROM friend WHERE deleted=0 AND (user_id = ? AND friend_id = ?) limit 1
2024-05-30 15:54:52.429 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.f.mapper.FriendMapper.selectList   : ==> Parameters: 1(Long), 2(Long)
2024-05-30 15:54:52.440 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.f.mapper.FriendMapper.selectList   : <==      Total: 1
2024-05-30 15:54:52.442 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 15:54:52.442 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 15:54:52.451 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 15:54:52.453 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 15:54:52.453 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 15:54:52.462 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 0
2024-05-30 15:54:52.462  WARN 20860 --- [http-nio-8820-exec-3] c.b.mybatisplus.extension.toolkit.Db     : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26383f2d] Transaction not enabled
2024-05-30 15:54:52.463 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.insert      : ==>  Preparing: INSERT INTO conversation ( user_id, room_id, created_at, updated_at ) VALUES ( ?, ?, ?, ? )
2024-05-30 15:54:52.463 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.insert      : ==> Parameters: 1(Long), 2(Long), 2024-05-30T15:54:52.462(LocalDateTime), 2024-05-30T15:54:52.462(LocalDateTime)
2024-05-30 15:54:52.486 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.queryInfo   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id = ?
2024-05-30 15:54:52.487 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.queryInfo   : ==> Parameters: 3(Long)
2024-05-30 15:54:52.497 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.queryInfo   : <==      Total: 1
2024-05-30 15:55:42.079 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:55:42.080 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:55:42.090 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:55:42.342 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:55:42.343 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:55:42.352 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:55:42.370 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:55:42.371 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:55:42.382 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:55:47.794 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:55:47.794 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:55:47.802 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:55:47.823 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.f.mapper.FriendMapper.selectList   : ==>  Preparing: SELECT id,user_id,friend_id,grouping_id,remark,created_at,updated_at,deleted FROM friend WHERE deleted=0 AND (user_id = ? AND friend_id = ?) limit 1
2024-05-30 15:55:47.824 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.f.mapper.FriendMapper.selectList   : ==> Parameters: 1(Long), 2(Long)
2024-05-30 15:55:47.833 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.f.mapper.FriendMapper.selectList   : <==      Total: 1
2024-05-30 15:55:47.835 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 15:55:47.835 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 15:55:47.843 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 15:55:47.846 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 15:55:47.846 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 15:55:47.854 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 15:55:47.855 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.queryInfo   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id = ?
2024-05-30 15:55:47.855 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.queryInfo   : ==> Parameters: 3(Long)
2024-05-30 15:55:47.865 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.queryInfo   : <==      Total: 1
2024-05-30 15:56:20.483 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:56:20.483 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:56:20.492 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:56:20.762 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:56:20.763 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:56:20.772 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:56:20.796 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:56:20.797 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:56:20.806 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:56:23.262 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:56:23.262 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:56:23.271 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:56:23.292 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.f.mapper.FriendMapper.selectList   : ==>  Preparing: SELECT id,user_id,friend_id,grouping_id,remark,created_at,updated_at,deleted FROM friend WHERE deleted=0 AND (user_id = ? AND friend_id = ?) limit 1
2024-05-30 15:56:23.293 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.f.mapper.FriendMapper.selectList   : ==> Parameters: 1(Long), 2(Long)
2024-05-30 15:56:23.301 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.f.mapper.FriendMapper.selectList   : <==      Total: 1
2024-05-30 15:56:23.304 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 15:56:23.305 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 15:56:23.312 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 15:56:23.314 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 15:56:23.315 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 15:56:23.322 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 15:56:23.323 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.queryInfo   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id = ?
2024-05-30 15:56:23.323 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.queryInfo   : ==> Parameters: 3(Long)
2024-05-30 15:56:23.333 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.c.m.ConversationMapper.queryInfo   : <==      Total: 1
2024-05-30 15:56:27.375 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:56:27.375 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:56:27.384 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:56:27.682 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:56:27.683 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:56:27.692 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:56:27.712 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:56:27.713 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:56:27.723 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:56:39.425 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:56:39.425 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:56:39.435 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:56:39.679 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:56:39.679 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:56:39.689 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:56:39.713 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:56:39.714 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:56:39.723 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:56:41.506 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:56:41.507 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:56:41.515 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:56:41.544 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.f.mapper.FriendMapper.selectList   : ==>  Preparing: SELECT id,user_id,friend_id,grouping_id,remark,created_at,updated_at,deleted FROM friend WHERE deleted=0 AND (user_id = ? AND friend_id = ?) limit 1
2024-05-30 15:56:41.545 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.f.mapper.FriendMapper.selectList   : ==> Parameters: 1(Long), 2(Long)
2024-05-30 15:56:41.553 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.f.mapper.FriendMapper.selectList   : <==      Total: 1
2024-05-30 15:56:41.557 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 15:56:41.557 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 15:56:41.566 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 15:56:41.570 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 15:56:41.571 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 15:56:41.580 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 15:56:41.583 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryInfo   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id = ?
2024-05-30 15:56:41.583 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryInfo   : ==> Parameters: 3(Long)
2024-05-30 15:56:41.593 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.queryInfo   : <==      Total: 1
2024-05-30 15:56:55.266 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:56:55.267 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:56:55.278 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:56:55.523 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:56:55.524 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:56:55.532 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:56:55.551 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:56:55.552 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:56:55.562 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:56:58.232 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:56:58.232 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:56:58.241 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:56:58.262 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 15:56:58.262 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 15:56:58.273 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 2
2024-05-30 15:57:01.004 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:57:01.005 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:57:01.028 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:57:01.050 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.f.mapper.FriendMapper.selectList   : ==>  Preparing: SELECT id,user_id,friend_id,grouping_id,remark,created_at,updated_at,deleted FROM friend WHERE deleted=0 AND (user_id = ? AND friend_id = ?) limit 1
2024-05-30 15:57:01.050 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.f.mapper.FriendMapper.selectList   : ==> Parameters: 1(Long), 2(Long)
2024-05-30 15:57:01.066 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.f.mapper.FriendMapper.selectList   : <==      Total: 1
2024-05-30 15:57:01.067 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 15:57:01.068 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 15:57:01.089 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 15:57:01.091 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 15:57:01.091 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 15:57:01.100 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 15:57:01.101 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.queryInfo   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id = ?
2024-05-30 15:57:01.102 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.queryInfo   : ==> Parameters: 3(Long)
2024-05-30 15:57:01.111 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.queryInfo   : <==      Total: 1
2024-05-30 15:57:22.023 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:57:22.023 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:57:22.033 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:57:22.360 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:57:22.360 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:57:22.370 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:57:22.398 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:57:22.399 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:57:22.409 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:57:48.353 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:57:48.354 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:57:48.610 ERROR 20860 --- [http-nio-8820-exec-20] c.alibaba.druid.filter.stat.StatFilter   : slow sql 244 millis. SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=?  AND deleted=0[1]
2024-05-30 15:57:48.611 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:57:48.631 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 15:57:48.632 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 15:57:48.645 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 15:57:50.257 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:57:50.258 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:57:50.267 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:57:50.289 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.f.mapper.FriendMapper.selectList   : ==>  Preparing: SELECT id,user_id,friend_id,grouping_id,remark,created_at,updated_at,deleted FROM friend WHERE deleted=0 AND (user_id = ? AND friend_id = ?) limit 1
2024-05-30 15:57:50.289 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.f.mapper.FriendMapper.selectList   : ==> Parameters: 1(Long), 2(Long)
2024-05-30 15:57:50.299 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.f.mapper.FriendMapper.selectList   : <==      Total: 1
2024-05-30 15:57:50.301 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 15:57:50.302 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 15:57:50.311 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 15:57:50.313 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 15:57:50.314 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 15:57:50.325 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 0
2024-05-30 15:57:50.325  WARN 20860 --- [http-nio-8820-exec-21] c.b.mybatisplus.extension.toolkit.Db     : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@67a51d0f] Transaction not enabled
2024-05-30 15:57:50.327 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.insert      : ==>  Preparing: INSERT INTO conversation ( user_id, room_id, created_at, updated_at ) VALUES ( ?, ?, ?, ? )
2024-05-30 15:57:50.327 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.insert      : ==> Parameters: 1(Long), 2(Long), 2024-05-30T15:57:50.325(LocalDateTime), 2024-05-30T15:57:50.325(LocalDateTime)
2024-05-30 15:57:50.353 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.queryInfo   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id = ?
2024-05-30 15:57:50.353 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.queryInfo   : ==> Parameters: 3(Long)
2024-05-30 15:57:50.365 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.c.m.ConversationMapper.queryInfo   : <==      Total: 1
2024-05-30 15:58:10.223 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:58:10.223 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:58:10.232 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:58:10.486 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:58:10.486 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:58:10.497 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:58:10.516 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:58:10.516 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:58:10.534 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:58:11.982 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:58:11.983 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:58:11.993 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:58:12.012 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 15:58:12.012 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 15:58:12.022 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 2
2024-05-30 15:58:18.666 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:58:18.666 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:58:18.677 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:58:18.969 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:58:18.969 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:58:18.979 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:58:19.003 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 15:58:19.004 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 15:58:19.014 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 15:58:21.774 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:58:21.774 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:58:21.783 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:58:21.807 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:58:21.807 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:58:21.816 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:58:23.869 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:58:23.869 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:58:23.879 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:58:23.906 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.f.mapper.FriendMapper.selectList   : ==>  Preparing: SELECT id,user_id,friend_id,grouping_id,remark,created_at,updated_at,deleted FROM friend WHERE deleted=0 AND (user_id = ? AND friend_id = ?) limit 1
2024-05-30 15:58:23.906 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.f.mapper.FriendMapper.selectList   : ==> Parameters: 1(Long), 2(Long)
2024-05-30 15:58:23.916 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.f.mapper.FriendMapper.selectList   : <==      Total: 1
2024-05-30 15:58:23.918 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 15:58:23.918 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 15:58:23.929 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 15:58:23.931 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 15:58:23.932 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 15:58:23.941 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 0
2024-05-30 15:58:23.941  WARN 20860 --- [http-nio-8820-exec-28] c.b.mybatisplus.extension.toolkit.Db     : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@142450c0] Transaction not enabled
2024-05-30 15:58:23.942 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.insert      : ==>  Preparing: INSERT INTO conversation ( user_id, room_id, created_at, updated_at ) VALUES ( ?, ?, ?, ? )
2024-05-30 15:58:23.942 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.insert      : ==> Parameters: 1(Long), 2(Long), 2024-05-30T15:58:23.941(LocalDateTime), 2024-05-30T15:58:23.941(LocalDateTime)
2024-05-30 15:58:23.963 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryInfo   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id = ?
2024-05-30 15:58:23.963 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryInfo   : ==> Parameters: 3(Long)
2024-05-30 15:58:23.973 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryInfo   : <==      Total: 1
2024-05-30 15:59:50.976 DEBUG 20860 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:59:50.976 DEBUG 20860 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:59:50.987 DEBUG 20860 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:59:51.241 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:59:51.242 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:59:51.252 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:59:51.269 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 15:59:51.270 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 15:59:51.283 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 15:59:54.553 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:59:54.554 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:59:54.563 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:59:54.581 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 15:59:54.581 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 15:59:54.595 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 2
2024-05-30 15:59:59.891 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 15:59:59.891 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 15:59:59.901 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 15:59:59.922 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.f.mapper.FriendMapper.selectList   : ==>  Preparing: SELECT id,user_id,friend_id,grouping_id,remark,created_at,updated_at,deleted FROM friend WHERE deleted=0 AND (user_id = ? AND friend_id = ?) limit 1
2024-05-30 15:59:59.923 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.f.mapper.FriendMapper.selectList   : ==> Parameters: 1(Long), 2(Long)
2024-05-30 15:59:59.931 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.f.mapper.FriendMapper.selectList   : <==      Total: 1
2024-05-30 15:59:59.933 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 15:59:59.933 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 15:59:59.943 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 15:59:59.944 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 15:59:59.945 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 15:59:59.953 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 15:59:59.954 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.queryInfo   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id = ?
2024-05-30 15:59:59.954 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.queryInfo   : ==> Parameters: 3(Long)
2024-05-30 15:59:59.965 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.queryInfo   : <==      Total: 1
2024-05-30 16:00:00.054 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:00:00.054 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:00:00.063 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:00:00.064 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:00:00.064 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:00:00.066 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 16:00:00.066 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 10(Long)
2024-05-30 16:00:00.078 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 16:00:00.079 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:00:00.103 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 16:00:00.103 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 16:00:00.118 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 16:00:08.754 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:00:08.755 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:00:08.765 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:00:08.766 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 16:00:08.767 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 10(Long)
2024-05-30 16:00:08.775 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 16:00:42.157 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:00:42.157 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:00:42.165 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:00:42.494 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:00:42.494 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:00:42.503 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:00:42.523 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 16:00:42.524 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 16:00:42.536 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 2
2024-05-30 16:00:44.014 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:00:44.014 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:00:44.024 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:00:44.044 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:00:44.044 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:00:44.055 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:00:46.546 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:00:46.546 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:00:46.555 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:00:46.574 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.f.mapper.FriendMapper.selectList   : ==>  Preparing: SELECT id,user_id,friend_id,grouping_id,remark,created_at,updated_at,deleted FROM friend WHERE deleted=0 AND (user_id = ? AND friend_id = ?) limit 1
2024-05-30 16:00:46.575 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.f.mapper.FriendMapper.selectList   : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:00:46.585 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.f.mapper.FriendMapper.selectList   : <==      Total: 1
2024-05-30 16:00:46.588 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 16:00:46.588 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 16:00:46.597 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:00:46.599 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:00:46.599 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:00:46.609 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 16:00:46.610 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.queryInfo   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id = ?
2024-05-30 16:00:46.611 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.queryInfo   : ==> Parameters: 3(Long)
2024-05-30 16:00:46.622 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.queryInfo   : <==      Total: 1
2024-05-30 16:00:46.700 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:00:46.700 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:00:46.700 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:00:46.700 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:00:46.709 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:00:46.709 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:00:46.712 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 16:00:46.712 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 10(Long)
2024-05-30 16:00:46.723 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 16:00:46.732 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 16:00:46.732 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 16:00:46.747 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 16:01:12.820 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:01:12.820 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:01:12.830 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:01:12.842 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:01:12.842 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:01:12.851 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:01:12.853 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:01:12.854 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:01:12.864 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:01:12.864 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 16:01:12.865 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 2(Long), 0(Integer), 1(String), 2024-05-30T16:01:12.864(LocalDateTime), 2024-05-30T16:01:12.864(LocalDateTime)
2024-05-30 16:01:12.882 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 16:01:12.883 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 16:01:12.884 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 2(Long), 2024-05-30T16:01:12.883(LocalDateTime), 2(Long)
2024-05-30 16:01:12.902 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 16:01:12.902 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:01:12.903 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:01:12.912 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:01:12.913 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?)
2024-05-30 16:01:12.913 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:01:12.924 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:01:12.925 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:01:12.925 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 2(Long)
2024-05-30 16:01:12.936 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 0
2024-05-30 16:01:12.937 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.insert      : ==>  Preparing: INSERT INTO conversation ( user_id, room_id, created_at, updated_at ) VALUES ( ?, ?, ?, ? )
2024-05-30 16:01:12.937 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.insert      : ==> Parameters: 2(Long), 2(Long), 2024-05-30T16:01:12.937(LocalDateTime), 2024-05-30T16:01:12.937(LocalDateTime)
2024-05-30 16:01:12.957 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 16:01:12.958 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 4(Long)
2024-05-30 16:01:12.970 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 16:01:12.974 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 16:01:12.975 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 2(Long), 1(Long)
2024-05-30 16:01:12.986 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 16:01:19.224 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:01:19.224 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:01:19.234 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:01:19.244 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:01:19.244 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:01:19.255 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:01:19.256 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:01:19.257 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:01:19.265 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:01:19.267 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 16:01:19.267 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 2(Long), 0(Integer), 2(String), 2024-05-30T16:01:19.266(LocalDateTime), 2024-05-30T16:01:19.266(LocalDateTime)
2024-05-30 16:01:19.285 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 16:01:19.285 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 16:01:19.286 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 3(Long), 2024-05-30T16:01:19.285(LocalDateTime), 2(Long)
2024-05-30 16:01:19.304 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 16:01:19.305 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:01:19.305 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:01:19.313 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:01:19.315 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?)
2024-05-30 16:01:19.315 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:01:19.326 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:01:19.328 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:01:19.328 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 2(Long)
2024-05-30 16:01:19.335 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 16:01:19.335 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 16:01:19.336 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 4(Long)
2024-05-30 16:01:19.346 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 16:01:19.349 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 16:01:19.350 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 2(Long), 1(Long)
2024-05-30 16:01:19.359 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 16:01:25.054 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:01:25.054 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:01:25.064 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:01:25.087 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.f.mapper.FriendMapper.selectList   : ==>  Preparing: SELECT id,user_id,friend_id,grouping_id,remark,created_at,updated_at,deleted FROM friend WHERE deleted=0 AND (user_id = ? AND friend_id = ?) limit 1
2024-05-30 16:01:25.088 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.f.mapper.FriendMapper.selectList   : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:01:25.097 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.f.mapper.FriendMapper.selectList   : <==      Total: 1
2024-05-30 16:01:25.099 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 16:01:25.100 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 16:01:25.110 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:01:25.113 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:01:25.113 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:01:25.121 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 16:01:25.122 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.queryInfo   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id = ?
2024-05-30 16:01:25.122 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.queryInfo   : ==> Parameters: 3(Long)
2024-05-30 16:01:25.133 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.queryInfo   : <==      Total: 1
2024-05-30 16:02:19.119 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:02:19.120 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:02:19.130 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:02:19.151 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.f.mapper.FriendMapper.selectList   : ==>  Preparing: SELECT id,user_id,friend_id,grouping_id,remark,created_at,updated_at,deleted FROM friend WHERE deleted=0 AND (user_id = ? AND friend_id = ?) limit 1
2024-05-30 16:02:19.151 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.f.mapper.FriendMapper.selectList   : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:02:19.162 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.f.mapper.FriendMapper.selectList   : <==      Total: 1
2024-05-30 16:02:19.165 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 16:02:19.166 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 16:02:19.175 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:02:19.177 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:02:19.177 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:02:19.186 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 16:02:19.187 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.queryInfo   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id = ?
2024-05-30 16:02:19.187 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.queryInfo   : ==> Parameters: 3(Long)
2024-05-30 16:02:19.196 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.c.m.ConversationMapper.queryInfo   : <==      Total: 1
2024-05-30 16:02:24.744 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:02:24.745 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:02:24.754 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:02:24.775 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.f.mapper.FriendMapper.selectList   : ==>  Preparing: SELECT id,user_id,friend_id,grouping_id,remark,created_at,updated_at,deleted FROM friend WHERE deleted=0 AND (user_id = ? AND friend_id = ?) limit 1
2024-05-30 16:02:24.776 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.f.mapper.FriendMapper.selectList   : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:02:24.784 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.f.mapper.FriendMapper.selectList   : <==      Total: 1
2024-05-30 16:02:24.786 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 16:02:24.786 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 16:02:24.795 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:02:24.797 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:02:24.797 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:02:24.806 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 16:02:24.807 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.queryInfo   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id = ?
2024-05-30 16:02:24.807 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.queryInfo   : ==> Parameters: 3(Long)
2024-05-30 16:02:24.818 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.queryInfo   : <==      Total: 1
2024-05-30 16:02:26.375 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:02:26.376 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:02:26.384 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:02:26.410 ERROR 20860 --- [http-nio-8820-exec-17] com.slipper.handler.RunExceptionHandler  : 操作太频繁,请稍后重试！

com.slipper.exception.RunException: 操作太频繁,请稍后重试！
	at com.slipper.core.repeat.aspect.RepeatAspect.around(RepeatAspect.java:64)
	at sun.reflect.GeneratedMethodAccessor110.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.conversation.controller.ConversationController$$EnhancerBySpringCGLIB$$97651de4.create(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:02:27.424 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:02:27.424 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:02:27.436 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:02:27.447 ERROR 20860 --- [http-nio-8820-exec-18] com.slipper.handler.RunExceptionHandler  : 操作太频繁,请稍后重试！

com.slipper.exception.RunException: 操作太频繁,请稍后重试！
	at com.slipper.core.repeat.aspect.RepeatAspect.around(RepeatAspect.java:64)
	at sun.reflect.GeneratedMethodAccessor110.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.conversation.controller.ConversationController$$EnhancerBySpringCGLIB$$97651de4.create(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:02:27.475 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:02:27.475 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:02:27.483 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:02:27.496 ERROR 20860 --- [http-nio-8820-exec-19] com.slipper.handler.RunExceptionHandler  : 操作太频繁,请稍后重试！

com.slipper.exception.RunException: 操作太频繁,请稍后重试！
	at com.slipper.core.repeat.aspect.RepeatAspect.around(RepeatAspect.java:64)
	at sun.reflect.GeneratedMethodAccessor110.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.conversation.controller.ConversationController$$EnhancerBySpringCGLIB$$97651de4.create(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:02:28.502 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:02:28.502 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:02:28.510 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:02:28.530 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.f.mapper.FriendMapper.selectList   : ==>  Preparing: SELECT id,user_id,friend_id,grouping_id,remark,created_at,updated_at,deleted FROM friend WHERE deleted=0 AND (user_id = ? AND friend_id = ?) limit 1
2024-05-30 16:02:28.531 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.f.mapper.FriendMapper.selectList   : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:02:28.538 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.f.mapper.FriendMapper.selectList   : <==      Total: 1
2024-05-30 16:02:28.540 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 16:02:28.541 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 16:02:28.549 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:02:28.550 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:02:28.551 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:02:28.557 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 16:02:28.558 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryInfo   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id = ?
2024-05-30 16:02:28.559 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryInfo   : ==> Parameters: 3(Long)
2024-05-30 16:02:28.569 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryInfo   : <==      Total: 1
2024-05-30 16:12:30.612 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:12:30.613 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:12:30.624 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:12:30.977 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:12:30.978 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:12:30.988 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:12:31.009 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 16:12:31.011 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 16:12:31.025 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 2
2024-05-30 16:12:32.437 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:12:32.438 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:12:32.447 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:12:32.466 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:12:32.467 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:12:32.476 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:12:35.865 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:12:35.866 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:12:35.874 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:12:35.897 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.f.mapper.FriendMapper.selectList   : ==>  Preparing: SELECT id,user_id,friend_id,grouping_id,remark,created_at,updated_at,deleted FROM friend WHERE deleted=0 AND (user_id = ? AND friend_id = ?) limit 1
2024-05-30 16:12:35.897 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.f.mapper.FriendMapper.selectList   : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:12:35.907 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.f.mapper.FriendMapper.selectList   : <==      Total: 1
2024-05-30 16:12:35.909 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 16:12:35.909 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 16:12:35.917 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:12:35.919 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:12:35.919 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:12:35.927 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 16:12:35.928 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryInfo   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id = ?
2024-05-30 16:12:35.928 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryInfo   : ==> Parameters: 3(Long)
2024-05-30 16:12:35.990 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryInfo   : <==      Total: 1
2024-05-30 16:12:36.066 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:12:36.066 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:12:36.070 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:12:36.070 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:12:36.077 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:12:36.080 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:12:36.082 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 16:12:36.082 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 10(Long)
2024-05-30 16:12:36.092 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 2
2024-05-30 16:12:36.107 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 16:12:36.108 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 16:12:36.121 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 16:13:45.339 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:13:45.339 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:13:45.349 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:13:45.944 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:13:45.945 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:13:45.955 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:13:45.978 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:13:45.978 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:13:45.988 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:15:11.438 DEBUG 20860 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:15:11.439 DEBUG 20860 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:15:11.451 DEBUG 20860 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:15:11.737 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:15:11.737 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:15:11.747 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:15:11.769 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:15:11.769 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:15:11.778 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:19:00.292 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:19:00.292 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:19:00.301 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:19:00.323 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:19:00.323 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:19:00.331 DEBUG 20860 --- [http-nio-8820-exec-2] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:20:08.011 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:20:08.012 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:20:08.023 DEBUG 20860 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:24:18.572 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:24:18.572 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:24:18.585 DEBUG 20860 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:24:19.084 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:24:19.084 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:24:19.095 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:24:19.115 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:24:19.116 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:24:19.126 DEBUG 20860 --- [http-nio-8820-exec-4] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:26:10.538 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:26:10.540 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:26:10.551 DEBUG 20860 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:26:11.151 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:26:11.151 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:26:11.166 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:26:11.188 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:26:11.189 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:26:11.205 DEBUG 20860 --- [http-nio-8820-exec-6] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:26:42.270 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:26:42.270 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:26:42.283 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:26:42.306 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:26:42.306 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:26:42.324 DEBUG 20860 --- [http-nio-8820-exec-7] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:26:44.336 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:26:44.337 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:26:44.352 DEBUG 20860 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:26:44.650 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:26:44.650 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:26:44.659 DEBUG 20860 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:26:44.684 ERROR 20860 --- [http-nio-8820-exec-9] com.slipper.handler.RunExceptionHandler  : 操作太频繁,请稍后重试！

com.slipper.exception.RunException: 操作太频繁,请稍后重试！
	at com.slipper.core.repeat.aspect.RepeatAspect.around(RepeatAspect.java:64)
	at sun.reflect.GeneratedMethodAccessor110.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.grouping.controller.GroupingController$$EnhancerBySpringCGLIB$$63926264.queryGroupingFriend(<generated>)
	at sun.reflect.GeneratedMethodAccessor152.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:529)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:26:47.219 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:26:47.220 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:26:47.237 DEBUG 20860 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:26:47.500 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:26:47.501 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:26:47.516 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:26:47.537 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:26:47.537 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:26:47.548 DEBUG 20860 --- [http-nio-8820-exec-11] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:26:57.625 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:26:57.625 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:26:57.635 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:26:57.655 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:26:57.655 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:26:57.665 DEBUG 20860 --- [http-nio-8820-exec-12] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:27:00.861 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:27:00.862 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:27:00.872 DEBUG 20860 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:27:01.127 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:27:01.127 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:27:01.135 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:27:01.172 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:27:01.172 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:27:01.182 DEBUG 20860 --- [http-nio-8820-exec-14] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:27:40.442 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:27:40.443 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:27:40.454 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:27:40.475 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:27:40.475 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:27:40.483 DEBUG 20860 --- [http-nio-8820-exec-15] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:27:42.282 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:27:42.282 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:27:42.292 DEBUG 20860 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:27:42.559 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:27:42.559 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:27:42.567 DEBUG 20860 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:27:42.576 ERROR 20860 --- [http-nio-8820-exec-17] com.slipper.handler.RunExceptionHandler  : 操作太频繁,请稍后重试！

com.slipper.exception.RunException: 操作太频繁,请稍后重试！
	at com.slipper.core.repeat.aspect.RepeatAspect.around(RepeatAspect.java:64)
	at sun.reflect.GeneratedMethodAccessor110.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.grouping.controller.GroupingController$$EnhancerBySpringCGLIB$$63926264.queryGroupingFriend(<generated>)
	at sun.reflect.GeneratedMethodAccessor152.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:529)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:27:44.660 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:27:44.660 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:27:44.669 DEBUG 20860 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:27:44.924 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:27:44.925 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:27:44.934 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:27:44.955 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:27:44.955 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:27:44.965 DEBUG 20860 --- [http-nio-8820-exec-19] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:27:52.679 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:27:52.680 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:27:52.688 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:27:52.714 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 16:27:52.715 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 16:27:52.728 DEBUG 20860 --- [http-nio-8820-exec-20] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 2
2024-05-30 16:28:00.482 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:28:00.482 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:28:00.491 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:28:00.511 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:28:00.512 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:28:00.520 DEBUG 20860 --- [http-nio-8820-exec-21] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:28:33.953 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:28:33.955 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:28:33.964 DEBUG 20860 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:28:34.221 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:28:34.222 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:28:34.229 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:28:34.248 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:28:34.248 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:28:34.261 DEBUG 20860 --- [http-nio-8820-exec-23] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:28:45.165 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:28:45.165 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:28:45.172 DEBUG 20860 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:28:45.448 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:28:45.448 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:28:45.457 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:28:45.478 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:28:45.479 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:28:45.486 DEBUG 20860 --- [http-nio-8820-exec-25] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:28:48.998 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:28:48.999 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:28:49.012 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:28:49.111 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.friend.mapper.FriendMapper.delete  : ==>  Preparing: UPDATE friend SET deleted=1 WHERE deleted=0 AND (user_id = ? AND friend_id = ?)
2024-05-30 16:28:49.117 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.friend.mapper.FriendMapper.delete  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:28:49.140 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.friend.mapper.FriendMapper.delete  : <==    Updates: 1
2024-05-30 16:28:49.148 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 16:28:49.148 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 16:28:49.159 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:28:49.170 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomFriendMapper.updateById    : ==>  Preparing: UPDATE room_friend SET status=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 16:28:49.171 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomFriendMapper.updateById    : ==> Parameters: 0(Integer), 2024-05-30T16:28:49.169(LocalDateTime), 1(Long)
2024-05-30 16:28:49.200 DEBUG 20860 --- [http-nio-8820-exec-26] c.s.m.r.m.RoomFriendMapper.updateById    : <==    Updates: 1
2024-05-30 16:28:52.960 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:28:52.960 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:28:52.971 DEBUG 20860 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:28:53.226 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:28:53.226 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:28:53.234 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:28:53.257 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:28:53.257 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:28:53.272 DEBUG 20860 --- [http-nio-8820-exec-28] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:29:25.573 DEBUG 20860 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:29:25.573 DEBUG 20860 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:29:25.584 DEBUG 20860 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:29:25.861 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:29:25.861 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:29:25.873 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:29:25.899 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:29:25.900 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:29:25.913 DEBUG 20860 --- [http-nio-8820-exec-30] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:31:53.143  INFO 20860 --- [SpringApplicationShutdownHook] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} closing ...
2024-05-30 16:31:53.156  INFO 20860 --- [SpringApplicationShutdownHook] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} closed
2024-05-30 16:31:56.992  INFO 24104 --- [main] com.slipper.SlipperApplication           : Starting SlipperApplication using Java 1.8.0_291 on SZ-PC-PDC-135 with PID 24104 (E:\github\chatterbox-pro\target\classes started by gumingchen in E:\github\chatterbox-pro)
2024-05-30 16:31:56.994 DEBUG 24104 --- [main] com.slipper.SlipperApplication           : Running with Spring Boot v2.7.18, Spring v5.3.31
2024-05-30 16:31:56.994  INFO 24104 --- [main] com.slipper.SlipperApplication           : The following 1 profile is active: "dev"
2024-05-30 16:31:57.822  INFO 24104 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2024-05-30 16:31:57.825  INFO 24104 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2024-05-30 16:31:57.881  INFO 24104 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 42 ms. Found 0 Redis repository interfaces.
2024-05-30 16:31:58.580  INFO 24104 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8820 (http)
2024-05-30 16:31:58.589  INFO 24104 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2024-05-30 16:31:58.589  INFO 24104 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.83]
2024-05-30 16:31:58.764  INFO 24104 --- [main] o.a.c.c.C.[.[localhost].[/chatterbox]    : Initializing Spring embedded WebApplicationContext
2024-05-30 16:31:58.765  INFO 24104 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1738 ms
2024-05-30 16:31:59.250  INFO 24104 --- [main] c.a.d.s.b.a.DruidDataSourceAutoConfigure : Init DruidDataSource
2024-05-30 16:31:59.755 ERROR 24104 --- [main] c.alibaba.druid.filter.stat.StatFilter   : slow sql 113 millis. SELECT 1[]
2024-05-30 16:32:00.600  INFO 24104 --- [main] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} inited
2024-05-30 16:32:01.326 DEBUG 24104 --- [main] c.s.c.s.f.TokenAuthenticationFilter      : Filter 'tokenAuthenticationFilter' configured for use
2024-05-30 16:32:01.999  INFO 24104 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@1760e688, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@53fc870f, org.springframework.security.web.context.SecurityContextPersistenceFilter@2006fdaa, org.springframework.security.web.header.HeaderWriterFilter@17a77a7e, org.springframework.web.filter.CorsFilter@18f4086e, org.springframework.security.web.authentication.logout.LogoutFilter@b3004e, com.slipper.core.security.filter.TokenAuthenticationFilter@14b26e90, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@656c5818, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@3e2578ea, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@43cbafa6, org.springframework.security.web.session.SessionManagementFilter@5abb7a8f, org.springframework.security.web.access.ExceptionTranslationFilter@3a13f663, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@7030b74c]
2024-05-30 16:32:02.331  INFO 24104 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8820 (http) with context path '/chatterbox'
2024-05-30 16:32:02.339  INFO 24104 --- [main] com.slipper.SlipperApplication           : Started SlipperApplication in 5.848 seconds (JVM running for 6.694)
2024-05-30 16:32:02.406  INFO 24104 --- [task-executor-1] com.slipper.core.netty.WebSocketServer   : 🤝[服务器启动端口]: 8821

2024-05-30 16:32:23.575  INFO 24104 --- [http-nio-8820-exec-1] o.a.c.c.C.[.[localhost].[/chatterbox]    : Initializing Spring DispatcherServlet 'dispatcherServlet'
2024-05-30 16:32:23.575  INFO 24104 --- [http-nio-8820-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2024-05-30 16:32:23.576  INFO 24104 --- [http-nio-8820-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2024-05-30 16:32:24.258 DEBUG 24104 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:32:24.313 DEBUG 24104 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:32:24.332 DEBUG 24104 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:32:24.644 DEBUG 24104 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:32:24.645 DEBUG 24104 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:32:24.653 DEBUG 24104 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:32:24.693 DEBUG 24104 --- [http-nio-8820-exec-2] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:32:24.698 DEBUG 24104 --- [http-nio-8820-exec-2] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:32:24.713 DEBUG 24104 --- [http-nio-8820-exec-2] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:32:30.504 DEBUG 24104 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:32:30.505 DEBUG 24104 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:32:30.514 DEBUG 24104 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:32:30.714 DEBUG 24104 --- [http-nio-8820-exec-3] c.s.m.friend.mapper.FriendMapper.delete  : ==>  Preparing: UPDATE friend SET deleted=1 WHERE deleted=0 AND (user_id = ? AND friend_id = ?)
2024-05-30 16:32:30.719 DEBUG 24104 --- [http-nio-8820-exec-3] c.s.m.friend.mapper.FriendMapper.delete  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:32:30.734 DEBUG 24104 --- [http-nio-8820-exec-3] c.s.m.friend.mapper.FriendMapper.delete  : <==    Updates: 1
2024-05-30 16:32:30.742 DEBUG 24104 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 16:32:30.744 DEBUG 24104 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 16:32:30.753 DEBUG 24104 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:32:30.759 DEBUG 24104 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomFriendMapper.updateById    : ==>  Preparing: UPDATE room_friend SET status=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 16:32:30.762 DEBUG 24104 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomFriendMapper.updateById    : ==> Parameters: 0(Integer), 2024-05-30T16:32:30.759(LocalDateTime), 1(Long)
2024-05-30 16:32:30.779 DEBUG 24104 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomFriendMapper.updateById    : <==    Updates: 1
2024-05-30 16:32:32.864 DEBUG 24104 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:32:32.865 DEBUG 24104 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:32:32.875 DEBUG 24104 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:32:33.128 DEBUG 24104 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:32:33.129 DEBUG 24104 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:32:33.139 DEBUG 24104 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:32:33.155 DEBUG 24104 --- [http-nio-8820-exec-5] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:32:33.156 DEBUG 24104 --- [http-nio-8820-exec-5] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:32:33.167 DEBUG 24104 --- [http-nio-8820-exec-5] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:32:34.483 DEBUG 24104 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:32:34.484 DEBUG 24104 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:32:34.492 DEBUG 24104 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:32:34.521 DEBUG 24104 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 16:32:34.523 DEBUG 24104 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 16:32:34.535 DEBUG 24104 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 16:32:44.395 DEBUG 24104 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:32:44.396 DEBUG 24104 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:32:44.406 DEBUG 24104 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:32:44.675 DEBUG 24104 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:32:44.676 DEBUG 24104 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:32:44.687 DEBUG 24104 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:32:44.706 DEBUG 24104 --- [http-nio-8820-exec-8] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:32:44.707 DEBUG 24104 --- [http-nio-8820-exec-8] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:32:44.718 DEBUG 24104 --- [http-nio-8820-exec-8] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:33:02.993 DEBUG 24104 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:33:02.994 DEBUG 24104 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:33:03.003 DEBUG 24104 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:33:03.022 DEBUG 24104 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 16:33:03.023 DEBUG 24104 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 16:33:03.035 DEBUG 24104 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 16:33:09.672 DEBUG 24104 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:33:09.673 DEBUG 24104 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:33:09.681 DEBUG 24104 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:33:09.706 DEBUG 24104 --- [http-nio-8820-exec-10] c.s.m.f.mapper.FriendMapper.selectList   : ==>  Preparing: SELECT id,user_id,friend_id,grouping_id,remark,created_at,updated_at,deleted FROM friend WHERE deleted=0 AND (user_id = ? AND friend_id = ?) limit 1
2024-05-30 16:33:09.707 DEBUG 24104 --- [http-nio-8820-exec-10] c.s.m.f.mapper.FriendMapper.selectList   : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:33:09.715 DEBUG 24104 --- [http-nio-8820-exec-10] c.s.m.f.mapper.FriendMapper.selectList   : <==      Total: 1
2024-05-30 16:33:09.718 DEBUG 24104 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 16:33:09.719 DEBUG 24104 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 16:33:09.726 DEBUG 24104 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:33:09.728 DEBUG 24104 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:33:09.729 DEBUG 24104 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:33:09.739 DEBUG 24104 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 0
2024-05-30 16:33:09.743  WARN 24104 --- [http-nio-8820-exec-10] c.b.mybatisplus.extension.toolkit.Db     : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@681b06f3] Transaction not enabled
2024-05-30 16:33:09.745 DEBUG 24104 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.insert      : ==>  Preparing: INSERT INTO conversation ( user_id, room_id, created_at, updated_at ) VALUES ( ?, ?, ?, ? )
2024-05-30 16:33:09.752 DEBUG 24104 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.insert      : ==> Parameters: 1(Long), 2(Long), 2024-05-30T16:33:09.745(LocalDateTime), 2024-05-30T16:33:09.745(LocalDateTime)
2024-05-30 16:33:09.776 DEBUG 24104 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.queryInfo   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id = ?
2024-05-30 16:33:09.777 DEBUG 24104 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.queryInfo   : ==> Parameters: 3(Long)
2024-05-30 16:33:09.841 DEBUG 24104 --- [http-nio-8820-exec-10] c.s.m.c.m.ConversationMapper.queryInfo   : <==      Total: 1
2024-05-30 16:33:09.921 DEBUG 24104 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:33:09.921 DEBUG 24104 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:33:09.929 DEBUG 24104 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:33:09.934 DEBUG 24104 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:33:09.934 DEBUG 24104 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:33:09.945 DEBUG 24104 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:33:09.950 DEBUG 24104 --- [http-nio-8820-exec-11] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 16:33:09.952 DEBUG 24104 --- [http-nio-8820-exec-11] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 10(Long)
2024-05-30 16:33:09.962 DEBUG 24104 --- [http-nio-8820-exec-11] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 16:33:09.973 DEBUG 24104 --- [http-nio-8820-exec-12] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 16:33:09.974 DEBUG 24104 --- [http-nio-8820-exec-12] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 16:33:09.993 DEBUG 24104 --- [http-nio-8820-exec-12] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 16:33:22.177 DEBUG 24104 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:33:22.178 DEBUG 24104 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:33:22.186 DEBUG 24104 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:33:22.211 DEBUG 24104 --- [http-nio-8820-exec-13] c.s.m.friend.mapper.FriendMapper.delete  : ==>  Preparing: UPDATE friend SET deleted=1 WHERE deleted=0 AND (user_id = ? AND friend_id = ?)
2024-05-30 16:33:22.211 DEBUG 24104 --- [http-nio-8820-exec-13] c.s.m.friend.mapper.FriendMapper.delete  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:33:22.231 DEBUG 24104 --- [http-nio-8820-exec-13] c.s.m.friend.mapper.FriendMapper.delete  : <==    Updates: 1
2024-05-30 16:33:22.233 DEBUG 24104 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 16:33:22.233 DEBUG 24104 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 16:33:22.241 DEBUG 24104 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:33:22.241 DEBUG 24104 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.updateById    : ==>  Preparing: UPDATE room_friend SET status=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 16:33:22.242 DEBUG 24104 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.updateById    : ==> Parameters: 0(Integer), 2024-05-30T16:33:22.241(LocalDateTime), 1(Long)
2024-05-30 16:33:22.255 DEBUG 24104 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.updateById    : <==    Updates: 1
2024-05-30 16:33:25.413 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:33:25.414 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:33:25.424 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:33:25.457 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:33:25.458 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:33:25.465 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:33:25.468 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:33:25.469 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:33:25.478 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:33:25.480 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 16:33:25.481 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 2(Long), 0(Integer), 1(String), 2024-05-30T16:33:25.480(LocalDateTime), 2024-05-30T16:33:25.480(LocalDateTime)
2024-05-30 16:33:25.495 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 16:33:25.497 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 16:33:25.497 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 2(Long), 2024-05-30T16:33:25.497(LocalDateTime), 2(Long)
2024-05-30 16:33:25.512 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 16:33:25.513 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:33:25.513 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:33:25.520 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:33:25.521 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?)
2024-05-30 16:33:25.522 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:33:25.530 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:33:25.531 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:33:25.531 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 2(Long)
2024-05-30 16:33:25.541 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 0
2024-05-30 16:33:25.542 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.insert      : ==>  Preparing: INSERT INTO conversation ( user_id, room_id, created_at, updated_at ) VALUES ( ?, ?, ?, ? )
2024-05-30 16:33:25.542 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.insert      : ==> Parameters: 2(Long), 2(Long), 2024-05-30T16:33:25.542(LocalDateTime), 2024-05-30T16:33:25.542(LocalDateTime)
2024-05-30 16:33:25.561 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 16:33:25.562 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 4(Long)
2024-05-30 16:33:25.574 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 16:33:25.583 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 16:33:25.584 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 2(Long), 1(Long)
2024-05-30 16:33:25.594 DEBUG 24104 --- [http-nio-8820-exec-14] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 16:40:01.367 ERROR 24104 --- [Druid-ConnectionPool-Destroy-1946962024] c.alibaba.druid.filter.stat.StatFilter   : slow sql 243 millis. SELECT 1[]
2024-05-30 16:43:01.653 ERROR 24104 --- [Druid-ConnectionPool-Destroy-1946962024] c.alibaba.druid.filter.stat.StatFilter   : slow sql 155 millis. SELECT 1[]
2024-05-30 16:43:25.877  INFO 24104 --- [SpringApplicationShutdownHook] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} closing ...
2024-05-30 16:43:25.881  INFO 24104 --- [SpringApplicationShutdownHook] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} closed
2024-05-30 16:43:31.544  INFO 26812 --- [main] com.slipper.SlipperApplication           : Starting SlipperApplication using Java 1.8.0_291 on SZ-PC-PDC-135 with PID 26812 (E:\github\chatterbox-pro\target\classes started by gumingchen in E:\github\chatterbox-pro)
2024-05-30 16:43:31.546 DEBUG 26812 --- [main] com.slipper.SlipperApplication           : Running with Spring Boot v2.7.18, Spring v5.3.31
2024-05-30 16:43:31.547  INFO 26812 --- [main] com.slipper.SlipperApplication           : The following 1 profile is active: "dev"
2024-05-30 16:43:32.221  INFO 26812 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2024-05-30 16:43:32.222  INFO 26812 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2024-05-30 16:43:32.271  INFO 26812 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 37 ms. Found 0 Redis repository interfaces.
2024-05-30 16:43:32.919  INFO 26812 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8820 (http)
2024-05-30 16:43:32.927  INFO 26812 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2024-05-30 16:43:32.927  INFO 26812 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.83]
2024-05-30 16:43:33.065  INFO 26812 --- [main] o.a.c.c.C.[.[localhost].[/chatterbox]    : Initializing Spring embedded WebApplicationContext
2024-05-30 16:43:33.066  INFO 26812 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1490 ms
2024-05-30 16:43:33.531  INFO 26812 --- [main] c.a.d.s.b.a.DruidDataSourceAutoConfigure : Init DruidDataSource
2024-05-30 16:43:34.040 ERROR 26812 --- [main] c.alibaba.druid.filter.stat.StatFilter   : slow sql 113 millis. SELECT 1[]
2024-05-30 16:43:34.948  INFO 26812 --- [main] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} inited
2024-05-30 16:43:35.638 DEBUG 26812 --- [main] c.s.c.s.f.TokenAuthenticationFilter      : Filter 'tokenAuthenticationFilter' configured for use
2024-05-30 16:43:36.271  INFO 26812 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@39004e4f, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@5f0ca069, org.springframework.security.web.context.SecurityContextPersistenceFilter@b8142f4, org.springframework.security.web.header.HeaderWriterFilter@6eb5b9e7, org.springframework.web.filter.CorsFilter@6a6a2fdd, org.springframework.security.web.authentication.logout.LogoutFilter@41b66d1, com.slipper.core.security.filter.TokenAuthenticationFilter@1a67f8b4, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@4d75c604, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@3265995e, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@552ffa44, org.springframework.security.web.session.SessionManagementFilter@45539bd8, org.springframework.security.web.access.ExceptionTranslationFilter@3c3cd7a5, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@c89e263]
2024-05-30 16:43:36.581  INFO 26812 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8820 (http) with context path '/chatterbox'
2024-05-30 16:43:36.589  INFO 26812 --- [main] com.slipper.SlipperApplication           : Started SlipperApplication in 5.432 seconds (JVM running for 6.108)
2024-05-30 16:43:36.648  INFO 26812 --- [task-executor-1] com.slipper.core.netty.WebSocketServer   : 🤝[服务器启动端口]: 8821

2024-05-30 16:43:40.548  INFO 26812 --- [http-nio-8820-exec-2] o.a.c.c.C.[.[localhost].[/chatterbox]    : Initializing Spring DispatcherServlet 'dispatcherServlet'
2024-05-30 16:43:40.548  INFO 26812 --- [http-nio-8820-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2024-05-30 16:43:40.550  INFO 26812 --- [http-nio-8820-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
2024-05-30 16:43:41.171 DEBUG 26812 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:43:41.234 DEBUG 26812 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:43:41.253 DEBUG 26812 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:43:41.611 DEBUG 26812 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:43:41.611 DEBUG 26812 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:43:41.623 DEBUG 26812 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:43:41.666 DEBUG 26812 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 16:43:41.674 DEBUG 26812 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 16:43:41.689 DEBUG 26812 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 2
2024-05-30 16:44:22.805 DEBUG 26812 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:44:22.807 DEBUG 26812 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:44:22.808 DEBUG 26812 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:44:22.809 DEBUG 26812 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:44:22.818 DEBUG 26812 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:44:22.820 DEBUG 26812 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:44:22.896 DEBUG 26812 --- [http-nio-8820-exec-3] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 16:44:22.896 DEBUG 26812 --- [http-nio-8820-exec-3] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 16:44:22.921 DEBUG 26812 --- [http-nio-8820-exec-3] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 16:44:22.922 DEBUG 26812 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 16:44:22.923 DEBUG 26812 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 10(Long)
2024-05-30 16:44:22.934 DEBUG 26812 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 1
2024-05-30 16:44:24.517 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:44:24.517 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:44:24.527 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:44:24.571 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:44:24.571 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:44:24.581 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:44:24.596 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:44:24.597 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:44:24.608 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:44:24.611 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:44:24.611 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:44:24.621 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:44:24.628 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:44:24.629 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:44:24.639 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:44:24.644 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 16:44:24.652 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 2(Long), 0(Integer), 1(String), 2024-05-30T16:44:24.644(LocalDateTime), 2024-05-30T16:44:24.644(LocalDateTime)
2024-05-30 16:44:24.671 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 16:44:24.674 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 16:44:24.677 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 3(Long), 2024-05-30T16:44:24.674(LocalDateTime), 2(Long)
2024-05-30 16:44:24.695 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 16:44:24.696 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:44:24.696 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:44:24.704 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:44:24.706 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?)
2024-05-30 16:44:24.707 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:44:24.716 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:44:24.721 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:44:24.722 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 2(Long)
2024-05-30 16:44:24.732 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 16:44:24.734 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 16:44:24.737 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 4(Long)
2024-05-30 16:44:24.753 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 16:44:24.815 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 16:44:24.817 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 2(Long), 1(Long)
2024-05-30 16:44:24.828 DEBUG 26812 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 16:45:09.558  INFO 26812 --- [SpringApplicationShutdownHook] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} closing ...
2024-05-30 16:45:09.562  INFO 26812 --- [SpringApplicationShutdownHook] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} closed
2024-05-30 16:45:14.030  INFO 10120 --- [main] com.slipper.SlipperApplication           : Starting SlipperApplication using Java 1.8.0_291 on SZ-PC-PDC-135 with PID 10120 (E:\github\chatterbox-pro\target\classes started by gumingchen in E:\github\chatterbox-pro)
2024-05-30 16:45:14.032 DEBUG 10120 --- [main] com.slipper.SlipperApplication           : Running with Spring Boot v2.7.18, Spring v5.3.31
2024-05-30 16:45:14.032  INFO 10120 --- [main] com.slipper.SlipperApplication           : The following 1 profile is active: "dev"
2024-05-30 16:45:14.682  INFO 10120 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2024-05-30 16:45:14.684  INFO 10120 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2024-05-30 16:45:14.734  INFO 10120 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 39 ms. Found 0 Redis repository interfaces.
2024-05-30 16:45:15.327  INFO 10120 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8820 (http)
2024-05-30 16:45:15.333  INFO 10120 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2024-05-30 16:45:15.333  INFO 10120 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.83]
2024-05-30 16:45:15.474  INFO 10120 --- [main] o.a.c.c.C.[.[localhost].[/chatterbox]    : Initializing Spring embedded WebApplicationContext
2024-05-30 16:45:15.474  INFO 10120 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1411 ms
2024-05-30 16:45:15.925  INFO 10120 --- [main] c.a.d.s.b.a.DruidDataSourceAutoConfigure : Init DruidDataSource
2024-05-30 16:45:16.411 ERROR 10120 --- [main] c.alibaba.druid.filter.stat.StatFilter   : slow sql 108 millis. SELECT 1[]
2024-05-30 16:45:17.253  INFO 10120 --- [main] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} inited
2024-05-30 16:45:18.020 DEBUG 10120 --- [main] c.s.c.s.f.TokenAuthenticationFilter      : Filter 'tokenAuthenticationFilter' configured for use
2024-05-30 16:45:18.650  INFO 10120 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@7474196, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@11ee671f, org.springframework.security.web.context.SecurityContextPersistenceFilter@7381d6f0, org.springframework.security.web.header.HeaderWriterFilter@b671dda, org.springframework.web.filter.CorsFilter@18209303, org.springframework.security.web.authentication.logout.LogoutFilter@7294a684, com.slipper.core.security.filter.TokenAuthenticationFilter@7b2d58e6, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@7c03f9d0, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@6ad3fbe4, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@57df09a7, org.springframework.security.web.session.SessionManagementFilter@7c840fe3, org.springframework.security.web.access.ExceptionTranslationFilter@4c164f81, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@43719e98]
2024-05-30 16:45:18.961  INFO 10120 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8820 (http) with context path '/chatterbox'
2024-05-30 16:45:18.969  INFO 10120 --- [main] com.slipper.SlipperApplication           : Started SlipperApplication in 5.321 seconds (JVM running for 6.002)
2024-05-30 16:45:19.029  INFO 10120 --- [task-executor-1] com.slipper.core.netty.WebSocketServer   : 🤝[服务器启动端口]: 8821

2024-05-30 16:45:21.784  INFO 10120 --- [http-nio-8820-exec-2] o.a.c.c.C.[.[localhost].[/chatterbox]    : Initializing Spring DispatcherServlet 'dispatcherServlet'
2024-05-30 16:45:21.785  INFO 10120 --- [http-nio-8820-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2024-05-30 16:45:21.786  INFO 10120 --- [http-nio-8820-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2024-05-30 16:45:22.474 DEBUG 10120 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:45:22.528 DEBUG 10120 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:45:22.546 DEBUG 10120 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:45:22.932 DEBUG 10120 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:45:22.933 DEBUG 10120 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:45:22.968 DEBUG 10120 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:45:23.080 DEBUG 10120 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 16:45:23.087 DEBUG 10120 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 16:45:23.163 DEBUG 10120 --- [http-nio-8820-exec-3] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 2
2024-05-30 16:45:23.923 DEBUG 10120 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:45:23.923 DEBUG 10120 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:45:23.924 DEBUG 10120 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:45:23.924 DEBUG 10120 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:45:23.932 DEBUG 10120 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:45:23.932 DEBUG 10120 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:45:23.983 DEBUG 10120 --- [http-nio-8820-exec-4] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 16:45:23.983 DEBUG 10120 --- [http-nio-8820-exec-4] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 16:45:24.005 DEBUG 10120 --- [http-nio-8820-exec-4] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 16:45:24.010 DEBUG 10120 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 16:45:24.012 DEBUG 10120 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 10(Long)
2024-05-30 16:45:24.023 DEBUG 10120 --- [http-nio-8820-exec-1] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 2
2024-05-30 16:45:25.228 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:45:25.228 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:45:25.238 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:45:25.272 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:45:25.272 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:45:25.281 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:45:25.297 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:45:25.298 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:45:25.306 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:45:25.309 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:45:25.310 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:45:25.318 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:45:25.326 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:45:25.327 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:45:25.334 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:45:25.340 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 16:45:25.348 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 2(Long), 0(Integer), 1(String), 2024-05-30T16:45:25.339(LocalDateTime), 2024-05-30T16:45:25.339(LocalDateTime)
2024-05-30 16:45:25.362 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 16:45:25.366 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 16:45:25.368 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 4(Long), 2024-05-30T16:45:25.365(LocalDateTime), 2(Long)
2024-05-30 16:45:25.383 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 16:45:25.384 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:45:25.384 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:45:25.391 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:45:25.394 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?)
2024-05-30 16:45:25.395 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:45:25.402 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:45:25.407 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:45:25.408 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 2(Long)
2024-05-30 16:45:25.416 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 16:45:25.418 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 16:45:25.420 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 4(Long)
2024-05-30 16:45:25.432 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 16:45:25.501 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 16:45:25.504 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 2(Long), 1(Long)
2024-05-30 16:45:25.513 DEBUG 10120 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 16:45:36.573 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:45:36.574 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:45:36.582 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:45:36.590 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:45:36.591 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:45:36.597 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:45:36.599 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:45:36.599 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:45:36.607 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:45:36.608 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:45:36.608 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:45:36.616 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:45:48.416 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:45:48.417 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:45:48.426 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:46:28.727 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 16:46:28.728 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 2(Long), 0(Integer), 2(String), 2024-05-30T16:46:28.726(LocalDateTime), 2024-05-30T16:46:28.726(LocalDateTime)
2024-05-30 16:46:28.744 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 16:46:28.745 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 16:46:28.746 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 5(Long), 2024-05-30T16:46:28.745(LocalDateTime), 2(Long)
2024-05-30 16:46:28.762 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 16:46:28.763 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:46:28.763 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:46:28.773 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:46:28.774 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?)
2024-05-30 16:46:28.774 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:46:28.781 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:46:28.783 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:46:28.784 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 2(Long)
2024-05-30 16:46:28.795 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 16:46:28.796 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 16:46:28.797 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 4(Long)
2024-05-30 16:46:28.808 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 16:46:28.812 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 16:46:28.814 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 2(Long), 1(Long)
2024-05-30 16:46:28.824 DEBUG 10120 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 16:46:28.944  INFO 10120 --- [SpringApplicationShutdownHook] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} closing ...
2024-05-30 16:46:28.949  INFO 10120 --- [SpringApplicationShutdownHook] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} closed
2024-05-30 16:46:33.304  INFO 10784 --- [main] com.slipper.SlipperApplication           : Starting SlipperApplication using Java 1.8.0_291 on SZ-PC-PDC-135 with PID 10784 (E:\github\chatterbox-pro\target\classes started by gumingchen in E:\github\chatterbox-pro)
2024-05-30 16:46:33.306 DEBUG 10784 --- [main] com.slipper.SlipperApplication           : Running with Spring Boot v2.7.18, Spring v5.3.31
2024-05-30 16:46:33.307  INFO 10784 --- [main] com.slipper.SlipperApplication           : The following 1 profile is active: "dev"
2024-05-30 16:46:33.944  INFO 10784 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2024-05-30 16:46:33.945  INFO 10784 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2024-05-30 16:46:33.994  INFO 10784 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 38 ms. Found 0 Redis repository interfaces.
2024-05-30 16:46:34.573  INFO 10784 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8820 (http)
2024-05-30 16:46:34.580  INFO 10784 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2024-05-30 16:46:34.580  INFO 10784 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.83]
2024-05-30 16:46:34.706  INFO 10784 --- [main] o.a.c.c.C.[.[localhost].[/chatterbox]    : Initializing Spring embedded WebApplicationContext
2024-05-30 16:46:34.706  INFO 10784 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1369 ms
2024-05-30 16:46:35.144  INFO 10784 --- [main] c.a.d.s.b.a.DruidDataSourceAutoConfigure : Init DruidDataSource
2024-05-30 16:46:35.638 ERROR 10784 --- [main] c.alibaba.druid.filter.stat.StatFilter   : slow sql 106 millis. SELECT 1[]
2024-05-30 16:46:36.617  INFO 10784 --- [main] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} inited
2024-05-30 16:46:37.308 DEBUG 10784 --- [main] c.s.c.s.f.TokenAuthenticationFilter      : Filter 'tokenAuthenticationFilter' configured for use
2024-05-30 16:46:37.945  INFO 10784 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@5e2b512b, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@ba87c11, org.springframework.security.web.context.SecurityContextPersistenceFilter@611587f7, org.springframework.security.web.header.HeaderWriterFilter@17332039, org.springframework.web.filter.CorsFilter@17d19538, org.springframework.security.web.authentication.logout.LogoutFilter@23933031, com.slipper.core.security.filter.TokenAuthenticationFilter@1cb44a2f, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@6ab1f85b, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@10e8c7a2, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@6068cda1, org.springframework.security.web.session.SessionManagementFilter@6968bb65, org.springframework.security.web.access.ExceptionTranslationFilter@6badb08c, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@6dbeaef8]
2024-05-30 16:46:38.254  INFO 10784 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8820 (http) with context path '/chatterbox'
2024-05-30 16:46:38.262  INFO 10784 --- [main] com.slipper.SlipperApplication           : Started SlipperApplication in 5.342 seconds (JVM running for 5.997)
2024-05-30 16:46:38.333  INFO 10784 --- [task-executor-1] com.slipper.core.netty.WebSocketServer   : 🤝[服务器启动端口]: 8821

2024-05-30 16:47:01.169  INFO 10784 --- [http-nio-8820-exec-1] o.a.c.c.C.[.[localhost].[/chatterbox]    : Initializing Spring DispatcherServlet 'dispatcherServlet'
2024-05-30 16:47:01.169  INFO 10784 --- [http-nio-8820-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2024-05-30 16:47:01.171  INFO 10784 --- [http-nio-8820-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
2024-05-30 16:47:01.744 DEBUG 10784 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:47:01.808 DEBUG 10784 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:47:01.831 DEBUG 10784 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:47:02.181 DEBUG 10784 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:47:02.182 DEBUG 10784 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:47:02.241 DEBUG 10784 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:47:02.275 DEBUG 10784 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 16:47:02.283 DEBUG 10784 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 16:47:02.297 DEBUG 10784 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 2
2024-05-30 16:47:02.799 DEBUG 10784 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:47:02.799 DEBUG 10784 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:47:02.799 DEBUG 10784 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:47:02.799 DEBUG 10784 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:47:02.809 DEBUG 10784 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:47:02.809 DEBUG 10784 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:47:02.867 DEBUG 10784 --- [http-nio-8820-exec-4] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 16:47:02.868 DEBUG 10784 --- [http-nio-8820-exec-4] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 16:47:02.890 DEBUG 10784 --- [http-nio-8820-exec-4] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 16:47:02.904 DEBUG 10784 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 16:47:02.906 DEBUG 10784 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 10(Long)
2024-05-30 16:47:02.918 DEBUG 10784 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 4
2024-05-30 16:47:04.536 DEBUG 10784 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:47:04.537 DEBUG 10784 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:47:04.550 DEBUG 10784 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:47:04.592 DEBUG 10784 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:47:04.593 DEBUG 10784 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:47:04.611 DEBUG 10784 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:47:04.627 DEBUG 10784 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:47:04.628 DEBUG 10784 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:47:04.642 DEBUG 10784 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:47:04.645 DEBUG 10784 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:47:04.646 DEBUG 10784 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:47:04.659 DEBUG 10784 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:47:08.151 DEBUG 10784 --- [http-nio-8820-exec-5] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:47:08.152 DEBUG 10784 --- [http-nio-8820-exec-5] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:47:08.160 DEBUG 10784 --- [http-nio-8820-exec-5] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:47:08.643 ERROR 10784 --- [http-nio-8820-exec-5] com.slipper.handler.RunExceptionHandler  : 已经互为好友，请勿重复申请！

com.slipper.exception.RunException: 已经互为好友，请勿重复申请！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$d47e4b5d.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:47:27.482  INFO 10784 --- [SpringApplicationShutdownHook] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} closing ...
2024-05-30 16:47:27.487  INFO 10784 --- [SpringApplicationShutdownHook] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} closed
2024-05-30 16:47:31.973  INFO 20236 --- [main] com.slipper.SlipperApplication           : Starting SlipperApplication using Java 1.8.0_291 on SZ-PC-PDC-135 with PID 20236 (E:\github\chatterbox-pro\target\classes started by gumingchen in E:\github\chatterbox-pro)
2024-05-30 16:47:31.975 DEBUG 20236 --- [main] com.slipper.SlipperApplication           : Running with Spring Boot v2.7.18, Spring v5.3.31
2024-05-30 16:47:31.975  INFO 20236 --- [main] com.slipper.SlipperApplication           : The following 1 profile is active: "dev"
2024-05-30 16:47:32.593  INFO 20236 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2024-05-30 16:47:32.595  INFO 20236 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2024-05-30 16:47:32.644  INFO 20236 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 38 ms. Found 0 Redis repository interfaces.
2024-05-30 16:47:33.221  INFO 20236 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8820 (http)
2024-05-30 16:47:33.227  INFO 20236 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2024-05-30 16:47:33.228  INFO 20236 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.83]
2024-05-30 16:47:33.360  INFO 20236 --- [main] o.a.c.c.C.[.[localhost].[/chatterbox]    : Initializing Spring embedded WebApplicationContext
2024-05-30 16:47:33.360  INFO 20236 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1355 ms
2024-05-30 16:47:33.792  INFO 20236 --- [main] c.a.d.s.b.a.DruidDataSourceAutoConfigure : Init DruidDataSource
2024-05-30 16:47:34.280 ERROR 20236 --- [main] c.alibaba.druid.filter.stat.StatFilter   : slow sql 107 millis. SELECT 1[]
2024-05-30 16:47:35.121  INFO 20236 --- [main] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} inited
2024-05-30 16:47:35.809 DEBUG 20236 --- [main] c.s.c.s.f.TokenAuthenticationFilter      : Filter 'tokenAuthenticationFilter' configured for use
2024-05-30 16:47:36.432  INFO 20236 --- [main] o.s.s.web.DefaultSecurityFilterChain     : Will secure any request with [org.springframework.security.web.session.DisableEncodeUrlFilter@6bd2f039, org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@6c8ad6d7, org.springframework.security.web.context.SecurityContextPersistenceFilter@65a80fdb, org.springframework.security.web.header.HeaderWriterFilter@6684589a, org.springframework.web.filter.CorsFilter@2d0778d0, org.springframework.security.web.authentication.logout.LogoutFilter@7f894a6f, com.slipper.core.security.filter.TokenAuthenticationFilter@1e194966, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@7d551ec6, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@6614ecca, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@33e8694b, org.springframework.security.web.session.SessionManagementFilter@303fbc4, org.springframework.security.web.access.ExceptionTranslationFilter@5d15789f, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@53fc870f]
2024-05-30 16:47:36.738  INFO 20236 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8820 (http) with context path '/chatterbox'
2024-05-30 16:47:36.747  INFO 20236 --- [main] com.slipper.SlipperApplication           : Started SlipperApplication in 5.154 seconds (JVM running for 5.809)
2024-05-30 16:47:36.806  INFO 20236 --- [task-executor-1] com.slipper.core.netty.WebSocketServer   : 🤝[服务器启动端口]: 8821

2024-05-30 16:47:40.327  INFO 20236 --- [http-nio-8820-exec-2] o.a.c.c.C.[.[localhost].[/chatterbox]    : Initializing Spring DispatcherServlet 'dispatcherServlet'
2024-05-30 16:47:40.327  INFO 20236 --- [http-nio-8820-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2024-05-30 16:47:40.328  INFO 20236 --- [http-nio-8820-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2024-05-30 16:47:40.872 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:47:40.921 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:47:40.940 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:47:41.041 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:47:41.041 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:47:41.051 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:47:41.088 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:47:41.090 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:47:41.099 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:47:41.102 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:47:41.103 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:47:41.110 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:47:41.139 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:47:41.140 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:47:41.148 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:47:41.167 ERROR 20236 --- [http-nio-8820-exec-2] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:47:42.753 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:47:42.753 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:47:42.763 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:47:42.774 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:47:42.775 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:47:42.781 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:47:42.783 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:47:42.783 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:47:42.790 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:47:42.791 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:47:42.792 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:47:42.799 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:47:42.801 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:47:42.801 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:47:42.809 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:47:42.824 ERROR 20236 --- [http-nio-8820-exec-3] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:47:44.093 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:47:44.093 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:47:44.101 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:47:44.110 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:47:44.110 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:47:44.119 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:47:44.120 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:47:44.121 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:47:44.129 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:47:44.130 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:47:44.131 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:47:44.139 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:47:44.140 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:47:44.140 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:47:44.148 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:47:44.162 ERROR 20236 --- [http-nio-8820-exec-1] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:47:45.751 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:47:45.752 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:47:45.764 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:47:45.782 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 16:47:45.785 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 16:47:45.795 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 1
2024-05-30 16:47:46.632 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:47:46.632 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:47:46.640 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:47:46.650 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:47:46.651 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:47:46.660 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:47:46.665 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:47:46.665 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 16:47:46.674 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 16:47:46.679 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 16:47:46.679 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 16:47:46.688 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 16:47:46.689 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:47:46.689 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long)
2024-05-30 16:47:46.696 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 0
2024-05-30 16:47:46.702 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 16:47:46.710 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 3(String), 2024-05-30T16:47:46.702(LocalDateTime), 2024-05-30T16:47:46.702(LocalDateTime)
2024-05-30 16:47:46.727 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 16:47:46.730 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 16:47:46.733 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 6(Long), 2024-05-30T16:47:46.730(LocalDateTime), 1(Long)
2024-05-30 16:47:46.750 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 16:47:46.750 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:47:46.751 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:47:46.760 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:47:46.762 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 16:47:46.762 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 16:47:46.770 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 16:47:46.771 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 16:47:46.771 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 16:47:46.781 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 16:47:46.789 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:47:46.789 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 16:47:46.798 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 16:47:46.801 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 16:47:46.802 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 16:47:46.813 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 16:47:46.862 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 16:47:46.863 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 16:47:46.874 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 16:47:48.169 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:47:48.169 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:47:48.179 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:47:48.191 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:47:48.191 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:47:48.199 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:47:48.201 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:47:48.201 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 16:47:48.211 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 16:47:48.212 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 16:47:48.213 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 16:47:48.221 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 16:47:48.223 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:47:48.223 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long)
2024-05-30 16:47:48.231 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 0
2024-05-30 16:47:48.232 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 16:47:48.233 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T16:47:48.232(LocalDateTime), 2024-05-30T16:47:48.232(LocalDateTime)
2024-05-30 16:47:48.250 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 16:47:48.251 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 16:47:48.251 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 7(Long), 2024-05-30T16:47:48.250(LocalDateTime), 1(Long)
2024-05-30 16:47:48.268 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 16:47:48.269 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:47:48.269 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:47:48.278 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:47:48.279 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 16:47:48.280 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 16:47:48.289 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 16:47:48.290 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 16:47:48.291 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 16:47:48.300 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 16:47:48.301 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:47:48.302 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 16:47:48.312 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 16:47:48.313 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 16:47:48.313 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 16:47:48.324 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 16:47:48.327 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 16:47:48.328 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 16:47:48.339 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 16:47:49.190 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:47:49.190 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:47:49.199 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:47:49.210 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:47:49.210 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:47:49.219 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:47:49.220 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:47:49.221 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 16:47:49.229 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 16:47:49.230 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 16:47:49.230 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 16:47:49.237 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 16:47:49.238 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:47:49.238 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long)
2024-05-30 16:47:49.247 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 0
2024-05-30 16:47:49.248 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 16:47:49.248 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 2(String), 2024-05-30T16:47:49.247(LocalDateTime), 2024-05-30T16:47:49.247(LocalDateTime)
2024-05-30 16:47:49.261 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 16:47:49.262 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 16:47:49.262 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 8(Long), 2024-05-30T16:47:49.262(LocalDateTime), 1(Long)
2024-05-30 16:47:49.290 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 16:47:49.291 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:47:49.291 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:47:49.301 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:47:49.302 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 16:47:49.302 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 16:47:49.311 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 16:47:49.312 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 16:47:49.312 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 16:47:49.320 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 16:47:49.321 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:47:49.321 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 16:47:49.331 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 16:47:49.331 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 16:47:49.332 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 16:47:49.343 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 16:47:49.345 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 16:47:49.346 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 16:47:49.356 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 16:48:23.206 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:48:23.207 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:48:23.216 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:48:23.530 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:48:23.530 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:48:23.540 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:48:23.575 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 16:48:23.576 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 16:48:23.590 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 16:48:24.737 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:48:24.737 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:48:24.743 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:48:24.744 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:48:24.747 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:48:24.749 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 16:48:24.750 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 16:48:24.754 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:48:24.757 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 1
2024-05-30 16:48:24.783 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 16:48:24.784 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 16:48:24.800 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 16:48:29.030 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:48:29.031 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:48:29.040 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:48:29.049 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:48:29.049 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:48:29.060 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:48:29.061 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:48:29.061 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 16:48:29.071 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 16:48:29.072 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectCount                  : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_group__user WHERE deleted=0 AND (room_group_id = ? AND user_id = ?)
2024-05-30 16:48:29.072 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectCount                  : ==> Parameters: 1(Long), 1(Long)
2024-05-30 16:48:29.082 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectCount                  : <==      Total: 1
2024-05-30 16:48:29.083 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:48:29.083 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long)
2024-05-30 16:48:29.092 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 0
2024-05-30 16:48:29.093 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 16:48:29.093 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 1(Long), 0(Integer), 1(String), 2024-05-30T16:48:29.092(LocalDateTime), 2024-05-30T16:48:29.092(LocalDateTime)
2024-05-30 16:48:29.111 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 16:48:29.112 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 16:48:29.112 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 2(Long), 2024-05-30T16:48:29.112(LocalDateTime), 1(Long)
2024-05-30 16:48:29.128 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 16:48:29.129 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:48:29.129 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:48:29.138 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:48:29.139 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==>  Preparing: SELECT id,room_id,name,avatar,created_at,updated_at,deleted FROM room_group WHERE deleted=0 AND (room_id = ?)
2024-05-30 16:48:29.140 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : ==> Parameters: 1(Long)
2024-05-30 16:48:29.149 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomGroupMapper.selectList     : <==      Total: 1
2024-05-30 16:48:29.150 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectList                   : ==>  Preparing: SELECT id,room_group_id,user_id,nickname,role,status,created_at,updated_at,deleted FROM room_group__user WHERE deleted=0 AND (room_group_id = ?)
2024-05-30 16:48:29.151 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectList                   : ==> Parameters: 1(Long)
2024-05-30 16:48:29.160 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.R.selectList                   : <==      Total: 2
2024-05-30 16:48:29.161 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:48:29.162 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 1(Long)
2024-05-30 16:48:29.168 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 16:48:29.169 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 16:48:29.170 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 2(Long)
2024-05-30 16:48:29.182 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 16:48:29.183 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 16:48:29.184 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 1(Long), 1(Long)
2024-05-30 16:48:29.196 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 16:48:30.171 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:48:30.171 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:48:30.181 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:48:30.205 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:48:30.206 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:48:30.217 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:48:32.365 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:48:32.365 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:48:32.374 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:48:32.401 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.f.mapper.FriendMapper.selectList   : ==>  Preparing: SELECT id,user_id,friend_id,grouping_id,remark,created_at,updated_at,deleted FROM friend WHERE deleted=0 AND (user_id = ? AND friend_id = ?) limit 1
2024-05-30 16:48:32.401 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.f.mapper.FriendMapper.selectList   : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:48:32.410 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.f.mapper.FriendMapper.selectList   : <==      Total: 1
2024-05-30 16:48:32.412 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 16:48:32.412 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 16:48:32.427 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:48:32.428 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:48:32.429 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:48:32.436 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 0
2024-05-30 16:48:32.440  WARN 20236 --- [http-nio-8820-exec-14] c.b.mybatisplus.extension.toolkit.Db     : SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6b1cae07] Transaction not enabled
2024-05-30 16:48:32.441 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.insert      : ==>  Preparing: INSERT INTO conversation ( user_id, room_id, created_at, updated_at ) VALUES ( ?, ?, ?, ? )
2024-05-30 16:48:32.441 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.insert      : ==> Parameters: 1(Long), 2(Long), 2024-05-30T16:48:32.440(LocalDateTime), 2024-05-30T16:48:32.440(LocalDateTime)
2024-05-30 16:48:32.470 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.queryInfo   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id = ?
2024-05-30 16:48:32.472 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.queryInfo   : ==> Parameters: 3(Long)
2024-05-30 16:48:32.484 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.c.m.ConversationMapper.queryInfo   : <==      Total: 1
2024-05-30 16:48:32.551 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:48:32.552 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:48:32.565 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:48:32.567 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 16:48:32.568 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 10(Long)
2024-05-30 16:48:32.577 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 0
2024-05-30 16:48:33.551 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:48:33.552 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:48:33.562 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:48:33.572 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:48:33.573 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:48:33.581 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:48:33.583 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:48:33.583 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:48:33.600 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:48:33.601 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:48:33.602 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:48:33.611 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:48:33.613 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:48:33.613 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:48:33.624 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:48:33.625 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 16:48:33.626 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 2(Long), 0(Integer), 2(String), 2024-05-30T16:48:33.625(LocalDateTime), 2024-05-30T16:48:33.625(LocalDateTime)
2024-05-30 16:48:33.642 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 16:48:33.643 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 16:48:33.644 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 3(Long), 2024-05-30T16:48:33.643(LocalDateTime), 2(Long)
2024-05-30 16:48:33.663 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 16:48:33.664 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:48:33.664 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:48:33.672 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:48:33.673 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?)
2024-05-30 16:48:33.674 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:48:33.683 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:48:33.685 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:48:33.685 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 2(Long)
2024-05-30 16:48:33.693 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 0
2024-05-30 16:48:33.694 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.insert      : ==>  Preparing: INSERT INTO conversation ( user_id, room_id, created_at, updated_at ) VALUES ( ?, ?, ?, ? )
2024-05-30 16:48:33.695 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.c.m.ConversationMapper.insert      : ==> Parameters: 2(Long), 2(Long), 2024-05-30T16:48:33.694(LocalDateTime), 2024-05-30T16:48:33.694(LocalDateTime)
2024-05-30 16:48:33.713 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 16:48:33.713 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 4(Long)
2024-05-30 16:48:33.724 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 16:48:33.726 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 16:48:33.727 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 2(Long), 1(Long)
2024-05-30 16:48:33.740 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 16:48:35.077 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:48:35.078 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:48:35.087 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:48:35.097 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:48:35.097 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:48:35.104 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:48:35.105 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:48:35.105 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:48:35.114 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:48:35.115 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:48:35.116 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:48:35.125 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:48:35.126 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:48:35.126 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:48:35.134 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:48:35.136 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 16:48:35.136 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 2(Long), 0(Integer), 3(String), 2024-05-30T16:48:35.135(LocalDateTime), 2024-05-30T16:48:35.135(LocalDateTime)
2024-05-30 16:48:35.154 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 16:48:35.154 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 16:48:35.155 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 4(Long), 2024-05-30T16:48:35.154(LocalDateTime), 2(Long)
2024-05-30 16:48:35.171 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 16:48:35.172 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:48:35.172 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:48:35.181 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:48:35.182 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?)
2024-05-30 16:48:35.183 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:48:35.191 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:48:35.192 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:48:35.192 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 2(Long)
2024-05-30 16:48:35.201 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 16:48:35.201 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 16:48:35.201 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 4(Long)
2024-05-30 16:48:35.213 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 16:48:35.216 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 16:48:35.216 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 2(Long), 1(Long)
2024-05-30 16:48:35.229 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 16:48:36.734 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:48:36.734 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:48:36.745 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:48:36.757 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:48:36.757 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:48:36.767 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:48:36.768 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:48:36.768 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:48:36.778 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:48:36.779 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:48:36.780 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:48:36.790 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:48:36.791 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:48:36.791 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:48:36.799 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:48:36.800 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : ==>  Preparing: INSERT INTO message ( user_id, room_id, type, text, created_at, updated_at ) VALUES ( ?, ?, ?, ?, ?, ? )
2024-05-30 16:48:36.800 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : ==> Parameters: 1(Long), 2(Long), 0(Integer), 13(String), 2024-05-30T16:48:36.800(LocalDateTime), 2024-05-30T16:48:36.800(LocalDateTime)
2024-05-30 16:48:36.818 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.m.mapper.MessageMapper.insert      : <==    Updates: 1
2024-05-30 16:48:36.819 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : ==>  Preparing: UPDATE room SET last_message_id=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 16:48:36.820 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : ==> Parameters: 5(Long), 2024-05-30T16:48:36.819(LocalDateTime), 2(Long)
2024-05-30 16:48:36.836 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.updateById  : <==    Updates: 1
2024-05-30 16:48:36.837 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:48:36.837 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:48:36.847 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:48:36.848 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?)
2024-05-30 16:48:36.848 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:48:36.858 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:48:36.859 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : ==>  Preparing: SELECT id,user_id,room_id,created_at,updated_at,deleted FROM conversation WHERE deleted=0 AND (user_id = ? AND room_id = ?) limit 1
2024-05-30 16:48:36.859 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : ==> Parameters: 2(Long), 2(Long)
2024-05-30 16:48:36.867 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.c.m.ConversationMapper.selectList  : <==      Total: 1
2024-05-30 16:48:36.868 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.id IN ( ? )
2024-05-30 16:48:36.868 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : ==> Parameters: 4(Long)
2024-05-30 16:48:36.882 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryListByIds               : <==      Total: 1
2024-05-30 16:48:36.884 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.room_id = ? AND c.user_id = ?
2024-05-30 16:48:36.885 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : ==> Parameters: 2(Long), 1(Long)
2024-05-30 16:48:36.895 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.c.m.C.queryInfoByRoomIdAndUserId   : <==      Total: 1
2024-05-30 16:48:39.703 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:48:39.704 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:48:39.712 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:48:39.746 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.friend.mapper.FriendMapper.delete  : ==>  Preparing: UPDATE friend SET deleted=1 WHERE deleted=0 AND (user_id = ? AND friend_id = ?)
2024-05-30 16:48:39.746 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.friend.mapper.FriendMapper.delete  : ==> Parameters: 1(Long), 2(Long)
2024-05-30 16:48:39.764 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.friend.mapper.FriendMapper.delete  : <==    Updates: 1
2024-05-30 16:48:39.765 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND ((source_user_id = ? AND target_user_id = ?) OR (source_user_id = ? AND target_user_id = ?)) limit 1
2024-05-30 16:48:39.765 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 1(Long), 2(Long), 2(Long), 1(Long)
2024-05-30 16:48:39.774 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:48:39.776 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomFriendMapper.updateById    : ==>  Preparing: UPDATE room_friend SET status=?, updated_at=? WHERE id=? AND deleted=0
2024-05-30 16:48:39.777 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomFriendMapper.updateById    : ==> Parameters: 0(Integer), 2024-05-30T16:48:39.776(LocalDateTime), 1(Long)
2024-05-30 16:48:39.794 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomFriendMapper.updateById    : <==    Updates: 1
2024-05-30 16:48:42.355 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:48:42.355 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:48:42.363 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:48:42.371 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:48:42.372 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:48:42.381 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:48:42.382 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:48:42.383 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:48:42.393 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:48:42.394 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:48:42.394 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:48:42.404 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:48:42.405 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:48:42.406 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:48:42.417 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:48:42.431 ERROR 20236 --- [http-nio-8820-exec-20] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:48:44.733 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:48:44.733 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:48:44.744 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:48:44.753 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:48:44.753 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:48:44.764 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:48:44.765 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:48:44.765 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:48:44.773 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:48:44.774 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:48:44.774 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:48:44.783 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:48:44.784 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:48:44.784 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:48:44.792 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:48:44.807 ERROR 20236 --- [http-nio-8820-exec-21] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:48:46.182 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:48:46.183 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:48:46.192 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:48:46.203 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:48:46.204 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:48:46.212 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:48:46.213 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:48:46.213 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:48:46.222 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:48:46.223 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:48:46.223 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:48:46.233 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:48:46.234 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:48:46.235 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:48:46.246 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:48:46.263 ERROR 20236 --- [http-nio-8820-exec-22] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:49:16.772 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:49:16.773 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:49:16.785 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:49:17.064 DEBUG 20236 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:49:17.065 DEBUG 20236 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:49:17.073 DEBUG 20236 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:49:17.090 DEBUG 20236 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 16:49:17.090 DEBUG 20236 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 16:49:17.103 DEBUG 20236 --- [http-nio-8820-exec-24] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 2
2024-05-30 16:50:02.576 DEBUG 20236 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:02.576 DEBUG 20236 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:02.576 DEBUG 20236 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:02.576 DEBUG 20236 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:02.587 DEBUG 20236 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:02.587 DEBUG 20236 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:02.588 DEBUG 20236 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 16:50:02.589 DEBUG 20236 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 10(Long)
2024-05-30 16:50:02.601 DEBUG 20236 --- [http-nio-8820-exec-25] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 3
2024-05-30 16:50:02.608 DEBUG 20236 --- [http-nio-8820-exec-26] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 16:50:02.608 DEBUG 20236 --- [http-nio-8820-exec-26] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 16:50:02.623 DEBUG 20236 --- [http-nio-8820-exec-26] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 16:50:03.149 DEBUG 20236 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:03.149 DEBUG 20236 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:03.164 DEBUG 20236 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:03.166 DEBUG 20236 --- [http-nio-8820-exec-27] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 16:50:03.166 DEBUG 20236 --- [http-nio-8820-exec-27] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 16:50:03.176 DEBUG 20236 --- [http-nio-8820-exec-27] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 2
2024-05-30 16:50:07.322 DEBUG 20236 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:07.322 DEBUG 20236 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:07.335 DEBUG 20236 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:07.612 DEBUG 20236 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:07.613 DEBUG 20236 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:07.624 DEBUG 20236 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:07.645 DEBUG 20236 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 16:50:07.646 DEBUG 20236 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 16:50:07.656 DEBUG 20236 --- [http-nio-8820-exec-29] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 2
2024-05-30 16:50:12.471 DEBUG 20236 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:12.472 DEBUG 20236 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:12.484 DEBUG 20236 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:12.812 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:12.813 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:12.823 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:12.844 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 16:50:12.845 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 16:50:12.859 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 2
2024-05-30 16:50:13.803 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:13.803 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:13.803 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:13.803 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:13.811 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:13.812 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:13.813 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 16:50:13.813 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 2(Long), 10(Long)
2024-05-30 16:50:13.824 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 3
2024-05-30 16:50:13.836 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.e.m.ExpressionMapper.selectList    : ==>  Preparing: SELECT id,url,content,type,created_at,updated_at,deleted FROM expression WHERE deleted=0
2024-05-30 16:50:13.836 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.e.m.ExpressionMapper.selectList    : ==> Parameters: 
2024-05-30 16:50:14.162 ERROR 20236 --- [http-nio-8820-exec-1] c.alibaba.druid.filter.stat.StatFilter   : slow sql 325 millis. SELECT  id,url,content,type,created_at,updated_at,deleted  FROM expression 
 WHERE  deleted=0[]
2024-05-30 16:50:14.164 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.e.m.ExpressionMapper.selectList    : <==      Total: 165
2024-05-30 16:50:15.355 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:15.356 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:15.366 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:15.375 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:15.375 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:15.386 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:15.387 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:15.387 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:15.398 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:15.399 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:15.399 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:15.411 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:15.412 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:15.412 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:15.423 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:15.440 ERROR 20236 --- [http-nio-8820-exec-4] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:50:17.171 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:17.171 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:17.182 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:17.194 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:17.194 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:17.203 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:17.204 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:17.204 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:17.214 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:17.215 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:17.215 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:17.227 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:17.228 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:17.228 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:17.237 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:17.258 ERROR 20236 --- [http-nio-8820-exec-5] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:50:18.015 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:18.015 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:18.025 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:18.038 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:18.038 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:18.048 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:18.049 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:18.050 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:18.061 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:18.062 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:18.062 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:18.071 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:18.072 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:18.072 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:18.082 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:18.101 ERROR 20236 --- [http-nio-8820-exec-6] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:50:18.438 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:18.439 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:18.453 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:18.468 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:18.468 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:18.480 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:18.481 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:18.482 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:18.490 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:18.491 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:18.491 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:18.503 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:18.503 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:18.504 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:18.520 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:18.546 ERROR 20236 --- [http-nio-8820-exec-7] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.GeneratedMethodAccessor138.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:50:18.737 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:18.738 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:18.746 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:18.757 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:18.758 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:18.767 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:18.768 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:18.768 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:18.777 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:18.777 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:18.778 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:18.790 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:18.791 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:18.791 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:18.802 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:18.821 ERROR 20236 --- [http-nio-8820-exec-8] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.GeneratedMethodAccessor138.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:50:18.997 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:18.998 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:19.007 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:19.017 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:19.018 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:19.027 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:19.028 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:19.028 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:19.037 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:19.038 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:19.038 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:19.046 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:19.047 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:19.047 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:19.056 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:19.072 ERROR 20236 --- [http-nio-8820-exec-9] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.GeneratedMethodAccessor138.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:50:19.228 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:19.228 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:19.243 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:19.255 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:19.255 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:19.265 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:19.266 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:19.266 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:19.275 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:19.276 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:19.276 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:19.285 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:19.286 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:19.286 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:19.296 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:19.316 ERROR 20236 --- [http-nio-8820-exec-10] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.GeneratedMethodAccessor138.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:50:19.438 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:19.438 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:19.450 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:19.461 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:19.461 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:19.471 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:19.472 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:19.472 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:19.481 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:19.482 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:19.483 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:19.492 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:19.493 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:19.493 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:19.504 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:19.525 ERROR 20236 --- [http-nio-8820-exec-11] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.GeneratedMethodAccessor138.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:50:19.667 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:19.668 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:19.676 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:19.686 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:19.687 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:19.696 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:19.697 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:19.698 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:19.706 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:19.707 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:19.707 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:19.718 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:19.719 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:19.719 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:19.729 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:19.764 ERROR 20236 --- [http-nio-8820-exec-12] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.GeneratedMethodAccessor138.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:50:19.883 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:19.883 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:19.895 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:19.910 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:19.910 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:19.919 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:19.920 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:19.920 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:19.930 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:19.931 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:19.932 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:19.942 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:19.943 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:19.943 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:19.953 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:19.973 ERROR 20236 --- [http-nio-8820-exec-13] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.GeneratedMethodAccessor138.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:50:20.095 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:20.096 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:20.108 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:20.119 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:20.120 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:20.130 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:20.131 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:20.131 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:20.144 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:20.145 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:20.145 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:20.155 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:20.156 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:20.157 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:20.166 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:20.187 ERROR 20236 --- [http-nio-8820-exec-14] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.GeneratedMethodAccessor138.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:50:20.306 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:20.307 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:20.318 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:20.329 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:20.329 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:20.338 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:20.338 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:20.339 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:20.348 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:20.349 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:20.349 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:20.360 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:20.361 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:20.361 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:20.371 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:20.389 ERROR 20236 --- [http-nio-8820-exec-15] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.GeneratedMethodAccessor138.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:50:20.535 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:20.535 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:20.545 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:20.556 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:20.557 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:20.566 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:20.567 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:20.568 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:20.579 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:20.580 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:20.580 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:20.591 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:20.592 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:20.592 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:20.602 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:20.622 ERROR 20236 --- [http-nio-8820-exec-16] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.GeneratedMethodAccessor138.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:50:20.774 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:20.774 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:20.783 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:20.794 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:20.794 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:20.802 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:20.804 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:20.804 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:20.818 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:20.819 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:20.819 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:20.831 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:20.832 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:20.832 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:20.842 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:20.863 ERROR 20236 --- [http-nio-8820-exec-17] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.GeneratedMethodAccessor138.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:50:21.052 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:21.053 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:21.062 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:21.071 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:21.071 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:21.081 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:21.082 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:21.082 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:21.095 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:21.096 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:21.097 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:21.106 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:21.107 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:21.107 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:21.119 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:21.139 ERROR 20236 --- [http-nio-8820-exec-18] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.GeneratedMethodAccessor138.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:50:21.267 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:21.267 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:21.277 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:21.289 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:21.289 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:21.298 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:21.300 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:21.300 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:21.311 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:21.312 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:21.313 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:21.322 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:21.323 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:21.324 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:21.333 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:21.347 ERROR 20236 --- [http-nio-8820-exec-19] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.GeneratedMethodAccessor138.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:50:21.482 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:21.483 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:21.495 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:21.511 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:21.512 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:21.522 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:21.523 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:21.523 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:21.532 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:21.533 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:21.533 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:21.542 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:21.543 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:21.543 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:21.553 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:21.572 ERROR 20236 --- [http-nio-8820-exec-20] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.GeneratedMethodAccessor138.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:50:21.700 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:21.700 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:21.711 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:21.721 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:21.722 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:21.731 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:21.732 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:21.732 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:21.742 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:21.743 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:21.743 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:21.755 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:21.756 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:21.756 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:21.764 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:21.781 ERROR 20236 --- [http-nio-8820-exec-21] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.GeneratedMethodAccessor138.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:50:21.917 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:21.917 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:21.926 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:21.935 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:21.935 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:21.948 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:21.949 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:21.949 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:21.961 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:21.961 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:21.962 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:21.970 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:21.971 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:21.971 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:21.980 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:22.010 ERROR 20236 --- [http-nio-8820-exec-22] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.GeneratedMethodAccessor138.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:50:22.090 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:50:22.090 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:50:22.099 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:50:22.110 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==>  Preparing: SELECT id,type,last_message_id,created_at,updated_at,deleted FROM room WHERE id=? AND deleted=0
2024-05-30 16:50:22.110 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : ==> Parameters: 2(Long)
2024-05-30 16:50:22.119 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.room.mapper.RoomMapper.selectById  : <==      Total: 1
2024-05-30 16:50:22.120 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomFriendMapper.selectCount   : ==>  Preparing: SELECT COUNT( * ) AS total FROM room_friend WHERE deleted=0 AND (room_id = ? AND (source_user_id = ? OR target_user_id = ?))
2024-05-30 16:50:22.120 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomFriendMapper.selectCount   : ==> Parameters: 2(Long), 1(Long), 1(Long)
2024-05-30 16:50:22.128 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomFriendMapper.selectCount   : <==      Total: 1
2024-05-30 16:50:22.129 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomFriendMapper.selectList    : ==>  Preparing: SELECT id,room_id,source_user_id,target_user_id,status,created_at,updated_at,deleted FROM room_friend WHERE deleted=0 AND (room_id = ?) limit 1
2024-05-30 16:50:22.129 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomFriendMapper.selectList    : ==> Parameters: 2(Long)
2024-05-30 16:50:22.140 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.r.m.RoomFriendMapper.selectList    : <==      Total: 1
2024-05-30 16:50:22.141 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.f.mapper.FriendMapper.selectCount  : ==>  Preparing: SELECT COUNT( * ) AS total FROM friend WHERE deleted=0 AND ((user_id = ? AND friend_id = ?) OR (user_id = ? AND friend_id = ?))
2024-05-30 16:50:22.141 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.f.mapper.FriendMapper.selectCount  : ==> Parameters: 2(Long), 1(Long), 1(Long), 2(Long)
2024-05-30 16:50:22.151 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.f.mapper.FriendMapper.selectCount  : <==      Total: 1
2024-05-30 16:50:22.173 ERROR 20236 --- [http-nio-8820-exec-23] com.slipper.handler.RunExceptionHandler  : 不是好友关系！

com.slipper.exception.RunException: 不是好友关系！
	at com.slipper.modules.message.service.impl.MessageServiceImpl.create(MessageServiceImpl.java:83)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$FastClassBySpringCGLIB$$4b5db397.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:792)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:123)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:388)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.message.service.impl.MessageServiceImpl$$EnhancerBySpringCGLIB$$ce0452d4.create(<generated>)
	at com.slipper.modules.message.controller.MessageController.create(MessageController.java:59)
	at sun.reflect.GeneratedMethodAccessor138.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:555)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:52:35.250 DEBUG 20236 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:52:35.250 DEBUG 20236 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:52:35.260 DEBUG 20236 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:52:35.262 DEBUG 20236 --- [http-nio-8820-exec-24] c.s.m.m.m.M.queryPageByLastId            : ==>  Preparing: SELECT m.id, m.type, m.text, m.image, m.voice, m.file, m.status, m.created_at, u.id AS userId, u.nickname, u.avatar, u.sex FROM message AS m LEFT JOIN user AS u ON u.id = m.user_id WHERE m.deleted = 0 AND m.room_id = ? ORDER BY m.created_at DESC LIMIT ?
2024-05-30 16:52:35.262 DEBUG 20236 --- [http-nio-8820-exec-24] c.s.m.m.m.M.queryPageByLastId            : ==> Parameters: 1(Long), 10(Long)
2024-05-30 16:52:35.272 DEBUG 20236 --- [http-nio-8820-exec-24] c.s.m.m.m.M.queryPageByLastId            : <==      Total: 2
2024-05-30 16:52:36.362 DEBUG 20236 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:52:36.362 DEBUG 20236 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:52:36.369 DEBUG 20236 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:52:36.388 DEBUG 20236 --- [http-nio-8820-exec-25] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:52:36.388 DEBUG 20236 --- [http-nio-8820-exec-25] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:52:36.416 DEBUG 20236 --- [http-nio-8820-exec-25] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:52:49.216 DEBUG 20236 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:52:49.216 DEBUG 20236 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:52:49.225 DEBUG 20236 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:52:49.476 DEBUG 20236 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:52:49.477 DEBUG 20236 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:52:49.489 DEBUG 20236 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:52:49.504 DEBUG 20236 --- [http-nio-8820-exec-27] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:52:49.504 DEBUG 20236 --- [http-nio-8820-exec-27] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:52:49.513 DEBUG 20236 --- [http-nio-8820-exec-27] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:52:53.789 DEBUG 20236 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:52:53.789 DEBUG 20236 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:52:53.797 DEBUG 20236 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:52:54.045 DEBUG 20236 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 16:52:54.045 DEBUG 20236 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 16:52:54.057 DEBUG 20236 --- [http-nio-8820-exec-28] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 16:53:59.164 DEBUG 20236 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:53:59.165 DEBUG 20236 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:53:59.173 DEBUG 20236 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:54:10.163 DEBUG 20236 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:54:10.164 DEBUG 20236 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:54:10.171 DEBUG 20236 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:54:10.188 DEBUG 20236 --- [http-nio-8820-exec-30] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:54:10.189 DEBUG 20236 --- [http-nio-8820-exec-30] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:54:10.198 DEBUG 20236 --- [http-nio-8820-exec-30] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:54:11.421 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:54:11.422 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:54:11.431 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:54:11.696 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:54:11.697 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:54:11.712 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:54:11.722 ERROR 20236 --- [http-nio-8820-exec-3] com.slipper.handler.RunExceptionHandler  : 操作太频繁,请稍后重试！

com.slipper.exception.RunException: 操作太频繁,请稍后重试！
	at com.slipper.core.repeat.aspect.RepeatAspect.around(RepeatAspect.java:64)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.grouping.controller.GroupingController$$EnhancerBySpringCGLIB$$bc3957ed.queryGroupingFriend(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:529)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:54:14.411 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:54:14.411 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:54:14.420 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:54:14.664 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:54:14.664 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:54:14.673 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:54:14.692 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:54:14.692 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:54:14.701 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:55:08.821 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:55:08.821 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:55:08.828 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:55:08.848 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:55:08.849 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:55:08.860 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:55:11.915 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:55:11.915 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:55:11.924 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:55:12.281 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:55:12.282 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:55:12.292 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:55:12.311 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:55:12.311 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:55:12.322 DEBUG 20236 --- [http-nio-8820-exec-7] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:55:20.561 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:55:20.562 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:55:20.569 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:55:20.587 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:55:20.587 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:55:20.597 DEBUG 20236 --- [http-nio-8820-exec-8] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:55:22.731 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:55:22.731 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:55:22.745 DEBUG 20236 --- [http-nio-8820-exec-9] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:55:23.017 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:55:23.017 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:55:23.026 DEBUG 20236 --- [http-nio-8820-exec-10] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:55:23.038 ERROR 20236 --- [http-nio-8820-exec-10] com.slipper.handler.RunExceptionHandler  : 操作太频繁,请稍后重试！

com.slipper.exception.RunException: 操作太频繁,请稍后重试！
	at com.slipper.core.repeat.aspect.RepeatAspect.around(RepeatAspect.java:64)
	at sun.reflect.GeneratedMethodAccessor141.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.grouping.controller.GroupingController$$EnhancerBySpringCGLIB$$bc3957ed.queryGroupingFriend(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:529)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:55:25.093 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:55:25.093 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:55:25.150 DEBUG 20236 --- [http-nio-8820-exec-11] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:55:25.434 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:55:25.435 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:55:25.454 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:55:25.479 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:55:25.479 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:55:25.516 DEBUG 20236 --- [http-nio-8820-exec-12] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:58:45.822 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:58:45.822 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:58:45.831 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:58:45.848 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:58:45.848 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:58:45.858 DEBUG 20236 --- [http-nio-8820-exec-13] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:58:51.162 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:58:51.162 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:58:51.170 DEBUG 20236 --- [http-nio-8820-exec-14] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:58:51.444 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:58:51.445 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:58:51.454 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:58:51.473 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:58:51.474 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:58:51.483 DEBUG 20236 --- [http-nio-8820-exec-15] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:59:17.390 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:59:17.390 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:59:17.400 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:59:17.415 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:59:17.416 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:59:17.426 DEBUG 20236 --- [http-nio-8820-exec-16] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:59:29.772 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:59:29.772 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:59:29.781 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:59:29.799 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:59:29.800 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:59:29.809 DEBUG 20236 --- [http-nio-8820-exec-17] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 16:59:31.521 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:59:31.522 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:59:31.531 DEBUG 20236 --- [http-nio-8820-exec-18] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:59:31.954 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:59:31.955 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:59:31.964 DEBUG 20236 --- [http-nio-8820-exec-19] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:59:31.976 ERROR 20236 --- [http-nio-8820-exec-19] com.slipper.handler.RunExceptionHandler  : 操作太频繁,请稍后重试！

com.slipper.exception.RunException: 操作太频繁,请稍后重试！
	at com.slipper.core.repeat.aspect.RepeatAspect.around(RepeatAspect.java:64)
	at sun.reflect.GeneratedMethodAccessor141.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:634)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:624)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:175)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:762)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:707)
	at com.slipper.modules.grouping.controller.GroupingController$$EnhancerBySpringCGLIB$$bc3957ed.queryGroupingFriend(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:150)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1072)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:965)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:529)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:623)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:209)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:111)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.xss.XssFilter.doFilter(XssFilter.java:21)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:337)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:115)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:122)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:126)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:81)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:109)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:149)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at com.slipper.core.security.filter.TokenAuthenticationFilter.doFilterInternal(TokenAuthenticationFilter.java:48)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:103)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:89)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:112)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:82)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:55)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:346)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:221)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:186)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:354)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:267)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at com.slipper.filter.stream.InputStreamFilter.doFilter(InputStreamFilter.java:19)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:117)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:178)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:153)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:168)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:481)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:130)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:928)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1794)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:748)

2024-05-30 16:59:34.117 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:59:34.118 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:59:34.127 DEBUG 20236 --- [http-nio-8820-exec-20] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:59:34.398 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 16:59:34.399 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 16:59:34.407 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 16:59:34.428 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 16:59:34.428 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 16:59:34.438 DEBUG 20236 --- [http-nio-8820-exec-21] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 17:00:27.937 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 17:00:27.938 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 17:00:27.948 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 17:00:27.970 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 17:00:27.970 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 17:00:27.980 DEBUG 20236 --- [http-nio-8820-exec-22] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 17:00:46.844 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 17:00:46.844 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 17:00:46.853 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 17:00:46.875 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 17:00:46.876 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 17:00:46.891 DEBUG 20236 --- [http-nio-8820-exec-23] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 17:00:52.207 DEBUG 20236 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 17:00:52.208 DEBUG 20236 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 17:00:52.215 DEBUG 20236 --- [http-nio-8820-exec-24] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 17:00:52.479 DEBUG 20236 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 17:00:52.479 DEBUG 20236 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 17:00:52.488 DEBUG 20236 --- [http-nio-8820-exec-25] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 17:00:52.506 DEBUG 20236 --- [http-nio-8820-exec-25] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 17:00:52.507 DEBUG 20236 --- [http-nio-8820-exec-25] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 17:00:52.520 DEBUG 20236 --- [http-nio-8820-exec-25] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 17:00:55.741 DEBUG 20236 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 17:00:55.741 DEBUG 20236 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 17:00:55.752 DEBUG 20236 --- [http-nio-8820-exec-26] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 17:00:56.003 DEBUG 20236 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 17:00:56.003 DEBUG 20236 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 17:00:56.012 DEBUG 20236 --- [http-nio-8820-exec-27] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 17:00:56.033 DEBUG 20236 --- [http-nio-8820-exec-27] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 17:00:56.033 DEBUG 20236 --- [http-nio-8820-exec-27] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 17:00:56.042 DEBUG 20236 --- [http-nio-8820-exec-27] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 17:01:06.000 DEBUG 20236 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 17:01:06.000 DEBUG 20236 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 17:01:06.007 DEBUG 20236 --- [http-nio-8820-exec-28] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 17:01:06.263 DEBUG 20236 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 17:01:06.263 DEBUG 20236 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 17:01:06.271 DEBUG 20236 --- [http-nio-8820-exec-29] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 17:01:06.291 DEBUG 20236 --- [http-nio-8820-exec-29] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 17:01:06.291 DEBUG 20236 --- [http-nio-8820-exec-29] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 17:01:06.300 DEBUG 20236 --- [http-nio-8820-exec-29] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 17:03:01.796 DEBUG 20236 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 17:03:01.797 DEBUG 20236 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 17:03:01.827 DEBUG 20236 --- [http-nio-8820-exec-30] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 17:03:02.096 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 17:03:02.096 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 17:03:02.106 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 17:03:02.126 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 17:03:02.127 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 17:03:02.140 DEBUG 20236 --- [http-nio-8820-exec-2] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 17:03:54.123 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 17:03:54.123 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 17:03:54.134 DEBUG 20236 --- [http-nio-8820-exec-3] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 17:03:54.405 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 17:03:54.405 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 17:03:54.414 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 17:03:54.434 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 17:03:54.435 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 17:03:54.446 DEBUG 20236 --- [http-nio-8820-exec-1] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 17:03:57.560 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 17:03:57.560 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 17:03:57.569 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 17:03:57.587 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : ==>  Preparing: SELECT c.id, c.room_id, c.user_id, m.id AS messageId, m.type AS messageType, m.text AS messageText, m.image AS messageImage, m.voice AS messageVoice, m.file AS messageFile, m.status AS messageStatus, m.created_at AS messageCreatedAt, mu.id AS messageUserId, mu.nickname AS messageNickname, mu.avatar AS messageAvatar, mu.sex AS messageSex, rg.id AS groupId, rg.name AS groupName, rg.avatar AS groupAvatar, f.id AS friendId, f.remark, u.id AS userId, u.nickname, u.avatar, u.sex, u.online FROM conversation AS c LEFT JOIN room AS r ON r.id = c.room_id LEFT JOIN message AS m ON m.id = r.last_message_id LEFT JOIN user AS mu ON mu.id = m.user_id LEFT JOIN room_group AS rg ON rg.room_id = c.room_id LEFT JOIN room_friend AS rf ON rf.room_id = c.room_id LEFT JOIN user AS u ON (rf.source_user_id = c.user_id AND u.id = rf.target_user_id) OR (rf.target_user_id = c.user_id AND u.id = rf.source_user_id) LEFT JOIN friend AS f ON f.deleted = 0 AND f.user_id = c.user_id AND f.friend_id = u.id WHERE c.deleted = 0 AND c.user_id = ? ORDER BY m.created_at DESC
2024-05-30 17:03:57.588 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : ==> Parameters: 1(Long)
2024-05-30 17:03:57.600 DEBUG 20236 --- [http-nio-8820-exec-4] c.s.m.c.m.ConversationMapper.queryList   : <==      Total: 1
2024-05-30 17:04:31.382 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 17:04:31.383 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 17:04:31.393 DEBUG 20236 --- [http-nio-8820-exec-5] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 17:04:31.728 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==>  Preparing: SELECT id,nickname,avatar,sex,email,open_id,online,last_at,status,created_at,updated_at,deleted FROM user WHERE id=? AND deleted=0
2024-05-30 17:04:31.728 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : ==> Parameters: 1(Long)
2024-05-30 17:04:31.736 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.user.mapper.UserMapper.selectById  : <==      Total: 1
2024-05-30 17:04:31.757 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.g.mapper.GroupingMapper.queryList  : ==>  Preparing: SELECT g.id, g.name, g.fixed, f.id AS friend_id, f.remark, f.friend_id AS user_id, u.nickname, u.avatar, u.sex, u.online, u.email, u.last_at, u.created_at FROM `grouping` AS g LEFT JOIN friend AS f ON f.grouping_id = g.id AND f.deleted = 0 LEFT JOIN user AS u ON u.id = f.friend_id WHERE g.deleted = 0 AND g.user_id = ? ORDER BY g.fixed DESC, u.nickname ASC, f.created_at DESC
2024-05-30 17:04:31.757 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.g.mapper.GroupingMapper.queryList  : ==> Parameters: 1(Long)
2024-05-30 17:04:31.770 DEBUG 20236 --- [http-nio-8820-exec-6] c.s.m.g.mapper.GroupingMapper.queryList  : <==      Total: 1
2024-05-30 17:04:49.890  INFO 20236 --- [SpringApplicationShutdownHook] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} closing ...
2024-05-30 17:04:49.898  INFO 20236 --- [SpringApplicationShutdownHook] com.alibaba.druid.pool.DruidDataSource   : {dataSource-1} closed
